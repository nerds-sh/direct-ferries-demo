function verifyGlobalDeclared(varName,fn,count){let c=count>0?++count:1
if(typeof window[varName]==="undefined"){if(count>80){if(console&&console.warn)console.warn("timeout waiting for",varName)
return}
return setTimeout(verifyGlobalDeclared.bind(window,varName,fn,c),50);}
return fn();}
function getEnvironment(){var environment="Production";try{environment=window.location.host.includes("directferries.xyz")?"Staging":"Production";}catch(e){ga('send','event','JavaScript error','Error getting environment',{nonInteraction:true});}
return environment;}
function attachLnk(type,src){var script=document.createElement(type);switch(type){case'script':script.src=src;break;case'link':script.href=src;script.rel='stylesheet';break;default:}
document.head.appendChild(script);}
function getCommonQuery(){var commonQuery=""
if(typeof(utm)!='undefined'){commonQuery="&dfutm="+encodeURIComponent(utm.getUtm());}
return commonQuery;}
let dfExperimentToRun=[];function readCookie(name){var nameEQ=encodeURIComponent(name)+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)===0)return decodeURIComponent(c.substring(nameEQ.length,c.length));}
return null;}
function addCookie(name,value,days){var expires;if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}else{expires="";}
var cookieString=encodeURIComponent(name)+"="+encodeURIComponent(value)+expires+"; path=/;";if(window.location.protocol.indexOf('https')!=-1)cookieString+="secure=true;samesite=none;";document.cookie=cookieString;}
function addCookieMins(name,value,mins){var expires;if(mins){var date=new Date();date.setTime(date.getTime()+(mins*60*1000));expires="; expires="+date.toGMTString();}else{expires="";}
document.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)+expires+"; path=/";}
function SetEventCookiesDealfinder(data){if(typeof data!=='undefined'&&data!==null&&data){addCookie('dfusrpid',data.d.UniqueUserId,365);addCookieMins('dfsession',data.d.SessionId,30);addCookie('dfvisit',data.d.VisitReturningId,3650);}};var isDynamicLp=document.querySelector("#is_dynamic_lp")!=null&&document.querySelector("#is_dynamic_lp").value=="true";var DF_DF1={formState:['initial_blank','showing_routes_list','entering_search_term','entering_date_outbound','date_outbound_entered','entering_time_outbound','time_outbound_entered','entering_date_return','date_return_entered','entering_time_return','time_return_entered','entering_journey_info','full_open_ticket','return_open_ticket'],flowStep:['open_calendar_details','open_passenger_details','open_vehicle_details'],formStateIndex:0,routeIsSet:false,restoredFromPrevious:false,valid:false,specialDateErrors:[],currencies:null,maxPassengers:null,minDuration:null,submission:{oneway:false,diffjourneys:false,currency:null,routeOut:{sailing:{dateDep:null,isOpenChecked:false,portFromId:null,portToId:null,routeId:null,routeIdRet:null,timeId:-1,},passengersTotal:0,paxList:[],residentInfo:-1,bookingDiscountOption:-1,petCountTotal:0,petList:[],vehicle:{addLengthHeightRadioValue:false,caravanTrailerHeightId:-1,caravanTrailerLengthId:-1,caravanTrailerRadioValue:false,caravanTrailerTypeId:null,commercialGoodsChecked:false,vehicleAdditionalHeightId:0,vehicleAdditionalLengthId:0,vehicleHeightId:null,vehicleLengthId:null,vehicleMakeEntered:null,vehicleMakeId:-1,vehicleModelEntered:null,vehicleModelId:-1,vehicleRadioValue:false,vehicleTypeId:-1,},},routeReturn:{sailing:{dateDep:null,isOpenChecked:false,portFromId:null,portToId:null,routeId:null,routeIdRet:null,timeId:-1,},passengersTotal:0,paxList:[],residentInfo:-1,bookingDiscountOption:-1,petCountTotal:0,petList:[],vehicle:{addLengthHeightRadioValue:false,caravanTrailerHeightId:-1,caravanTrailerLengthId:-1,caravanTrailerRadioValue:false,caravanTrailerTypeId:null,commercialGoodsChecked:false,vehicleAdditionalHeightId:0,vehicleAdditionalLengthId:0,vehicleHeightId:null,vehicleLengthId:null,vehicleMakeEntered:null,vehicleMakeId:-1,vehicleModelEntered:null,vehicleModelId:-1,vehicleRadioValue:false,vehicleTypeId:-1,},},},smallViewport:window.matchMedia('(max-width:768px)').matches,separatePassengers:false,clearAllBtn:false,standardCarOption:false,focusDealFinder:false,groupAdultsByAge:false,popupSlider:false,vehicleDimensionsSend:false,isFerries:false,isMobileApp:window.location.search.indexOf("mobileApp=true")!==-1,useDateRange:false,bufferedDateRange:[],showPopularRoutes:false,changeStepOrderExpOn:false,changeStepOrder:false,timePickerModal:false,submitUrl:BookingEngineUrl,utils:{buildElm:({tag,txt,cls,atts})=>{let e=document.createElement(tag);typeof txt!=='undefined'?e.textContent=txt:null;Array.isArray(cls)?cls.forEach(function(c){e.classList.add(c);}):null;for(let att in atts){e.setAttribute(att,atts[att]);}
return e;},checkRemoveElm:(elm)=>elm?elm.remove():null,getSiblings:(elm)=>Array.from(elm.parentElement.children).filter((item)=>!item.isSameNode(elm)),findLeg:(checkItem)=>{if(checkItem.id.indexOf('outbound')!==-1||checkItem.className.indexOf('outbound')!==-1){return{storeLeg:DF_DF1.legOut,subLeg:DF_DF1.submission.routeOut,legTxt:'outbound'};}
else{return{storeLeg:DF_DF1.legRet,subLeg:DF_DF1.submission.routeReturn,legTxt:'return'};}},whenIsTrueDF:function(condition,fn,count){let c=count>0?++count:1
if(!condition()){console.warn("attempnt number : "+c)
if(c>80){return}
return setTimeout(DF_DF1.utils.whenIsTrueDF.bind(condition,fn,c),50);}
console.warn("conditions is true!")
return fn()},parseDate(dateString){var year=dateString.substring(0,4);var month=dateString.substring(5,7);var days=dateString.substring(8,10);return new Date(year,month-1,days);},trackExperimentVariant:function(expList,partnerCode){try{var userAgent=window.navigator.userAgent;if(userAgent!="googlebot"){getExperimentVariant(function(data){addCookie('dfexp',data.d.CookieValue,365);},JSON.stringify(expList),partnerCode);}}catch(error){ga('send','event','JavaScript error','Error sending experiment variant',encodeURIComponent(expList),{nonInteraction:true});}},getCtaButtonTxt:function(type){var result="";var popup=false;switch(type){case"search":result=DF_DF1.changeStepOrderExpOn&&typeof(regionalText.search_tickets)!="undefined"?regionalText.search_tickets:regionalText.search_continue;break;case"confirm_date":result=(DF_DF1.changeStepOrderExpOn||DF_DF1.useDateRange)&&typeof(regionalText.confirm_date)!="undefined"?regionalText.confirm_date:regionalText.submit_continue;break;case"confirm_time":result=(DF_DF1.changeStepOrderExpOn||DF_DF1.useDateRange)&&typeof(regionalText.confirm_time)!="undefined"?regionalText.confirm_time:regionalText.submit_continue;break;case"passengers_popup":result=DF_DF1.changeStepOrderExpOn&&typeof(regionalText.confirm_passengers)!="undefined"?regionalText.confirm_passengers:regionalText.popup_done;popup=true;break;case"pets_popup":result=DF_DF1.changeStepOrderExpOn&&typeof(regionalText.confirm_pets)!="undefined"?regionalText.confirm_pets:regionalText.popup_done;popup=true;break;case"vehicle_base":case"vehicle_detail":result=DF_DF1.changeStepOrderExpOn&&typeof(regionalText.confirm_vehicle)!="undefined"?regionalText.confirm_vehicle:regionalText.popup_done;popup=true;break;default:result=regionalText.popup_done;}
if(DF_DF1.changeStepOrderExpOn){setTimeout(function(){DF_DF1.changeButtonState(true,popup,"");},10);setTimeout(function(){DF_DF1.changeButtonState(false,popup,result);},800);}
return result;},getExperimentVariant:function(callbackFunc,experimentIds,partnerCode){var expVal=readCookie('dfexp');if(expVal==null){expVal='';}
var qStr=getCommonQuery();var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var uniqueUserIdVal=dfusrpid!=null&&dfusrpid!=""?dfusrpid:readCookie('dfusrpid');$.ajax({type:"GET",url:"https://ssl.directferries.com/secure/ws/dfexperiments.aspx/GetVariants?stdc="+partnerCode,dataType:"jsonp",data:'ExperimentIds='+experimentIds+'&CookieVal='+encodeURIComponent(expVal)+'&PageUrl='+window.location.href+'&MethodName=GetVariants'+"&dfusrpid="+uniqueUserIdVal+qStr,success:callbackFunc});},runExperiment:function(name){var AB="A";try{var userAgent=window.navigator.userAgent;if(userAgent!="googlebot"){var indx=document.cookie.indexOf(name+'=');var dateVar=new Date();dateVar.setFullYear(dateVar.getFullYear()+1);if(indx!==-1){AB=document.cookie.substring(indx+name.length+1,indx+name.length+2);}else{AB=Math.floor(Math.random()*2)===1?'A':'B';var cookieString=name+'='+AB+';expires='+dateVar+';';if(window.location.protocol.indexOf('https')!=-1)cookieString+="secure=true;samesite=none;";document.cookie=cookieString;window._uxa=window._uxa||[];window._uxa.push(['trackDynamicVariable',{key:name,value:AB}]);dfExperimentToRun.push(name+AB);var uniqueExps=dfExperimentToRun.filter(function(val,i){return dfExperimentToRun.indexOf(val)===i;});DF_DF1.utils.getExperimentVariant(function(data){addCookie('dfexp',data.d.CookieValue,365);},JSON.stringify(uniqueExps),base_user_data.STDCCode);}}}catch(error){ga('send','event','JavaScript error','Error running experiment','dealfinder2',{nonInteraction:true});}
return AB;}},init:function()
{var langEnabled=false;var expLanguages=["en","nl","fr","de","it","es"];expLanguages.forEach((lang)=>{if(base_user_data.SiteLanguage.startsWith(lang))langEnabled=true;});var newCalendarEnabled=isDynamicLp&&langEnabled;if(newCalendarEnabled){var environment=getEnvironment();attachLnk('link',CDNResourcesUrl+"/"+environment+'/css/dealfinder/new_cal/styles_b.css');attachLnk('link',CDNResourcesUrl+"/"+environment+'/css/dealfinder/new_cal/mobiscroll.javascript.min.css');attachLnk('script',CDNResourcesUrl+"/"+environment+'/scripts/dealfinder/new_cal/mobiscroll.javascript.min.js');}
else attachLnk('script',CDNResourcesUrl+'/scripts/dealfinder/mobiscroll.javascript.min.js');this.form=document.querySelector('#deal_finder1');this.route_outbound=DF_DF1.form.querySelector('#route_outbound');this.route_return=DF_DF1.form.querySelector('#route_return');this.timing_outbound=DF_DF1.form.querySelector('.timing_outbound');this.cal_outbound=DF_DF1.form.querySelector('#cal_outbound');this.time_outbound=DF_DF1.form.querySelector('#time_outbound');this.open_ticket_outbound=DF_DF1.form.querySelector('#open_ticket_outbound');this.open_ticket_note_full=DF_DF1.form.querySelector('.open_ticket_note_full');this.timing_return=DF_DF1.form.querySelector('.timing_return');this.cal_return=DF_DF1.form.querySelector('#cal_return');this.time_return=DF_DF1.form.querySelector('#time_return');this.open_ticket_return=DF_DF1.form.querySelector('#open_ticket_return');this.open_ticket_note_return=DF_DF1.form.querySelector('.open_ticket_note_return');this.journey_info=DF_DF1.form.querySelector('.journey_info');this.passengers_outbound=DF_DF1.form.querySelector('.passengers.trip_outbound');this.pets_outbound=DF_DF1.form.querySelector('.pets.trip_outbound');this.vehicle_outbound=DF_DF1.form.querySelector('.vehicle.trip_outbound');this.passengers_return=DF_DF1.form.querySelector('.passengers.trip_return');this.pets_return=DF_DF1.form.querySelector('.pets.trip_return');this.vehicle_return=DF_DF1.form.querySelector('.vehicle.trip_return');this.toggles=DF_DF1.form.querySelectorAll('[data-toggle]');this.inert_fields=DF_DF1.form.querySelectorAll('.disabled');this.round_trip_fields=DF_DF1.form.querySelectorAll('.round_trip');this.trip_outbound_fields=DF_DF1.form.querySelectorAll('.trip_outbound');this.trip_type_labels=DF_DF1.form.querySelectorAll('.journey_type label');this.open_tickets=DF_DF1.form.querySelectorAll('[data-toggle="open_ticket"]');this.diff_trips=DF_DF1.form.querySelectorAll('.diff_trip');this.diff_detail=DF_DF1.form.querySelector('#diff_details');this.submit=DF_DF1.form.querySelector('.df_submit');this.baseData=JSON.stringify(base_user_data);this.form.addEventListener('change',this.eventPipe);this.form.addEventListener('click',this.eventPipe);if(typeof regionalText!=="undefined"){if(typeof(regionalText.submit_continue)==='undefined')regionalText.submit_continue="Next";if(typeof(regionalText.search_continue)==='undefined')regionalText.search_continue="Search";if(typeof(regionalText.calendar_out_hdg)==='undefined')regionalText.calendar_out_hdg="Leaving on:";if(typeof(regionalText.calendar_out_open_ticket_hdg)==='undefined')regionalText.calendar_out_open_ticket_hdg="Leaving";if(typeof(regionalText.time_out_hdg)==='undefined')regionalText.time_out_hdg="Leaving at:";if(typeof(regionalText.calendar_return_hdg)==='undefined')regionalText.calendar_return_hdg="Returning on:";if(typeof(regionalText.calendar_return_open_ticket_hdg)==='undefined')regionalText.calendar_return_open_ticket_hdg="Returning";if(typeof(regionalText.time_return_hdg)==='undefined')regionalText.time_return_hdg="Returning at:";if(typeof(regionalText.calendar_both_open_ticket)==='undefined')regionalText.calendar_both_open_ticket="Open Ticket";if(typeof(regionalText.passengers_add)==='undefined')regionalText.passengers_add="Add a passenger";if(typeof(regionalText.passengers_note)==='undefined')regionalText.passengers_note="Please confirm passenger ages";if(typeof(regionalText.vehicles_popup_vehicle_select_make)==='undefined')regionalText.vehicles_popup_vehicle_select_make="Please select the vehicle make";if(typeof(regionalText.vehicles_popup_vehicle_select_model)==='undefined')regionalText.vehicles_popup_vehicle_select_model="Please select the vehicle model";if(typeof(regionalText.vehicles_popup_customLength)==='undefined')regionalText.vehicles_popup_customLength='Custom length';if(typeof(regionalText.vehicles_popup_customHeight)==='undefined')regionalText.vehicles_popup_customHeight='Custom height';if(typeof(regionalText.vehicles_popup_addLength)==='undefined')regionalText.vehicles_popup_addLength='Additional length';if(typeof(regionalText.vehicles_popup_addHeight)==='undefined')regionalText.vehicles_popup_addHeight='Additional height';if(typeof(regionalText.validity_no_currency)==='undefined')regionalText.validity_no_currency="Please choose a currency type for the journey.";}
DF_DF1.setUpDefaultText();DF_DF1.separatePassengers=true;DF_DF1.clearAllBtn=true;DF_DF1.standardCarOption=false;var isHomePage=document.getElementById('is_homepage')!=undefined&&document.getElementById('is_homepage').value=='true';DF_DF1.moveDatePickerInModal=!isMobileInDesktop&&false;if(!isMobileInDesktop){DF_DF1.focusDealFinder=true;DF_DF1.addFocusToDealfinderMini(false);}
if(!isMobileInDesktop&&document.querySelector('[name="hdnRouteIdOut"]')!==null){DF_DF1.focusDealFinder=true;DF_DF1.addFocusToDealfinderMini(true);}
DF_DF1.fetchPreviousSearch();var style=document.createElement('style');style.type='text/css';style.innerHTML="@media (max-width: 10000px) { .container #deal_finder1 .journey_type label {border-radius: 0;} #deal_finder1 section.journey_type label:nth-of-type(1) {border-top-left-radius: 4px; border-bottom-left-radius: 4px; border-top-right-radius: 0;    border-bottom-right-radius: 0; border-top: 2px solid #edebe6; border-left: 2px solid #edebe6; border-bottom: 2px solid #edebe6; border-right: 0;} #deal_finder1 section.journey_type label:nth-of-type(2) {border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 0;    border-bottom-left-radius: 0; border-top: 2px solid #edebe6; border-right: 2px solid #edebe6; border-bottom: 2px solid #edebe6; border-left: 0;} }";document.getElementsByTagName('head')[0].appendChild(style);if(!isMobileInDesktop){DF_DF1.popupSlider=true;var style=document.createElement('style');style.type='text/css';style.innerHTML="@keyframes slideup { 0% { min-height: 0%; } 100% { min-height: 100%; } } body .popup_slider { bottom: 0; min-height: 0%; opacity: 1; animation: slideup 0.3s ease-in-out forwards; }";document.getElementsByTagName('head')[0].appendChild(style);}
DF_DF1.vehicleDimensionsSend=false;try{DF_DF1.isFerries=base_user_data.STDCCode.includes('AFCI');}catch(e){}
var queryString=window.location.search;if(queryString.indexOf("env=")!==-1){if(queryString.indexOf("env=stag")!==-1){$('#deal_finder1').attr('action',"https://ssl.stag.directferries.xyz/ferry/secure/booking_redirect_df.aspx");}
if(queryString.indexOf("env=dev")!==-1&&queryString.indexOf("branch=")!==-1){var branchPrefix=queryString.split("&").find(p=>p.includes("branch=")).replace("branch=","");$('#deal_finder1').attr('action',"http://"+branchPrefix+".bookingengine.branchpreview.directferries.local/ferry/secure/booking_redirect_df.aspx");}}
var showPr=document.getElementById('show_popular_routes')!=undefined&&document.getElementById('show_popular_routes').value=='true';DF_DF1.showPopularRoutes=isMobileInDesktop||DF_DF1.isFerries||DF_DF1.isMobileApp||showPr;if(langEnabled){if(isMobileInDesktop)
DF_DF1.changeStepOrderExpOn=false;else
DF_DF1.changeStepOrderExpOn=false;if(DF_DF1.changeStepOrderExpOn){DF_DF1.changeStepOrder=DF_DF1.changeStepOrderExpOn;var style=document.createElement('style');style.type='text/css';style.innerHTML=".popup_in_progress .journey_timing, .popup_in_progress .journey_info, .popup_in_progress .journey_type, .popup_in_progress .journey_route { visibility: hidden; } .popup_done img { object-fit: unset; height: 12px; margin: 0 auto; } .mob-dealfinder .df_submit img { object-fit: unset; height: 12px; margin: 0 auto; }";document.getElementsByTagName('head')[0].appendChild(style);}}
DF_DF1.useDateRange=newCalendarEnabled;if(DF_DF1.useDateRange){DF_DF1.timePickerModal=true;DF_DF1.formState=DF_DF1.formState.filter(function(item){return item!=='entering_date_return'});DF_DF1.formState=DF_DF1.formState.filter(function(item){return item!=='date_return_entered'});DF_DF1.formState=DF_DF1.formState.filter(function(item){return item!=='entering_time_return'});DF_DF1.formState=DF_DF1.formState.filter(function(item){return item!=='time_return_entered'});}},removeLoadingMask:()=>{if($('.loading')!=undefined){$('.loading').css("display","none");}
$('#deal_finder1').removeAttr("style");},showSearchButton:()=>{if(document.getElementById('dealfinder-wrapper')!=null)document.getElementById('dealfinder-wrapper').classList.remove("d-none");},setUpDefaultText:()=>{DF_DF1.inert_fields.forEach((field)=>{let origText=field.matches('[data-popup]')?field.textContent:field.value;field.setAttribute('data-orig-txt',origText);})
DF_DF1.submit.setAttribute('data-orig-txt',DF_DF1.submit.textContent);},updateGoogleTags:function(results){if(typeof dataLayer==="undefined"){var dataLayer=[];}
dataLayer.push({'travel_device':results.UserDeviceType,'travel_website':document.domain,'travel_siteLang':results.SiteLanguage,'travel_uniqueVisitor':!results.VisitReturning,'travel_trafficSource':results.TrackingSource});},getBaseData:function(){var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();var url=DF_DF1.submitUrl+"/partners/dealFinderBaseData.aspx?"
+"stdc="+base_user_data.STDCCode
+qStr;var ajaxRequest=$.ajax({dataType:"jsonp",url:url,success:function(data){SetEventCookiesDealfinder(data)
base_user_data=data.d;try{if(base_user_data.UniqueUserId!=null){base_user_data.UniqueUserId=base_user_data.UniqueUserId.split(',')[0];}
if(base_user_data.SessionId!=null){base_user_data.SessionId=base_user_data.SessionId.split(',')[0];}
if(base_user_data.VisitReturningId!=null){base_user_data.VisitReturningId=base_user_data.VisitReturningId.split(',')[0];}
if(base_user_data.STDCCode!=null){base_user_data.STDCCode=base_user_data.STDCCode.split(',')[0];}}catch(e){if(typeof(ga)=='function')ga('send','event','dealFinderBaseData mobile failed',{nonInteraction:true});}
DF_DF1.baseData=JSON.stringify(base_user_data);DF_DF1.updateGoogleTags(data.d);isBaseDataSuccess=true;DF_DF1.init();},error:function(data){DF_DF1.reportAnalytics('fetchFailed','Fetch base user data',url);}});},fetchPreviousSearch:function(){var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();var url=DF_DF1.submitUrl+"/secure/ws/recent_searches.asmx/GetLatestRecentSearch?"
+"cult="+base_user_data.SiteLanguage
+"&RSType=1&ID=0"
+qStr;var fetch=$.ajax({dataType:"jsonp",url:url,success:function(data){DF_DF1.restorePreviousSearch(data.d);},error:function(data){},});},restorePreviousSearch:function(res){var pageRouteIdOut=0;var pageRouteIdRet=0;var routeIdsOnPage=false;var hasRecentSearch=res&&res.OK!==0;if(!hasRecentSearch){pageRouteIdOut=document.querySelector('[name="hdnRouteIdOut"]')!==null?document.querySelector('[name="hdnRouteIdOut"]').value:0;pageRouteIdRet=document.querySelector('[name="hdnRouteIdRet"]')!==null?document.querySelector('[name="hdnRouteIdRet"]').value:0;if(pageRouteIdOut>0){routeIdsOnPage=true;res.JourneyType='1';if(pageRouteIdRet>0)res.JourneyType='2';}}
if(hasRecentSearch||routeIdsOnPage){DF_DF1.restoredFromPrevious=true;if(hasRecentSearch&&DF_DF1.changeStepOrder)DF_DF1.changeStepOrder=false;var routeIdOut=0;var routeIdRet=0;let fetchJourneyDetail=function(){if(res&&res.OK!==0){routeIdOut=encodeURIComponent(res.Legs[0].sailing.routeId);routeIdRet=res.JourneyType==='1'?'0':encodeURIComponent(res.Legs[1].sailing.routeId);}else{routeIdOut=encodeURIComponent(pageRouteIdOut);routeIdRet=encodeURIComponent(pageRouteIdRet);}
var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();let fetch=$.ajax({dataType:"jsonp",url:DF_DF1.submitUrl+"/ferry/ws/dealpicker.asmx/RouteDataGet?"
+"JourneyType="+encodeURIComponent(res.JourneyType)
+"&routeId="+routeIdOut
+"&routeIdReturn="+routeIdRet
+"&cult="+encodeURIComponent(base_user_data.SiteLanguage)
+"&stdc="+encodeURIComponent(base_user_data.STDCCode)
+"&miniCruise=false"
+"&baseData="+encodeURIComponent(DF_DF1.baseData)
+qStr,success:function(data){DF_DF1.route_outbound.value=data.d.legOut.routeName;res.JourneyType!=='1'?DF_DF1.route_return.value=data.d.legRet.routeName:null;DF_DF1.handleJourneyDetail(null,data.d,routeIdOut,routeIdRet);if(routeIdsOnPage){DF_DF1.runDefaultAll(null,true);if(DF_DF1.changeStepOrder)DF_DF1.changeFlowStep(DF_DF1.flowStep[0]);}else{setPreviousLegs();DF_DF1.runDefaultAll(null);}
DF_DF1.routeIsSet=true;if(DF_DF1.separatePassengers)DF_DF1.buildSeparatePassengersDivs();if(DF_DF1.focusDealFinder)document.getElementById('pnlOuter').classList.remove("mini");if(DF_DF1.legOut['residentDiscounts'].length>0)DF_DF1.buildResidentDiscount();else if(document.querySelector('#resDiscount')!=null)document.querySelector('#resDiscount').parentElement.removeChild(document.querySelector('#resDiscount'));DF_DF1.showSearchButton();},error:function(data){}});};let setPreviousLegs=function(){var outDate,retDate;res.Legs.forEach(function(leg,index){let subLeg,storeLeg,legTxt;if(index===0){subLeg=DF_DF1.submission.routeOut;storeLeg=DF_DF1.legOut;legTxt='outbound';}else{subLeg=DF_DF1.submission.routeReturn;storeLeg=DF_DF1.legRet;legTxt='return';}
let dateField=DF_DF1['cal_'+legTxt];let datepicker=DF_DF1['mobi'+legTxt+'Cal'];let timeField=DF_DF1['time_'+legTxt];let timepicker=DF_DF1['mobi'+legTxt+'Time'];let passField=DF_DF1['passengers_'+legTxt];let petsField=DF_DF1['pets_'+legTxt];let vehicleField=DF_DF1['vehicle_'+legTxt];dateField.classList.remove('disabled');var dDate;if(new Date(DF_DF1.utils.parseDate(leg.sailing.dateDep).setHours(leg.sailing.timeId))<new Date()){var minDate=DF_DF1.utils.parseDate(storeLeg.dates.minDate);var addedDays=legTxt=='outbound'?1:4;dDate=DF_DF1.utils.parseDate(new Date(minDate.getFullYear(),minDate.getMonth(),(minDate.getDate()+addedDays)).toISOString());}else dDate=DF_DF1.utils.parseDate(leg.sailing.dateDep);if(!DF_DF1.useDateRange||DF_DF1.submission.oneway)datepicker.setVal(dDate,true);else{if(legTxt=='outbound')outDate=dDate;else retDate=dDate;}
timeField.classList.remove('disabled');if(typeof(timepicker)!="undefined")timepicker.setVal(leg.sailing.timeId,true);if(storeLeg.hasOpenTicket=="false")leg.sailing.isOpenChecked=false;DF_DF1.open_tickets[index].checked=storeLeg.hasOpenTicket&&leg.sailing.isOpenChecked;subLeg.sailing.isOpenChecked=storeLeg.hasOpenTicket&&leg.sailing.isOpenChecked;subLeg.passengersTotal=leg.passengersTotal;subLeg.paxList=leg.paxList;subLeg.bookingDiscountOption=leg.bookingDiscountOption;subLeg.residentInfo=leg.residentInfo;subLeg.petCountTotal=leg.petCountTotal;subLeg.petList=leg.petList;subLeg.vehicle=leg.vehicle;leg.vehicle.vehicleRadioValue==='false'?subLeg.vehicle.vehicleRadioValue=false:subLeg.vehicle.vehicleRadioValue=true;leg.vehicle.addLengthHeightRadioValue==='false'?subLeg.vehicle.addLengthHeightRadioValue=false:subLeg.vehicle.addLengthHeightRadioValue=true;leg.vehicle.caravanTrailerRadioValue==='false'?subLeg.vehicle.caravanTrailerRadioValue=false:subLeg.vehicle.caravanTrailerRadioValue=true;let regionTxt;regionTxt=leg.passengersTotal>1?regionalText.passenger_plural:regionalText.passenger_single;passField.querySelector('.journey_details_span').textContent=regionTxt.replace('[--X--]',leg.passengersTotal);passField.querySelector('#plus_icon').textContent="edit";regionTxt=(leg.petCountTotal>1||leg.petCountTotal===0)?regionalText.pets_plural:regionalText.pets_single;petsField.querySelector('.journey_details_span').textContent=regionTxt.replace('[--X--]',leg.petCountTotal);petsField.querySelector('#plus_icon').textContent="edit";let baseVehicleStr;let makeStr='';let modelStr='';let caravanStr='';if(!subLeg.vehicle.vehicleRadioValue){baseVehicleStr=regionalText.vehicle_no_vehicle;subLeg.vehicle.vehicleTypeId=0;subLeg.vehicle.vehicleMakeId=-1;subLeg.vehicle.vehicleModelId=-1;subLeg.vehicle.vehicleMakeEntered=null;subLeg.vehicle.vehicleModelEntered=null;}else{let vehicle_item=storeLeg.vehicleTypes.find((item)=>parseInt(item.ddVal)===parseInt(leg.vehicle.vehicleTypeId));if(vehicle_item!=undefined)baseVehicleStr=vehicle_item.ddText;else baseVehicleStr=regionalText.vehicle_no_vehicle;if(typeof(leg.vehicle.vehicleTypeId)!=undefined&&typeof(leg.vehicle.vehicleMakeId)!=undefined&&leg.vehicle.vehicleTypeId==2&&leg.vehicle.vehicleMakeId==2056){leg.vehicle.vehicleLengthId="-1";leg.vehicle.vehicleHeightId="-1";}
if(leg.vehicle.vehicleMakeName!=null)makeStr=': '+leg.vehicle.vehicleMakeName;if(leg.vehicle.vehicleModelName!=null)modelStr=', '+leg.vehicle.vehicleModelName;if(subLeg.vehicle.caravanTrailerRadioValue){switch(subLeg.vehicle.caravanTrailerTypeId){case'1':caravanStr=' + '+regionalText.vehicles_popup_caravan_text;break;case'4':caravanStr=' + '+regionalText.vehicles_popup_trailer_text;break;}}}
vehicleField.querySelector('.journey_details_span').textContent=baseVehicleStr+makeStr+modelStr+caravanStr;if(leg.vehicle.vehicleRadioValue&&leg.vehicle.vehicleModelId==2056&&leg.vehicle.vehicleMakeId==2056)
vehicleField.querySelector('.journey_details_span').textContent=regionalText.vehicles_popup_standard_car;vehicleField.querySelector('#plus_icon').textContent="edit";if(leg.vehicle.vehicleTypeId==0)vehicleField.querySelector('.journey_details_span').textContent=regionalText.vehicle_no_vehicle;else vehicleField.querySelector('.journey_details_span').textContent=leg.vehicle.vehicleDescription;});if(DF_DF1.useDateRange&&!DF_DF1.submission.oneway){setTimeout(function(){DF_DF1.setDateRange(outDate,retDate);},100);}};if(res.JourneyType==='1'){DF_DF1.form.querySelector('#journey_oneway').checked=true;DF_DF1.handleToggle(DF_DF1.form.querySelector('#journey_oneway'));DF_DF1.submission.oneway=true;}else if(res.JourneyType==='3'){DF_DF1.diff_detail.checked=true;DF_DF1.handleToggle(DF_DF1.diff_detail);}
DF_DF1.submission.currency=res.CurrencyID;fetchJourneyDetail();DF_DF1.jumpFormState(null,'entering_journey_info');}else{if(DF_DF1.showPopularRoutes){DF_DF1.triggerPopRoutes();}}
DF_DF1.restoredFromPrevious=false;},eventPipe:function(e){let y=e.type;let t=e.target;switch(y){case'change':switch(true){case t.matches('[data-toggle]'):DF_DF1.handleToggle(t);break;case t.name==='journey_currency':DF_DF1.setCurrency(t);break;}
break;case'click':switch(true){case t.classList.contains('journey_base'):DF_DF1.restoredFromPrevious?t.value='':null;DF_DF1.initJourneySearch(e,t);break;case t.matches('[data-popup]'):DF_DF1.handlePopup(e,t);break;case t.parentNode.matches('[data-popup]'):DF_DF1.handlePopup(e,t.parentNode);break;case t.classList.contains('journey_timing'):let{legTxt,subLeg,storeLeg}=DF_DF1.utils.findLeg(t);if(DF_DF1.legOut.hasOpenTicket=="true"&&DF_DF1.submission.routeOut.sailing.isOpenChecked){DF_DF1.jumpFormState(e,'full_open_ticket');}
else if(legTxt==='return'&&DF_DF1.legRet.hasOpenTicket=="true"&&DF_DF1.submission.routeReturn.sailing.isOpenChecked){DF_DF1.jumpFormState(e,'return_open_ticket');}
else{switch(DF_DF1.formState[DF_DF1.formStateIndex]){case'initial_blank':case'showing_routes_list':case'entering_search_term':break;default:if(DF_DF1.moveDatePickerInModal){t.setAttribute('data-popup','date_picker');DF_DF1.handlePopup(e,t);}
else{if(DF_DF1.useDateRange&&!DF_DF1.submission.oneway){if(legTxt=="return"){legTxt="outbound";document.querySelector(".mbsc-segmented-item.mbsc-range-end").click();}else document.querySelector(".mbsc-segmented-item.mbsc-range-start").click();}
DF_DF1.jumpFormState(e,'entering_date_'+legTxt,t);}}}
e.preventDefault();break;case t.classList.contains('df_route_toggle'):let input=t.previousElementSibling;switch(DF_DF1.formState[DF_DF1.formStateIndex]){case'initial_blank':DF_DF1.changeFormState('inc',input);break;case'showing_routes_list':DF_DF1.changeFormState('dec',input);break;default:DF_DF1.jumpFormState(e,'initial_blank',input);}
break;case t.classList.contains('df_submit'):switch(DF_DF1.formState[DF_DF1.formStateIndex]){case'initial_blank':DF_DF1.initJourneySearch(e,DF_DF1.form.route_outbound);e.preventDefault();break;case'full_open_ticket':case'return_open_ticket':DF_DF1.jumpFormState(e,'entering_journey_info');e.preventDefault();break;case'entering_date_outbound':case'entering_date_return':case'entering_time_return':DF_DF1.changeFormState('inc');DF_DF1.changeFormState('inc');e.preventDefault();break;case'entering_time_outbound':if(DF_DF1.submission.oneway){DF_DF1.jumpFormState(e,'entering_journey_info');if(DF_DF1.changeStepOrder){DF_DF1.changeFlowStep(DF_DF1.flowStep[1]);}}
else{DF_DF1.changeFormState('inc');DF_DF1.changeFormState('inc');e.preventDefault();}
break;case'date_outbound_entered':case'date_return_entered':case'time_return_entered':DF_DF1.changeFormState('inc');e.preventDefault();break;default:DF_DF1.handleSubmit(e);}
break;case t.classList.contains('dp-controls'):{switch(true){case t.classList.contains('dp-controls-back'):{if(DF_DF1.formState[DF_DF1.formStateIndex]!=="entering_date_outbound"){DF_DF1.jumpFormState(null,DF_DF1.formState[DF_DF1.formStateIndex-2]);}else{DF_DF1.jumpFormState(null,'entering_journey_info');var cont=document.querySelector(".datePickerControls");if(cont!=null)cont.style='display: none;';}}
break;case t.classList.contains('dp-controls-close'):DF_DF1.jumpFormState(null,'entering_journey_info');var cont=document.querySelector(".datePickerControls");if(cont!=null)cont.style='display: none;';break;default:DF_DF1.jumpFormState(null,'entering_journey_info');var cont=document.querySelector(".datePickerControls");if(cont!=null)cont.style='display: none;';}}
break;case t.classList.contains('md-35'):var searchField=t.parentElement.querySelector('input');if(searchField.value.length>0){searchField.value='';DF_DF1.requestAutocomplete(searchField,searchField.value);}else{var routeName='';if(typeof(DF_DF1.legOut)!='undefined'){routeName=t.parentElement.className.includes('outbound')?DF_DF1.legOut.routeName:DF_DF1.legRet.routeName;searchField.value=routeName;DF_DF1.jumpFormState(null,'entering_journey_info');}else DF_DF1.jumpFormState(null,'initial_blank');if(document.querySelector('.animate.fadeInUp')!=null)document.querySelectorAll('.animate.fadeInUp').forEach(function(e){e.remove();});}
break;case t.classList.contains('md-37'):var searchField=t.parentElement.querySelector('.journey_base');DF_DF1.restoredFromPrevious?searchField.value='':null;DF_DF1.initJourneySearch(e,searchField);break;}
break;}},jumpToTop:()=>{document.documentElement.scrollTop=0;var popup=document.querySelector('.popup-wrap');if(popup!=null)popup.scrollIntoView();},buildErrors:()=>{let errors=[];let subLegOut=DF_DF1.submission.routeOut;let subLegRet=DF_DF1.submission.routeReturn;let checkPassengers=(subLeg)=>{let extraStr=subLeg===subLegRet?'_both_legs':'';if(subLeg.passengersTotal<1){errors.push(regionalText['validity_no_passengers'+extraStr]);}
else{if(subLeg.paxList.length!==subLeg.passengersTotal){errors.push(regionalText['validity_no_passenger_ages'+extraStr]);}
else if(typeof subLeg.paxList[0]!=='undefined'&&parseInt(subLeg.paxList[0].minAge)<18){errors.push(regionalText['validity_one_not_adult'+extraStr]);}
else{let agesCount=subLeg.paxList.reduce((acc,currItem)=>{typeof currItem.rangeStr!=='undefined'?acc+=1:null;return acc;},0)
if(agesCount!==subLeg.passengersTotal){errors.push(regionalText['validity_no_passenger_ages'+extraStr]);}}}};let checkVehicle=(subLeg)=>{let extraStr='';let checkCustomDetails=()=>{if(subLeg.vehicle.vehicleMakeEntered===null){errors.push(regionalText['validity_no_vehicle_make'+extraStr]);}
if(subLeg.vehicle.vehicleModelEntered===null){errors.push(regionalText['validity_no_vehicle_model'+extraStr]);}
if(subLeg.vehicle.vehicleLengthId===null){errors.push(regionalText['validity_no_vehicle_length'+extraStr]);}
if(subLeg.vehicle.vehicleHeightId===null){errors.push(regionalText['validity_no_vehicle_height'+extraStr]);}};let checkCaravanTrailer=()=>{if(subLeg.vehicle.caravanTrailerRadioValue){if(subLeg.vehicle.caravanTrailerTypeId===null){errors.push(regionalText['validity_no_caravan_type'+extraStr]);}
if(subLeg.vehicle.caravanTrailerLengthId===null){errors.push(regionalText['validity_no_caravan_length'+extraStr]);}
if(subLeg.vehicle.caravanTrailerHeightId===null){errors.push(regionalText['validity_no_caravan_height'+extraStr]);}}};if(subLeg.vehicle.vehicleTypeId===-1){errors.push(regionalText['validity_no_vehicle_type'+extraStr]);}
else if(subLeg.vehicle.vehicleTypeId>1)
{switch(subLeg.vehicle.vehicleTypeId){case 2:if(subLeg.vehicle.vehicleMakeId===-1){errors.push(regionalText['validity_no_vehicle_make'+extraStr]);}
else if(subLeg.vehicle.vehicleMakeId===967){checkCustomDetails();}
if(subLeg.vehicle.addLengthHeightRadioValue){if(subLeg.vehicle.vehicleAdditionalLengthId===0)errors.push(regionalText['validity_no_luggage_length'+extraStr]);if(subLeg.vehicle.vehicleAdditionalHeightId===0)errors.push(regionalText['validity_no_luggage_height'+extraStr]);}
checkCaravanTrailer();break;case 3:case 10:case 11:case 12:checkCustomDetails();checkCaravanTrailer();break;case 5:case 7:checkCustomDetails();break;}}};if(subLegOut.sailing.routeId===null){errors.push(regionalText.validity_no_route);}
let parseTimeError=()=>{return regionalText.validity_invalid_return_time.replace('[--X--]',DF_DF1.minDuration)}
if(subLegOut.sailing.timeId===-1&&!subLegOut.sailing.isOpenChecked){errors.push(regionalText.validity_invalid_outbound_time);}
checkPassengers(subLegOut);checkVehicle(subLegOut);if(subLegOut.sailing.timeId!==-1){try{var dateOut=DF_DF1.utils.parseDate(subLegOut.sailing.dateDep);var today=new Date();var dateNow=new Date(today.getFullYear(),today.getMonth(),today.getDate());var dateDiff=dateNow-dateOut;if(dateDiff===0&&today.getHours()>=subLegOut.sailing.timeId){errors.push(regionalText.validity_invalid_outbound_time);}}catch(e){}}
if(!DF_DF1.submission.oneway){if(subLegRet.sailing.routeId===null){errors.push(regionalText.validity_no_return_route);}
let addHoursToDate=(date,hours)=>{date.setTime(date.getTime()+hours*3600000);}
if(subLegRet.sailing.timeId===-1&&!subLegRet.sailing.isOpenChecked){errors.push(parseTimeError());}
if(subLegOut.sailing.timeId!==-1&&subLegRet.sailing.timeId!==-1)
{if(subLegOut.sailing.dateDep!=null&&subLegRet.sailing.dateDep!=null){let DateOut=DF_DF1.utils.parseDate(subLegOut.sailing.dateDep);let DateRet=DF_DF1.utils.parseDate(subLegRet.sailing.dateDep);let dateDiff=DateRet-DateOut;let timeDiff;if(dateDiff===0)
{timeDiff=(subLegRet.sailing.timeId-subLegOut.sailing.timeId)*60;}
else if(dateDiff===86400000)
{timeDiff=(addHoursToDate(DateRet,subLegRet.sailing.timeId)-addHoursToDate(DateOut,subLegOut.sailing.timeId))/60000;}
timeDiff<DF_DF1.minDuration?errors.push(parseTimeError()):null;}}
if(subLegOut.sailing.dateDep==null||subLegOut.sailing.dateDep=="1970-01-01")errors.push(regionalText.validity_invalid_outbound_date);if(subLegRet.sailing.dateDep==null||subLegRet.sailing.dateDep=="1970-01-01")errors.push(regionalText.validity_no_return_time);if(DF_DF1.submission.diffjourneys){checkPassengers(subLegRet);checkVehicle(subLegRet);}}
DF_DF1.submission.currency===null?errors.push(regionalText.validity_no_currency):null;return DF_DF1.showErrors(errors);},showErrors:(other_errors)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.error_messages'));errors=typeof other_errors!=='undefined'?DF_DF1.specialDateErrors.concat(other_errors):DF_DF1.specialDateErrors;if(errors.length===0){DF_DF1.form.classList.remove('invalid');return true;}
else{DF_DF1.form.classList.add('invalid');let errorMessages=DF_DF1.utils.buildElm({'tag':'section',cls:['error_messages']});let errorList=DF_DF1.utils.buildElm({'tag':'ul'});errors.forEach((error)=>{errorList.appendChild(DF_DF1.utils.buildElm({'tag':'li',txt:error}));})
errorMessages.appendChild(errorList);let journeyType=DF_DF1.form.querySelector('.journey_type');journeyType.parentNode.insertBefore(errorMessages,journeyType.nextElementSibling);if(DF_DF1.smallViewport){DF_DF1.jumpToTop();}else{var e1=DF_DF1.form.querySelector('.error_messages');e1.scrollIntoView({behavior:'smooth',block:'nearest'});}
DF_DF1.changeSubmitButtonState(false);return false;}},changeSubmitButtonState:(disabled)=>{try{$(window).on('pageshow',function(){DF_DF1.changeSubmitButtonState(false);});if(typeof(DF_DF1.submit)=="undefined")DF_DF1.submit=DF_DF1.form.querySelector('.df_submit');DF_DF1.submit.disabled=disabled;if(disabled){DF_DF1.submit.textContent='';var loader=document.createElement('img');loader.width=50;loader.src="https://static.directferries.co.uk/image/three-dots-white.svg";DF_DF1.submit.appendChild(loader);}else{DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("search");}}catch(error){DF_DF1.reportAnalytics('errorSubmitting',error.message,'');if(typeof(ga)=='function')ga('send','event','New dealfinder','Change submit button state failed for mobile',{nonInteraction:true})}},changeButtonState:(loading,popup,text)=>{var btn=popup?document.querySelector(".popup_done"):document.querySelector(".df_submit.hide_while_search");btn.textContent=text;if(loading){var loader=document.createElement('img');loader.src="https://static.directferries.co.uk/image/three-dots-white.svg";btn.appendChild(loader);btn.setAttribute("disabled","disabled");}else{btn.removeAttribute("disabled");}},handleSubmit:(e)=>{try{DF_DF1.setSubmissionDatesTimes();DF_DF1.valid=DF_DF1.buildErrors();if(DF_DF1.valid){try{ga('send','event','New Dealfinder-B','New Form State','Successful submit',{nonInteraction:true});}catch(error){}
DF_DF1.buildQString();DF_DF1.fillInHiddenFields();if(typeof(ga)=='function')ga('linker:decorate',DF_DF1.form);}
else{e.preventDefault();try{ga('send','event','New Dealfinder-B','New Form State','Errors shown',{nonInteraction:true});}catch(error){}}}catch(error){e.preventDefault();DF_DF1.reportAnalytics('errorSubmitting',error.message,'');}},fillInHiddenFields:function(){let journeyType;switch(true){case DF_DF1.submission.oneway:journeyType=1;break;case DF_DF1.submission.diffjourneys:journeyType=3;break;default:journeyType=2;};DF_DF1.form.querySelector('[name="h_currencyid"]').value=DF_DF1.submission.currency||1;DF_DF1.form.querySelector('[name="h_diffoutret"]').value=DF_DF1.submission.diffjourneys;DF_DF1.form.querySelector('[name="h_journeytype"]').value=journeyType;DF_DF1.form.querySelector('[name="h_legs"]').value=DF_DF1.buildSubmitLegs();DF_DF1.form.querySelector('[name="stdc"]').value=base_user_data.STDCCode;DF_DF1.form.querySelector('[name="stdc_hid"]').value=base_user_data.STDCCode;DF_DF1.form.querySelector('[name="vehicleTypeOut"]').value=DF_DF1.submission.routeOut.vehicle.vehicleRadioValue;DF_DF1.form.querySelector('[name="heightOut"]').value=DF_DF1.submission.routeOut.vehicle.addLengthHeightRadioValue;DF_DF1.form.querySelector('[name="caravanOut"]').value=DF_DF1.submission.routeOut.vehicle.caravanTrailerRadioValue;DF_DF1.form.querySelector('[name="vehicleTypeRet"]').value=DF_DF1.submission.routeReturn.vehicle.vehicleRadioValue;DF_DF1.form.querySelector('[name="heightRet"]').value=DF_DF1.submission.routeReturn.vehicle.addLengthHeightRadioValue;DF_DF1.form.querySelector('[name="caravanRet"]').value=DF_DF1.submission.routeReturn.vehicle.caravanTrailerRadioValue;var dfusrpid=readCookie('dfusrpid');var dfsession=readCookie('dfsession');var dfvisit=readCookie('dfvisit');if(dfusrpid!=null){dfusrpid=dfusrpid.split(',')[0];}
if(dfsession!=null){dfsession=dfsession.split(',')[0];}
if(dfvisit!=null){dfvisit=dfvisit.split(',')[0];}
if(DF_DF1.form.querySelector('[name="dfusrpidck"]').value=="")DF_DF1.form.querySelector('[name="dfusrpidck"]').value=dfusrpid;DF_DF1.form.querySelector('[name="dfsessionck"]').value=dfsession;DF_DF1.form.querySelector('[name="dfvisitck"]').value=dfvisit;DF_DF1.form.querySelector('[name="dfexpck"]').value=readCookie('dfexp');},buildSubmitLegs:()=>{let buildLeg=(subLeg)=>{let leg=JSON.parse(JSON.stringify(subLeg));leg.paxList.forEach((item,index)=>item.paxNo=index);leg.vehicle.addLengthHeightRadioValue=subLeg.vehicle.addLengthHeightRadioValue;leg.vehicle.caravanTrailerRadioValue=subLeg.vehicle.caravanTrailerRadioValue;leg.vehicle.vehicleRadioValue=subLeg.vehicle.vehicleRadioValue===false?'false':'true';if(DF_DF1.vehicleDimensionsSend){leg.vehicle.vehicleLengthId=subLeg.vehicle.vehicleLengthId===null||leg.vehicle.vehicleMakeId!=967?'-1':subLeg.vehicle.vehicleLengthId;leg.vehicle.vehicleHeightId=subLeg.vehicle.vehicleHeightId===null||leg.vehicle.vehicleMakeId!=967?'-1':subLeg.vehicle.vehicleHeightId;}else{leg.vehicle.vehicleLengthId=subLeg.vehicle.vehicleLengthId===null?'449':subLeg.vehicle.vehicleLengthId;leg.vehicle.vehicleHeightId=subLeg.vehicle.vehicleHeightId===null?'159':subLeg.vehicle.vehicleHeightId;}
leg.vehicle.vehicleMakeEntered=subLeg.vehicle.vehicleMakeEntered===null?'':subLeg.vehicle.vehicleMakeEntered;leg.vehicle.vehicleModelEntered=subLeg.vehicle.vehicleModelEntered===null?'':subLeg.vehicle.vehicleModelEntered;leg.vehicle.vehicleAdditionalHeightId=subLeg.vehicle.vehicleAdditionalHeightId===0?'-1':subLeg.vehicle.vehicleAdditionalHeightId;leg.vehicle.vehicleAdditionalLengthId=subLeg.vehicle.vehicleAdditionalLengthId===0?'-1':subLeg.vehicle.vehicleAdditionalLengthId;leg.vehicle.caravanTrailerHeightId=subLeg.vehicle.caravanTrailerHeightId===null?'-1':subLeg.vehicle.caravanTrailerHeightId;leg.vehicle.caravanTrailerLengthId=subLeg.vehicle.caravanTrailerLengthId===null?'-1':subLeg.vehicle.caravanTrailerLengthId;leg.vehicle.caravanTrailerTypeId=subLeg.vehicle.caravanTrailerTypeId===null?'-1':subLeg.vehicle.caravanTrailerTypeId;leg.residentDiscounts=subLeg.residentDiscounts===-1?'0':subLeg.residentDiscounts;leg.bookingDiscounts=subLeg.bookingDiscounts===-1?'0':subLeg.bookingDiscounts;return leg;}
let h_legs=[buildLeg(DF_DF1.submission.routeOut)];if(!DF_DF1.submission.oneway){if(DF_DF1.submission.diffjourneys){h_legs.push(buildLeg(DF_DF1.submission.routeReturn));}
else{DF_DF1.submission.routeReturn.bookingDiscounts=DF_DF1.submission.routeOut.bookingDiscounts;DF_DF1.submission.routeReturn.passengersTotal=DF_DF1.submission.routeOut.passengersTotal;DF_DF1.submission.routeReturn.paxList=DF_DF1.submission.routeOut.paxList;DF_DF1.submission.routeReturn.petCountTotal=DF_DF1.submission.routeOut.petCountTotal;DF_DF1.submission.routeReturn.petList=DF_DF1.submission.routeOut.petList;DF_DF1.submission.routeReturn.residentDiscounts=DF_DF1.submission.routeOut.residentDiscounts;DF_DF1.submission.routeReturn.vehicle=DF_DF1.submission.routeOut.vehicle;h_legs.push(buildLeg(DF_DF1.submission.routeReturn));}}
return JSON.stringify(h_legs);},buildQString:()=>{var action=DF_DF1.form.getAttribute('action');var stdc;if(DF_DF1.smallViewport&&base_user_data.STDCCode[0]!=='M'){stdc='M'+base_user_data.STDCCode;}else{stdc=base_user_data.STDCCode;}
var qParamString=window.location.search;if(qParamString.indexOf('mobileApp=true')!==-1&&qParamString.indexOf('app=')!==-1){var mType=qParamString.split("&").find(p=>p.includes("app=")).replace("app=","");if(typeof(mType)!='undefined'){stdc=stdc+"_"+mType
if(stdc[0]!=='M')stdc='M'+stdc;};}
if(DF_DF1.submission.routeOut.sailing.routeId==''){DF_DF1.reportAnalytics('missingSubmitParam','Route ID missing','');}
if(DF_DF1.submission.currency==''){DF_DF1.reportAnalytics('missingSubmitParam','Currency missing','');}
var qstring="?";if(action.indexOf('?')!==-1){qstring="&";}
if(action.indexOf('stdc')===-1&&qstring.indexOf('stdc')===-1){qstring=qstring+"stdc="+encodeURIComponent(stdc)+"&grid=0"+"&rfid="+encodeURIComponent(DF_DF1.submission.routeOut.sailing.routeId)+"&psgr="+encodeURIComponent(DF_DF1.submission.routeOut.passengersTotal)+"&curr="+encodeURIComponent(DF_DF1.submission.currency)+"&retn="+encodeURIComponent(!DF_DF1.submission.oneway)+"&rfidr="+encodeURIComponent(DF_DF1.submission.routeOut.sailing.routeIdRet)+"&outd="+encodeURIComponent(DF_DF1.submission.routeOut.sailing.dateDep)+"&outt="+encodeURIComponent(DF_DF1.submission.routeOut.sailing.timeId)+"&retd="+encodeURIComponent(DF_DF1.submission.routeReturn.sailing.dateDep)+"&rett="+encodeURIComponent(DF_DF1.submission.routeReturn.sailing.timeId);DF_DF1.form.setAttribute('action',action+qstring);}},changeFormState:(direction,input)=>{direction==='inc'?DF_DF1.formStateIndex++:DF_DF1.formStateIndex--;DF_DF1.formStateIndex>DF_DF1.formState.length-1?DF_DF1.formStateIndex=DF_DF1.formState.length-1:null;DF_DF1.applyNewFormState(DF_DF1.formState[DF_DF1.formStateIndex],input);},jumpFormState:(e,newState,input)=>{if(DF_DF1.formState[DF_DF1.formStateIndex]!==newState){DF_DF1.formStateIndex=DF_DF1.formState.indexOf(newState);DF_DF1.applyNewFormState(newState,input);}
e?e.preventDefault():null;},applyNewFormState:(newState,input)=>{DF_DF1.form.setAttribute('data-state',newState);DF_DF1.addContentSquareTracking(newState);if(DF_DF1.clearAllBtn&&newState=='showing_routes_list')DF_DF1.toogleClearButton(true);if(DF_DF1.clearAllBtn&&newState!='showing_routes_list'&&newState!='entering_search_term')DF_DF1.toogleClearButton(false);try{ga('send','event','New Dealfinder-B','New Form State',DF_DF1.formState[DF_DF1.formStateIndex],{nonInteraction:true});}catch(error){}
if(!DF_DF1.useDateRange&&newState.includes("entering_date_"))DF_DF1.reInitDate(newState.split("entering_date_")[1]);if(DF_DF1.timePickerModal&&newState.includes("entering_time_"))DF_DF1.buildTimePickerModal();switch(newState){case'initial_blank':if(input!=null)input.value='';DF_DF1.removePopups();DF_DF1.resetSubmittedTimes();DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("search");DF_DF1.routeIsSet=false;break;case'showing_routes_list':DF_DF1.requestAutocomplete(input,input.value);DF_DF1.resetSubmittedTimes();DF_DF1.submit.textContent=regionalText.submit_continue;break;case'entering_search_term':DF_DF1.resetSubmittedTimes();DF_DF1.submit.textContent=regionalText.submit_continue;break;case'entering_date_outbound':DF_DF1.enableField(DF_DF1.cal_outbound);DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("confirm_date");DF_DF1.buildDatepickerControls();if(DF_DF1.useDateRange){DF_DF1.buildCalendarHeader("calendar_header",regionalText.when_to_travel);if(DF_DF1.submission.oneway){if(document.querySelector(".cal_outbount_header")==null){var nDiv=DF_DF1.utils.buildElm({tag:'div',cls:['cal_outbount_header'],txt:regionalText.journey_title_outbound});var calHeader=document.querySelector(".journey_timing.timing_outbound.hide_until_times .mbsc-picker-header.mbsc-material");calHeader.insertBefore(nDiv,calHeader.lastChild);}}}
break;case'date_outbound_entered':break;case'entering_time_outbound':DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("confirm_time");DF_DF1.enableField(DF_DF1.time_outbound);if(DF_DF1.useDateRange){DF_DF1.buildCalendarHeader("calendar_header_time",regionalText.what_time_to_travel);}
break;case'time_outbound_entered':break;case'entering_date_return':DF_DF1.enableField(DF_DF1.cal_return);DF_DF1.enableField(DF_DF1.time_return);DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("confirm_date");DF_DF1.buildDatepickerControls();break;case'date_return_entered':break;case'entering_time_return':DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("confirm_time");break;case'time_return_entered':var cont=document.querySelector(".datePickerControls");if(cont!=null)cont.style='display: none;';if(DF_DF1.changeStepOrder){DF_DF1.changeFlowStep(DF_DF1.flowStep[1]);}
break;case'entering_journey_info':DF_DF1.enableField(DF_DF1.cal_outbound);DF_DF1.enableField(DF_DF1.time_outbound);DF_DF1.enableField(DF_DF1.cal_return);DF_DF1.enableField(DF_DF1.time_return);DF_DF1.submit.textContent=DF_DF1.utils.getCtaButtonTxt("search");var cont=document.querySelector(".datePickerControls");if(cont!=null)cont.style='display: none;';break;}},changeFlowStep:(step)=>{switch(step){case'open_calendar_details':DF_DF1.jumpFormState(null,'entering_date_outbound');break;case'open_passenger_details':document.querySelector(".deal_finder_wrap").classList.add("popup_in_progress");document.querySelector('.journey_details.passengers.trip_outbound.both_ways').click();break;case'open_vehicle_details':document.querySelector('.journey_details.vehicle.trip_outbound.both_ways').click();break;}},handleToggle:(toggle)=>{let toggleType=toggle.getAttribute('data-toggle');let op;switch(toggleType){case'journey_type':if(DF_DF1.routeIsSet){if(document.querySelector('.animate.fadeInUp')!=null)document.querySelector('.animate.fadeInUp').remove();DF_DF1.jumpFormState(null,'entering_journey_info');}
else DF_DF1.jumpFormState(null,'initial_blank');DF_DF1.form.classList.toggle('one_way');op=toggle.value==='1'&&toggle.checked?'add':'remove';DF_DF1.round_trip_fields.forEach((field)=>field.classList[op]('hide'));DF_DF1.trip_type_labels.forEach((label)=>label.classList.toggle('checked'));DF_DF1.diff_detail.checked=false;DF_DF1.handleToggle(DF_DF1.diff_detail);DF_DF1.setSubmissionData(null,['oneway'],{oneway:toggle.id==='journey_oneway'});if(!DF_DF1.restoredFromPrevious){DF_DF1.fetchJourneyDetail();if(DF_DF1.form.querySelector('#journey_round_trip').checked)
{DF_DF1.initialiseReturnDate();}}
DF_DF1.addContentSquareTracking("journey_type");break;case'diff_details':op=toggle.checked?'add':'remove';let reverse=op==='add'?'remove':'add';DF_DF1.form.classList[op]('different_journeys');DF_DF1.trip_outbound_fields.forEach
((field)=>{field.classList[reverse]('both_ways');field.classList[op]('outbound');});DF_DF1.diff_trips.forEach((field)=>field.classList[reverse]('hide'));DF_DF1.submission.diffjourneys=toggle.checked;if(!DF_DF1.submission.diffjourneys)DF_DF1.validateDiffJourneyOff();else DF_DF1.addContentSquareTracking("diff_details");DF_DF1.togglePetFields();break;case'open_ticket':DF_DF1.toggleOpenTicket(toggle);DF_DF1.addContentSquareTracking("open_ticket");break;case'resident_check':var val=toggle.checked?document.querySelector('#hdnResDiscount').value:'0';DF_DF1.setSubmissionData('outbound',['residentInfo'],{residentInfo:val});break;}},validateDiffJourneyOff:()=>{if(!DF_DF1.submission.oneway&&typeof(DF_DF1.submission.routeReturn)!='undefined'){var outboundSailing=DF_DF1.legOut;var returnSailing=DF_DF1.submission.routeReturn.sailing;if(typeof(outboundSailing)!='undefined'&&typeof(returnSailing)!='undefined'){DF_DF1.route_return.value=outboundSailing.routeNameRet;returnSailing.routeId=outboundSailing.routeIdRet.toString();returnSailing.portFromId=outboundSailing.portToId;returnSailing.portFromName=outboundSailing.portToName;returnSailing.portToId=outboundSailing.portFromId;returnSailing.portToName=outboundSailing.portFromName;}}},toggleAndEnableFields:()=>{verifyGlobalDeclared("mobiscroll",function(){DF_DF1.initCalendars()});verifyGlobalDeclared("mobiscroll",function(){DF_DF1.initTimes()});DF_DF1.enableOpenTicket();DF_DF1.togglePetFields();DF_DF1.setDefaultCurrency();},hasValidDate:()=>{DF_DF1.specialDateErrors=[];if(DF_DF1.legOut.dates.hasDates==="false"){DF_DF1.jumpFormState(null,'entering_journey_info');DF_DF1.specialDateErrors.push(DF_DF1.legOut.dates.noDatesMessage);}
if((DF_DF1.legRet!==null&&(typeof DF_DF1.legRet!=="undefined"))&&DF_DF1.legRet.dates.hasDates==="false"&&!DF_DF1.submission.oneway){DF_DF1.jumpFormState(null,'entering_journey_info');DF_DF1.specialDateErrors.push(DF_DF1.legRet.dates.noDatesMessage);}
DF_DF1.showErrors();return DF_DF1.specialDateErrors.length==0;},enableField:(field)=>field.classList.remove('disabled'),buildModal:(t)=>{let modalType=t.getAttribute('data-modal');let frag=document.createDocumentFragment();let modal_backdrop=DF_DF1.utils.buildElm({tag:'div',cls:['modal_backdrop']});let modal=DF_DF1.utils.buildElm({tag:'aside',cls:['modal']});let hdgTxt=regionalText['modal_'+modalType+'_hdg'];let content=regionalText['modal_'+modalType+'_cnt'];modal.appendChild(DF_DF1.utils.buildElm({tag:'button',cls:['modal_closer'],atts:{type:'button'}}));modal.appendChild(DF_DF1.utils.buildElm({tag:'h5',txt:hdgTxt}));let contents=DF_DF1.utils.buildElm({tag:'section'});contents.innerHTML=content;if(modalType=="pet_conditions"){var cont1=regionalText['modal_'+modalType+'_cnt1'];if(typeof(cont1)!='undefined')contents.innerHTML+="</br>"+cont1;var cont2=regionalText['modal_'+modalType+'_cnt2'];if(typeof(cont2)!='undefined')contents.innerHTML+="</br>"+cont2;}
modal.appendChild(contents);modal_backdrop.appendChild(modal);frag.appendChild(modal_backdrop);document.body.appendChild(frag);document.body.querySelector('.modal_backdrop').addEventListener('click',DF_DF1.modalEventPipe);},modalEventPipe:(e)=>{let t=e.target;if(t.classList.contains('modal_backdrop')||t.classList.contains('modal_closer')){DF_DF1.utils.checkRemoveElm(document.querySelector('.modal_backdrop'));}
else{e.preventDefault();}},setAllowedTimes:()=>{let addTimes=(field,prepop)=>{field.innerHTML='';DF_DF1.buildDropdownOptionSet(field,DF_DF1.utils.findLeg(field).storeLeg.times,prepop);};addTimes(DF_DF1.time_outbound,DF_DF1.submission.routeOut.sailing.timeId);returnData?addTimes(DF_DF1.time_return,DF_DF1.submission.routeReturn.sailing.timeId):null;},enableOpenTicket:()=>{let enableTicket=(field)=>{let{storeLeg,legTxt}=DF_DF1.utils.findLeg(field);let cls=DF_DF1['timing_'+legTxt].classList;storeLeg.hasOpenTicket==="true"?cls.add('allow_open_ticket'):cls.remove('allow_open_ticket');if(storeLeg.hasOpenTicket==="true")DF_DF1.moveDatePickerInModal=false;else DF_DF1.moveDatePickerInModal=!isMobileInDesktop&&false;};enableTicket(DF_DF1.open_ticket_outbound);if(!DF_DF1.submission.oneway){enableTicket(DF_DF1.open_ticket_return);}},toggleOpenTicket:(t)=>{var legTxt=DF_DF1.utils.findLeg(t).legTxt;var par=t.parentNode;if(t.checked){par.classList.add('selected');DF_DF1.cal_return.classList.remove('disabled');DF_DF1.time_return.classList.remove('disabled');if(legTxt==='outbound')
{DF_DF1.jumpFormState(null,'full_open_ticket');DF_DF1.cal_outbound.value=regionalText.calendar_out_open_ticket_hdg;DF_DF1.time_outbound.value=regionalText.calendar_both_open_ticket;}
else if(!DF_DF1.moveDatePickerInModal){DF_DF1.jumpFormState(null,'return_open_ticket');}
DF_DF1.cal_return.value=regionalText.calendar_return_open_ticket_hdg;DF_DF1.time_return.value=regionalText.calendar_both_open_ticket;}
else{par.classList.remove('selected');if(legTxt==='outbound')
{DF_DF1.jumpFormState(null,'entering_date_outbound');DF_DF1.cal_outbound.value='';DF_DF1.time_outbound.value='';}
else
{DF_DF1.jumpFormState(null,'entering_date_return');}
DF_DF1.cal_return.value='';DF_DF1.time_return.value='';}
DF_DF1.setSubmissionOpenTicket(t);},togglePetFields:()=>{let togglePets=(storeLeg,button)=>{if(typeof DF_DF1[storeLeg]!=='undefined'){DF_DF1[storeLeg].petTypes.length>0?button.classList.remove('hide'):button.classList.add('hide');}};togglePets('legOut',DF_DF1.form.querySelector('.pets.trip_outbound'));if(DF_DF1.submission.diffjourneys&&!DF_DF1.submission.oneway){togglePets('legRet',DF_DF1.form.querySelector('.pets.trip_return'));}},setDefaultCurrency:()=>{if(base_user_data.UserISO=="SG"&&(base_user_data.STDCCode=="DF10COM"||base_user_data.STDCCode=="MDF10COM")&&DF_DF1.currencies.find(cc=>cc.ddVal==11)!=undefined)defaultCurrency="11";var curText=DF_DF1.currencies[0].ddText;var curVal=DF_DF1.currencies[0].ddVal;if(typeof defaultCurrency!=='undefined'&&defaultCurrency!==curVal){DF_DF1.currencies.forEach(function(item){if(defaultCurrency===item.ddVal){curText=item.ddText;curVal=item.ddVal;}});}
DF_DF1.setSubmissionData(null,['currency'],{currency:parseInt(curVal)});document.body.querySelector('[data-popup="currency_popup"]').textContent=regionalText.currency_popup_hdg+': '+curText;},handlePopup:(e,t)=>{let popup;if(DF_DF1.smallViewport){popup=document.body.appendChild(DF_DF1.buildPopup(t));}
else{popup=document.body.querySelector('.deal_finder_wrap').appendChild(DF_DF1.buildPopup(t));}
popup.addEventListener('change',DF_DF1.popupEventPipe);popup.addEventListener('click',DF_DF1.popupEventPipe);if(DF_DF1.smallViewport){DF_DF1.jumpToTop();}
e.preventDefault();},popupEventPipe:(e)=>{let y=e.type;let t=e.target;let listitem;if(y==="click"&&(t.tagName==="LABEL"||(t.tagName==="INPUT"&&t.parentNode.tagName==="LABEL"))){let popup=document.querySelector('.popup');let fields=t.tagName==="LABEL"&&t.closest('.popup-wrap')!=null&&t.closest('.popup-wrap').id!=="currency_popup"?t.parentNode.querySelectorAll('label'):t.parentNode.parentNode.querySelectorAll('label');if(t.getAttribute('for')!="residentCheck")fields.forEach((field)=>field.classList.remove('checked'));t.tagName==="LABEL"?t.classList.add('checked'):t.parentNode.classList.add('checked');}
switch(y){case'change':switch(true){case t.classList.contains('booking_discount'):case t.classList.contains('resident_discount'):DF_DF1.setSubmissionDiscount(t);break;case t.name==='vehicle_extra_luggage':if(document.body.querySelector('#vehicle_extra_luggage_yes').checked){DF_DF1.addLuggageDimensions(t);}
else{DF_DF1.utils.checkRemoveElm(document.querySelector('.additional_dimensions'));}
break;case t.name==='caravan_trailer':if(document.body.querySelector('#caravan_trailer_yes').checked){DF_DF1.addCaravanTrailerDetails(t);}
else{DF_DF1.utils.checkRemoveElm(document.querySelector('.caravan_trailer_details'));}
break;case t.name==='caravan_trailer_details_select':listitem=t.parentNode.parentNode;if(listitem.classList.contains('chosen')){DF_DF1.expandList(listitem);}
break;case t.id==='outTimeDD':var tId='time_'+t.classList.value;document.getElementById(tId).value=t.options[t.value].text;break;}
break;case'click':switch(true){case t.classList.contains('modal_opener'):DF_DF1.buildModal(t);break;case t.classList.contains('car_label_field'):DF_DF1.removePopups(t);DF_DF1.handlePopup('data-popup');break;case t.classList.contains('add_passenger'):DF_DF1.addPassenger(t);break;case t.classList.contains('add_passenger2'):DF_DF1.addPassenger(t.parentElement);break;case t.classList.contains('remove_passenger'):DF_DF1.removePassenger(t);break;case t.classList.contains('decrement'):case t.classList.contains('increment'):DF_DF1.changePetCount(t);break;case t.classList.contains('popup_closer'):case t.parentNode.classList.contains('popup_closer'):if(DF_DF1.moveDatePickerInModal&&t.parentNode.classList.contains('date_picker'))DF_DF1.closeDatePickerPopup(t.parentElement.parentElement.parentElement);DF_DF1.removePopups();DF_DF1.addContentSquareTracking("popup_closed");break;case t.classList.contains('popup_done'):let removePopup=true;switch(true){case t.classList.contains('vehicle_base'):case t.classList.contains('vehicle_detail'):if(DF_DF1.validateVehicle(t)){DF_DF1.updateSubmitVehicleField(t);if(DF_DF1.changeStepOrder)DF_DF1.changeStepOrder=false;}
else{removePopup=false;}
DF_DF1.addContentSquareTracking("vehicle_base_entered");break;case t.classList.contains('passengers_popup'):DF_DF1.setSubmissionPassengers();if(DF_DF1.changeStepOrder){DF_DF1.removePopups(true);DF_DF1.changeFlowStep(DF_DF1.flowStep[2]);removePopup=false;}
DF_DF1.addContentSquareTracking("passengers_popup_entered");break;case t.classList.contains('currency_popup'):DF_DF1.setSubmissionCurrency();DF_DF1.addContentSquareTracking("currency_popup_entered");break;case t.classList.contains('date_picker'):if(DF_DF1.moveDatePickerInModal)DF_DF1.closeDatePickerPopup(t.parentElement.parentElement.parentElement);break;case t.classList.contains('pets_popup'):DF_DF1.addContentSquareTracking("pets_popup_entered");break;}
if(removePopup){DF_DF1.removePopups();}
break;case t.classList.contains('item_hdg'):t.nextElementSibling.classList.toggle('collapsed');break;case t.name==='vehicle_type'&&parseInt(t.value)>1&&parseInt(t.value)!=2056:DF_DF1.buildVehicleDetails(t);break;case t.name==='vehicle_type'&&(parseInt(t.value)<=1||parseInt(t.value)==2056):DF_DF1.updateSubmitVehicleField(t);DF_DF1.removePopups();break;case t.name==='vehicle_make'&&t.type==='radio':listitem=t.parentNode.parentNode;if(listitem.classList.contains('chosen')){DF_DF1.expandList(listitem);}
else{if(t.value==="967")DF_DF1.utils.checkRemoveElm(document.querySelector('.car_model_fields'));DF_DF1.utils.checkRemoveElm(document.querySelector('.error_messages'));DF_DF1.shrinkList(listitem);DF_DF1.requestCarModels(t);}
break;case t.name==='vehicle_model'&&t.type==='radio':listitem=t.parentNode.parentNode;if(listitem.classList.contains('chosen')){DF_DF1.expandList(listitem);}
else{DF_DF1.utils.checkRemoveElm(document.querySelector('.error_messages'));DF_DF1.shrinkList(listitem);if(t.value==="967"){DF_DF1.buildCustomvehicleDetails(t);DF_DF1.addPopupDone();}else{DF_DF1.addPopupDone();DF_DF1.buildLuggageToggle(t);DF_DF1.buildCaravanTrailerToggle(t);}}
break;case t.name==='additional_dimensions_length':case t.name==='additional_dimensions_height':case t.name==='caravan_trailer_details_length':case t.name==='caravan_trailer_details_height':case t.name==='custom_vehicle_length':case t.name==='custom_vehicle_height':listitem=t.parentNode.parentNode;if(listitem.classList.contains('chosen')){DF_DF1.expandList(listitem);}
else{DF_DF1.shrinkList(listitem);if(listitem.dataset.linked==='linked'){listitem.parentNode.nextElementSibling.nextElementSibling.classList.remove('collapsed');}}
break;}
break;}},addPopupDone:()=>{DF_DF1.utils.checkRemoveElm(document.querySelector('footer'));let footer=DF_DF1.utils.buildElm({tag:'footer'});var popupDoneTxt=DF_DF1.utils.getCtaButtonTxt("vehicle_detail");footer.appendChild(DF_DF1.utils.buildElm({tag:'button',txt:popupDoneTxt,cls:['popup_done','vehicle_detail'],atts:{type:'button'}}));if(!DF_DF1.smallViewport&&isMobileInDesktop)document.querySelector('.popup').appendChild(footer);else document.querySelector('.popup_body').appendChild(footer);},removePopups:(keepProgress)=>{if(!keepProgress)document.querySelector(".deal_finder_wrap").classList.remove("popup_in_progress");document.body.querySelectorAll('.popup, .route_list').forEach((item)=>item.remove());document.body.style.removeProperty("overflow");if(DF_DF1.smallViewport){document.body.querySelector('#deal_finder1').scrollIntoView();}},changePetCount:(t)=>{let par=t.parentNode;let output=par.querySelector('output');let dec=par.querySelector('.decrement');let inc=par.querySelector('.increment');let max=parseInt(output.getAttribute('data-limit'));let currVal=parseInt(output.textContent);let newVal;if(t.classList.contains('decrement')&&currVal>0){inc.classList.remove('inactive');newVal=currVal-1;}
else if(t.classList.contains('increment')&&currVal<max){dec.classList.remove('inactive');newVal=currVal+1;}
if(newVal===0){dec.classList.add('inactive');}
else if(newVal>=max){inc.classList.add('inactive');}
output.textContent=newVal;DF_DF1.setSubmissionPetCount(output);},buildDropdown:(ident,fieldType,legTxt,storeArr,preselectVal)=>{let label=DF_DF1.utils.buildElm({tag:'label',cls:['long'],atts:{'for':ident+fieldType}});let dropdown=DF_DF1.utils.buildElm({'tag':'select',cls:[ident+'_'+legTxt],atts:{id:ident+fieldType,name:ident}});DF_DF1.buildDropdownOptionSet(dropdown,storeArr,preselectVal);label.appendChild(dropdown);return label;},buildDropdownOptionSet:(dropdown,arr,preselectVal)=>{arr.forEach((item)=>{let opt=DF_DF1.utils.buildElm({tag:'option',txt:item.ddText,atts:{value:item.ddVal}});if(preselectVal){opt.value===preselectVal.toString()?opt.setAttribute('selected',''):null;}
dropdown.appendChild(opt);})},buildRadioTogglePair:(subcont,ident,lblTxtNo,lblTxtYes,legTxt,checkNo)=>{let buildSingleRadio=(lblTxt,toggleType,value,checked)=>{let label,radio;label=DF_DF1.utils.buildElm({tag:'label',txt:lblTxt,cls:[ident,'radiolabel'],atts:{'for':ident+toggleType}});radio=DF_DF1.utils.buildElm({tag:'input',cls:[ident+'_'+legTxt],atts:{type:'radio',id:ident+toggleType,'name':ident,value:value,'data-toggle':ident}});checked?radio.setAttribute('checked',''):null;checked?label.classList.add('checked'):null;label.appendChild(radio);return label;};subcont.appendChild(buildSingleRadio(lblTxtNo,'_no',false,checkNo));subcont.appendChild(buildSingleRadio(lblTxtYes,'_yes',true,!checkNo));},buildPopup:(t)=>{let{storeLeg,subLeg,legTxt}=DF_DF1.utils.findLeg(t);let popupType=t.getAttribute('data-popup');DF_DF1.addContentSquareTracking("entering_"+popupType);let popup=DF_DF1.utils.buildElm({tag:'aside',cls:['popup'],atts:{id:popupType,style:"overflow-y: auto; height: 10px"}});if(DF_DF1.popupSlider)popup.classList.add('popup_slider');let popupDiv=DF_DF1.utils.buildElm({tag:'div',cls:['popup-wrap'],atts:{id:popupType}});popup.appendChild(popupDiv);switch(popupType){case'passengers_popup':DF_DF1.buildPopupParts(popupDiv,popupType,regionalText.passengers_popup_hdg,DF_DF1.buildPassengersContent(legTxt,storeLeg,subLeg));break;case'pets_popup':DF_DF1.buildPopupParts(popupDiv,popupType,regionalText.pets_popup_hdg,DF_DF1.buildPetsContent(legTxt,storeLeg,subLeg));break;case'vehicle_base':DF_DF1.buildPopupParts(popupDiv,popupType,regionalText.vehicles_popup_hdg,DF_DF1.buildVehicleContent(legTxt,storeLeg,subLeg));break;case'currency_popup':DF_DF1.buildPopupParts(popupDiv,popupType,regionalText.currency_popup_hdg,DF_DF1.buildCurrencyContent(legTxt,storeLeg,subLeg));break;case'date_picker':if(DF_DF1.moveDatePickerInModal){var style=document.createElement('style');style.type='text/css';style.innerHTML=".date_picker_wrap {padding: 0;} .date_picker_wrap {grid-row: 1;} .date_picker_wrap {grid-template-rows: auto 1fr;} .date_picker_wrap {background-color: transparent; padding: 0;} .date_picker_wrap {padding: 0;} .date_picker_wrap .timeDD {  display: flex;  flex-direction: row;  justify-content: center;  grid-column: 1 / 3;  height: initial;  min-height: 40px;  margin-bottom: 30px;  margin-top: 30px;  padding: 10px;  border-radius: 4px;  background-color: #edebe6; } .date_picker_wrap .timeDD .timeDD-label {width: 50%; font-size: 18px; display: flex; align-items: center; justify-content: flex-end; padding-right: 10px;} .date_picker_wrap .timeDD .timeDD-select-wrap {width: 50%; display: flex; justify-content: flex-start; align-items: center; padding-left: 10px;} .date_picker_wrap .timeDD .timeDD-select-cont {position: relative;} .date_picker_wrap .timeDD select#outTimeDD {border: 1px solid #c9c9c9; border-radius: 4px; box-sizing: border-box; font-size: 18px; padding: 4px;} .date_picker_wrap .mbsc-cal-scroll {width: 100% !important;} .date_picker_wrap .mbsc-material .mbsc-cal-day-date { display: inline-block; width: 32px !important; height: 32px !important; line-height: 31px !important; font-size: 16px !important; font-weight: 500; border: 4px solid transparent !important; margin: 0; color: #000; } .date_picker_wrap .mbsc-material .mbsc-cal-today.mbsc-selected .mbsc-cal-day-date, .date_picker_wrap .mbsc-material .mbsc-cal-today .mbsc-cal-day-date { font-weight: bold; color: #193354 !important; background: #edebe6 !important; border: 4px solid #d3d0cb !important; } .date_picker_wrap .mbsc-material .mbsc-selected { font-weight: 700; border-color: #adaba6; border-width: 4px; font-size: 22px; } .date_picker_wrap .mbsc-material .mbsc-selected .mbsc-cal-day-date { font-weight: bold; color: white; background: #ff4a0e !important; border: 4px solid #ffae40 !important; } .date_picker_wrap .mbsc-material .mbsc-selected.mbsc-cal-today .mbsc-cal-day-date { font-weight: bold; color: white !important; background: #ff4a0e !important; border: 4px solid #ffae40 !important; } .date_picker_wrap .mbsc-material .mbsc-cal .mbsc-cal-btn { height: 1em; } .date_picker_wrap .mbsc-cal-days { border-top: solid 1px #eee; border-bottom: solid 1px #eee; padding: 5px 0; margin-top: 0; } .date_picker_wrap .mbsc-cal-slide, .date_picker_wrap .mbsc-cal-days { padding: 0 8px; } .date_picker_wrap .mbsc-material .mbsc-cal-days > div { font-weight: normal !important; color: #aaa; width: 39px !important; height: 36px !important; line-height: 36px !important; font-size: 16px !important; font-weight: 500; } .date_picker_wrap .mbsc-ic-material-keyboard-arrow-left::before, .date_picker_wrap .journey_timing .newDatepicker.mbsc-material .mbsc-fr-btn, .date_picker_wrap .journey_timing .newTimepicker.mbsc-material .mbsc-fr-btn { color: #666666 !important; } .date_picker_wrap .mbsc-material .mbsc-cal-year, .date_picker_wrap .mbsc-material .mbsc-cal-month { color: #193354; font-weight: 300; } .date_picker_wrap .mbsc-material .mbsc-sc-itm { font-size: 20px; } .date_picker_wrap .mbsc-material .mbsc-sc-whl-l { border-top: 4px solid #ccc !important; border-bottom: 4px solid #ccc !important; } .date_picker_wrap .mbsc-sc-itm.mbsc-btn-e.mbsc-sc-itm-sel { font-size: 26px; } .date_picker_wrap .mbsc-sc-whl-gr { width: 50%; } .date_picker_wrap .newDatepicker .mbsc-fr-w, .date_picker_wrap .newTimepicker .mbsc-fr-w { background-color: #fff; font-family: 'Catamaran', 'sans-serif'; } .date_picker_wrap .newDatepicker.mbsc-material .mbsc-fr-hdr, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-fr-hdr { font-size: 18px; font-weight: 700; padding: 0; color: #193354; height: 40px; align-items: center; text-transform: none; } .date_picker_wrap .newDatepicker.mbsc-material .mbsc-fr-btn, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-fr-btn { color: #193354; } .date_picker_wrap .newDatepicker.mbsc-material .mbsc-cal-month, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-cal-month, .date_picker_wrap .newDatepicker.mbsc-material .mbsc-cal-year, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-cal-year { font-weight: 300; } .date_picker_wrap .newDatepicker.mbsc-material .mbsc-cal-c, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-cal-c { padding: 0; } .date_picker_wrap .newDatepicker.mbsc-material .mbsc-sc-whl-l, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-sc-whl-l { border-color: #e4f3fa; } .date_picker_wrap .newDatepicker.mbsc-material .mbsc-sc-itm-sel, .date_picker_wrap .newTimepicker.mbsc-material .mbsc-sc-itm-sel { font-weight: 700; }";let title=legTxt=='outbound'?regionalText.journey_title_outbound:regionalText.journey_title_return;DF_DF1.buildPopupParts(popupDiv,popupType,title,DF_DF1.utils.buildElm({tag:'div',cls:['journeyType'],atts:{'data-journeytype':legTxt}}));var cal=t.querySelector('div.mbsc-fr.mbsc-material.mbsc-fr-inline.newDatepicker');var w=DF_DF1.utils.buildElm({tag:'div',cls:['date_picker_wrap']});w.appendChild(style);w.appendChild(cal);var dOutTime=DF_DF1.utils.buildElm({tag:'div',cls:['timeDD'],atts:{id:'outTime'}});var timeLabelT=legTxt=='outbound'?regionalText.time_out_hdg:regionalText.time_return_hdg;var timeDDLabel=DF_DF1.utils.buildElm({tag:'div',cls:['timeDD-label'],txt:timeLabelT});var timeDDSelectW=DF_DF1.utils.buildElm({tag:'div',cls:['timeDD-select-wrap']});var timeDDSelectC=DF_DF1.utils.buildElm({tag:'div',cls:['timeDD-select-cont']});var select=DF_DF1.utils.buildElm({tag:'select',cls:[legTxt],atts:{id:'outTimeDD'}});var times=DF_DF1.utils.findLeg(t).storeLeg.times.filter(function(i){return i.ddVal!="-1"});var valT=document.getElementById('time_'+legTxt).value;var preSel=times.find(function(i){return i.ddText==valT});var sel=preSel!=undefined?preSel.ddVal:null;DF_DF1.buildDropdownOptionSet(select,times,sel);timeDDSelectC.appendChild(select);timeDDSelectW.appendChild(timeDDSelectC);dOutTime.appendChild(timeDDLabel);dOutTime.appendChild(timeDDSelectW);w.appendChild(dOutTime);var p=popupDiv.querySelector('.popup_body');var foot=p.querySelector('footer');p.insertBefore(w,foot);}
break;}
if(!DF_DF1.smallViewport&&isMobileInDesktop){popup.appendChild(DF_DF1.buildPopupDone(popupType));}
document.documentElement.scrollTop=0;if(DF_DF1.smallViewport)document.body.style.overflow='hidden';return popup;},buildPopupParts:(popup,popupType,hdgTxt,contents,subpop,subHdgTxt,hidePopupDone)=>{let popupHead=DF_DF1.utils.buildElm({tag:'div',cls:['popup_head']});let frag=document.createDocumentFragment();frag.appendChild(popupHead);let closeButton=DF_DF1.utils.buildElm({tag:'button',cls:['popup_closer',popupType],atts:{type:'button'}});closeButton.appendChild(DF_DF1.utils.buildElm({tag:'i',cls:['material-icons'],txt:'arrow_back_ios'}));popupHead.appendChild(DF_DF1.utils.buildElm({tag:'h1',txt:hdgTxt}));popupHead.appendChild(closeButton);let popupBody=DF_DF1.utils.buildElm({tag:'div',cls:['popup_body']});contents?popupBody.appendChild(contents):null;frag.appendChild(popupBody);if(!hidePopupDone&&(DF_DF1.smallViewport||!isMobileInDesktop)){let footer=DF_DF1.buildPopupDone(popupType);popupBody.appendChild(footer);}
popup.appendChild(frag);},buildPopupDone:(popupType)=>{let footer=DF_DF1.utils.buildElm({tag:'footer'});var popupDoneTxt=DF_DF1.utils.getCtaButtonTxt(popupType);footer.appendChild(DF_DF1.utils.buildElm({tag:'button',txt:popupDoneTxt,cls:['popup_done',popupType],atts:{type:'button'}}));return footer;},buildAPassenger:(subLeg,legTxt,count,descTxt,prepop,wheelchairAvail,list,storeLeg)=>{let wident,wlabel,winput,label,input;let index=count-1;let value=prepop>index?subLeg.paxList[index].age:30;let ident='passenger'+count+'_'+legTxt;let item=DF_DF1.utils.buildElm({tag:'li'});let span=DF_DF1.utils.buildElm({tag:'span',txt:descTxt});item.appendChild(span);if(wheelchairAvail){wident='wheelchair'+count+'_'+legTxt;wlabel=DF_DF1.utils.buildElm({tag:'label',cls:['passenger_wheelchair'],atts:{'for':wident}});winput=DF_DF1.utils.buildElm({tag:'input',atts:{'id':wident,'type':'checkbox'}});if(typeof subLeg.paxList[index]!=='undefined'&&typeof subLeg.paxList[index].isWc!=='undefined'&&subLeg.paxList[index].isWc){winput.setAttribute('checked',true);}
wlabel.appendChild(winput);item.appendChild(wlabel);}
label=DF_DF1.utils.buildElm({tag:'label',cls:['passenger_age_label'],txt:regionalText.passengers_age,atts:{'for':ident}});if(count===1)
{let adultsArr=storeLeg.passengerAges.filter((item)=>item.minAge>17);let baseAge=typeof subLeg.paxList[index]!=='undefined'?subLeg.paxList[index].minAge:30;let defaultRange=adultsArr.find((item)=>parseInt(item.minAge)<=baseAge).rangeStr;input=DF_DF1.utils.buildElm({'tag':'select',cls:['passenger_age'],atts:{id:ident,name:ident}});adultsArr.forEach((ageitem)=>{let opt=DF_DF1.utils.buildElm({tag:'option',txt:ageitem.rangeStr,atts:{value:ageitem.minAge}});ageitem.rangeStr===defaultRange?opt.setAttribute('selected',''):null;input.appendChild(opt);})}
else{input=DF_DF1.utils.buildElm({'tag':'select',cls:['passenger_age'],atts:{id:ident,name:ident}});let baseAge=typeof subLeg.paxList[index]!=='undefined'?subLeg.paxList[index].minAge:30;let defaultRange=storeLeg.passengerAges.find((item)=>parseInt(item.minAge)<=baseAge).rangeStr;storeLeg.passengerAges.forEach((ageitem)=>{let opt=DF_DF1.utils.buildElm({tag:'option',txt:ageitem.rangeStr,atts:{value:ageitem.minAge}});ageitem.rangeStr===defaultRange?opt.setAttribute('selected',''):null;input.appendChild(opt);})}
label.appendChild(input);item.appendChild(label);if(count>1){item.appendChild(DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','remove_passenger'],txt:'remove_circle'}));}
list.appendChild(item);},buildPassengersContent:(legTxt,storeLeg,subLeg)=>{var improvePassengerContent=false;let contents=document.createDocumentFragment();let subcont=DF_DF1.utils.buildElm({tag:'fieldset'});let list=DF_DF1.utils.buildElm({tag:'ol',cls:['passengers_list'],atts:{id:'pass_list_'+legTxt}});let prepop=subLeg.paxList.length;let wheelchairAvail=storeLeg.hasWheelchair==='true';if(DF_DF1.separatePassengers){var style=document.createElement('style');style.type='text/css';style.innerHTML=".popup#passengers_popup .pax_counter span, .popup#passengers_popup .pax_counter output { display: inline-flex; justify-content: center; align-items: center; height: 40px; border: 1px solid #cccccc; }  .popup#passengers_popup .pax_counter output { width: 40px; border-width: 1px 0; border: none; font-size: 18px; }  .popup#passengers_popup .pax_counter span { width: 40px; cursor: pointer; background: #f3f3f3; }  .popup#passengers_popup .pax_counter span.inactive { background-color: #eee; color: #cccccc; pointer-events: none; cursor: default; }  .popup#passengers_popup .pax_counter span.decrement-pax { border-radius: 4px; margin-left: auto; }  .popup#passengers_popup .pax_counter span.increment-pax { border-radius: 4px; }  .popup#passengers_popup label.pax_counter { font-weight: bold; padding: 0 16px; min-height: 56px; padding-top: 10px; padding-bottom: 10px; cursor: pointer; color: #193354; border-radius: 4px; margin-bottom: 16px; font-family: 'Catamaran', 'sans-serif'; font-size: 15px; background: #edebe6; position: relative; display: flex; align-items: center; touch-action: manipulation; }  .child-age-inputs { display: flex; flex-wrap: wrap; margin-bottom: 20px; }  .child-age-inputs .child-age { width: 30%; margin: 0 3% 16px 0; border-radius: 4px; position: relative; }  .child-age-inputs .child-age label.passenger_age_label { visibility: hidden; margin-bottom: 0; padding: 5px; position: relative; display: inline-block; width: 100%; }  .child-age-inputs .child-age label.passenger_age_label select { visibility: visible; width: 100%; outline: none; padding: 8px; border-radius: 5px; color: #193354; position: absolute; border: none; background: #edebe6; -webkit-appearance: none; top: 0; left: 0; }  .child-age-inputs .child-age i { position: absolute; right: 5px; top: 8px; }  .notes p.pax-note { text-align: left; margin: 10px 0 10px; font-size: 14px; }  .popup-wrap#passengers_popup .popup_body { display: flex; flex-direction: column; }";document.getElementsByTagName('head')[0].appendChild(style);var adultsCount=subLeg.paxList.filter(function(i){return i.minAge>=18;}).length;var childrenCount=subLeg.paxList.filter(function(i){return i.minAge<18;}).length;var fAdd=function(){var max=0;var qty=this.parentElement.querySelector('.qty');var addChildren=(qty.id=="total-children");var totalAdults=0;if(DF_DF1.groupAdultsByAge){var totals=document.querySelectorAll('#total-adults');totals.forEach(function(t){totalAdults=totalAdults+Number(t.textContent)});}else totalAdults=Number(document.querySelector('#total-adults').textContent);var totalChildren=Number(document.querySelector('#total-children').textContent);if(addChildren)max=9-totalAdults;else max=9-totalChildren;var amount=Number(qty.textContent);if(amount<max){qty.textContent=amount+1;var min=0;if(addChildren)DF_DF1.buildChildrenAgeSelect(1);else min=1;if(amount+1>min)this.parentElement.querySelector('.decrement-pax').classList.remove('inactive');if(DF_DF1.groupAdultsByAge){var adultTotals=0;var totals=document.querySelectorAll('#total-adults');totals.forEach(function(t){adultTotals=adultTotals+Number(t.textContent);});if(adultTotals>1)totals.forEach(function(t){if(Number(t.textContent)>0)t.parentElement.querySelector('.decrement-pax').classList.remove('inactive');});}
let total=totalAdults+totalChildren+1;if(total==9){if(document.querySelectorAll('.increment-pax').length>0)document.querySelectorAll('.increment-pax').forEach(function(i){i.classList.add('inactive');});}}};var fSubstract=function(){var min=0;var qty=this.parentElement.querySelector('.qty');var addChildren=(qty.id=="total-children");var amount=Number(qty.textContent);if(DF_DF1.groupAdultsByAge){if(!addChildren){var adultTotals=0;var totals=document.querySelectorAll('#total-adults');totals.forEach(function(t){adultTotals=adultTotals+Number(t.textContent);});if(adultTotals<=1)min=1;}}
else if(!addChildren)min=1;if(amount>min){var newTotal=amount-1;qty.textContent=newTotal;if(addChildren)DF_DF1.buildChildrenAgeSelect(-1);if(document.querySelectorAll('.increment-pax').length>0)document.querySelectorAll('.increment-pax').forEach(function(i){i.classList.remove('inactive');});if(DF_DF1.groupAdultsByAge&&!addChildren){var adultT=0;var totals=document.querySelectorAll('#total-adults');totals.forEach(function(t){adultT=adultT+Number(t.textContent);});if(adultT<=1){totals.forEach(function(t){t.parentElement.querySelector('.decrement-pax').classList.add('inactive');});}
if(newTotal==0)this.classList.add('inactive');}else if(min==newTotal)this.classList.add('inactive');}};let totalPax=adultsCount+childrenCount;if(DF_DF1.groupAdultsByAge){var ages=legTxt=='outbound'?DF_DF1.legOut.passengerAges:DF_DF1.legRet.passengerAges;var adults=ages.filter(function(i){return i.minAge>=18;});adults.forEach(function(a){var aCount=subLeg.paxList.filter(function(i){return i.minAge>=a.minAge&&i.minAge<=a.maxAge;}).length;let adultsLabel=DF_DF1.utils.buildElm({tag:'label',cls:['pax_counter'],atts:{'for':'total-adults','data-age':a.rangeStr},txt:regionalText.passengers_adults+" ("+a.rangeStr+")"});let adultsDecSpan=DF_DF1.utils.buildElm({tag:'span',cls:['decrement-pax'],txt:'-'});let adultsOutput=DF_DF1.utils.buildElm({tag:'output',cls:['qty'],atts:{id:'total-adults','name':'total-adults'},txt:aCount});let adultsIncSpan=DF_DF1.utils.buildElm({tag:'span',cls:['increment-pax'],txt:'+'});adultsIncSpan.onclick=fAdd;adultsDecSpan.onclick=fSubstract;adultsLabel.appendChild(adultsDecSpan);adultsLabel.appendChild(adultsOutput);adultsLabel.appendChild(adultsIncSpan);if(totalPax==9){adultsLabel.querySelector('.increment-pax').classList.add('inactive');}
if(adultsCount<=1||Number(aCount)<=0){adultsLabel.querySelector('.decrement-pax').classList.add('inactive');}
list.appendChild(adultsLabel);});}else{let adultsLabel=DF_DF1.utils.buildElm({tag:'label',cls:['pax_counter'],atts:{'for':'total-adults'},txt:regionalText.passengers_adults+" (18+)"});let adultsDecSpan=DF_DF1.utils.buildElm({tag:'span',cls:['decrement-pax'],txt:'-'});let adultsOutput=DF_DF1.utils.buildElm({tag:'output',cls:['qty'],atts:{id:'total-adults','name':'total-adults'},txt:adultsCount});let adultsIncSpan=DF_DF1.utils.buildElm({tag:'span',cls:['increment-pax'],txt:'+'});adultsIncSpan.onclick=fAdd;adultsDecSpan.onclick=fSubstract;adultsLabel.appendChild(adultsDecSpan);adultsLabel.appendChild(adultsOutput);adultsLabel.appendChild(adultsIncSpan);if(totalPax==9){adultsLabel.querySelector('.increment-pax').classList.add('inactive');}
if(adultsCount<=1){adultsLabel.querySelector('.decrement-pax').classList.add('inactive');}
list.appendChild(adultsLabel);}
let childrenLabel=DF_DF1.utils.buildElm({tag:'label',cls:['pax_counter'],atts:{'for':'total-children'},txt:regionalText.passengers_children+" (0-17)"});let childrenDecSpan=DF_DF1.utils.buildElm({tag:'span',cls:['decrement-pax'],txt:'-'});let childrenOutput=DF_DF1.utils.buildElm({tag:'output',cls:['qty'],atts:{id:'total-children','name':'total-children'},txt:childrenCount});let childrenIncSpan=DF_DF1.utils.buildElm({tag:'span',cls:['increment-pax'],txt:'+'});childrenIncSpan.onclick=fAdd;childrenDecSpan.onclick=fSubstract;childrenLabel.appendChild(childrenDecSpan);childrenLabel.appendChild(childrenOutput);childrenLabel.appendChild(childrenIncSpan);if(totalPax==9){childrenLabel.querySelector('.increment-pax').classList.add('inactive');}
if(childrenCount==0){childrenLabel.querySelector('.decrement-pax').classList.add('inactive');}
list.appendChild(childrenLabel);}else{DF_DF1.buildAPassenger(subLeg,legTxt,1,regionalText.passengers_first_text,prepop,wheelchairAvail,list,storeLeg);if(prepop>1){for(let i=2;i<=prepop;i++){DF_DF1.buildAPassenger(subLeg,legTxt,i,regionalText.passengers_base_text,prepop,wheelchairAvail,list,storeLeg);}}}
subcont.appendChild(list);let addPassTrigger=DF_DF1.utils.buildElm({tag:'div',txt:regionalText.passengers_add,cls:['add_passenger'],atts:{id:'add_passenger_'+legTxt}});if(improvePassengerContent){let addCircleIcon=DF_DF1.utils.buildElm({tag:'i',txt:"add_circle",cls:['material-icons','add_passenger2']});addPassTrigger.id="add_passenger_new";addPassTrigger.prepend(addCircleIcon);let passengerLabel;if(subLeg.paxList.length>1){passengerLabel=regionalText.passenger_plural.replace('[--X--]',subLeg.paxList.length);}
else{passengerLabel=regionalText.passenger_single;}
let passengersCountDiv=DF_DF1.utils.buildElm({tag:'div',cls:['paxCountLabel'],txt:passengerLabel});contents.appendChild(passengersCountDiv);}
if(!DF_DF1.separatePassengers){subcont.appendChild(addPassTrigger);}
contents.appendChild(subcont);let notes=DF_DF1.utils.buildElm({tag:'section',cls:['notes']});let note=DF_DF1.utils.buildElm({tag:'p',txt:regionalText.passengers_note,cls:['note']});if(DF_DF1.separatePassengers){var children=subLeg.paxList.filter(function(i){return i.minAge<18;});var childrenCount=children.length;if(childrenCount>0){children.forEach((child)=>{var selectedValue=child.minAge;DF_DF1.buildChildrenAgeSelect(1,selectedValue,notes);});}}
else{notes.appendChild(note);}
if(improvePassengerContent){let divPeople=DF_DF1.utils.buildElm({tag:'div',cls:['addPaxSplashIcon']});if(subLeg.paxList.length>2){divPeople.classList.add('hide');}
let iPeople=DF_DF1.utils.buildElm({tag:'i',txt:"people",cls:['material-icons']});divPeople.appendChild(iPeople);notes.appendChild(divPeople);}
contents.appendChild(notes);let buildDiscounts=(discountName,chosenOption,lblTxt,cls,modalTxt)=>{let discDD;ident=discountName+'_'+legTxt;label=DF_DF1.utils.buildElm({tag:'label',txt:regionalText[lblTxt],cls:['long'],atts:{'for':ident}});discDD=DF_DF1.utils.buildElm({tag:'select',cls:cls,atts:{id:ident,name:ident}});DF_DF1.buildDropdownOptionSet(discDD,storeLeg[discountName],subLeg[chosenOption].toString());label.appendChild(discDD);contents.appendChild(label);contents.appendChild(DF_DF1.utils.buildElm({tag:'button',txt:regionalText[modalTxt],cls:['modal_opener'],atts:{type:'button','data-modal':cls}}));};if(storeLeg.bookingDiscounts.length>0){buildDiscounts('bookingDiscounts','bookingDiscountOption','passengers_popup_booking_discount',['booking_discount'],'modal_booking_discount_hdg');}
if(storeLeg.residentDiscounts.length>0){buildDiscounts('residentDiscounts','residentInfo','passengers_popup_resident_discount',['resident_discount'],'modal_resident_discount_hdg');}
if(improvePassengerContent){$(document).ready(function(){var style=document.createElement('style');style.type='text/css';style.innerHTML="@media (max-width: 10000px) { #passengers_popup .popup-wrap .popup_body {display: flex; flex-direction: column; min-height: 80vh;} #passengers_popup .popup-wrap .popup_body section.notes {flex-grow: 2; margin-top: 8px; margin-bottom: 8px;} #passengers_popup .popup footer {flex: inherit;} #passengers_popup .popup-wrap .popup_body fieldset .passengers_list li { background-image: url(\"data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23dddddd' fill-opacity='0.74' fill-rule='evenodd'%3E%3Cpath d='M5 0h1L0 6V5zM6 5v1H5z'/%3E%3C/g%3E%3C/svg%3E\"); background-color: #f5f5f5; } #passengers_popup .popup-wrap .popup_body div#add_passenger_new.add_passenger {font-weight: normal; text-align: center; font-size: 15px; display: block; width: 80%; background: #45b7ed; cursor: pointer; margin: 0 auto; color: #fff; padding: 8px 30px;} #passengers_popup .popup-wrap .popup_body div#add_passenger_new.add_passenger.disabled {background-color: #eee; background-image: none; border-color: #ccc; color: #ccc;} #passengers_popup .popup-wrap .popup_body div#add_passenger_new.add_passenger i {margin-right: 4px; font-size: 22px; padding-bottom: 2px;} #passengers_popup fieldset li label.passenger_age_label .passenger_age {  } #passengers_popup .popup-wrap .popup_body .paxCountLabel {text-align: center; margin: 8px 0; font-weight: bold;} #passengers_popup .addPaxSplashIcon {text-align: center; margin-top: 20px; background: #f5f5f5; width: 120px; margin: 20px auto 0; border-radius: 50%; height: 120px; position: relative;} #passengers_popup .addPaxSplashIcon i {font-size: 4em; top: 50%; left: 50%; transform: translate(-50%, -50%); position: absolute;} }";document.getElementsByTagName('head')[0].appendChild(style);});}
return contents;},addPassenger:(t)=>{let list=t.previousElementSibling;let count=list.childElementCount;let descTxt=regionalText.passengers_base_text;let{subLeg,storeLeg,legTxt}=DF_DF1.utils.findLeg(t);let prepop=subLeg.paxList.length;let wheelchairAvail=storeLeg.hasWheelchair==='true';DF_DF1.buildAPassenger(subLeg,legTxt,count+1,descTxt,prepop,wheelchairAvail,list,storeLeg);DF_DF1.handlePassengerChange(t,list);},removePassenger:(t)=>{let passItem=t.parentElement;let list=passItem.parentElement;let addButton=list.nextElementSibling;DF_DF1.utils.checkRemoveElm(passItem);DF_DF1.handlePassengerChange(addButton,list);},handlePassengerChange:(t,list)=>{if(list.childElementCount===DF_DF1.maxPassengers){t.classList.add('disabled');}
else{t.classList.remove('disabled');}
if(false){if(list.childElementCount>2&&!document.querySelector('.addPaxSplashIcon').classList.contains("hide")){document.querySelector('.addPaxSplashIcon').classList.add('hide');}else if(list.childElementCount<=2&&document.querySelector('.addPaxSplashIcon').classList.contains("hide")){document.querySelector('.addPaxSplashIcon').classList.remove('hide');}
let passengerLabel;if(list.childElementCount>1){passengerLabel=regionalText.passenger_plural.replace('[--X--]',list.childElementCount);}
else{passengerLabel=regionalText.passenger_single}
document.querySelector('.paxCountLabel').textContent=passengerLabel;}},buildPetsContent:(legTxt,storeLeg,subLeg)=>{let contents=document.createDocumentFragment();let prepop=subLeg.petCountTotal>0;let buildPetCounter=(pet)=>{let ident='petType'+pet.petId+'_'+legTxt;let label=DF_DF1.utils.buildElm({tag:'label',txt:pet.petText,cls:['pet_counter'],atts:{'for':ident}});let val=0;let decInactive=true;let incInactive=false;if(prepop){subLeg.petList.forEach((item)=>{if(item.petId===pet.petId){val=item.petCount;decInactive=val===0;incInactive=val===pet.petMax;}})}
let dec=DF_DF1.utils.buildElm({tag:'span',txt:'−',cls:['decrement']});decInactive?dec.classList.add('inactive'):null;label.appendChild(dec);label.appendChild(DF_DF1.utils.buildElm({tag:'output',txt:val,atts:{id:ident,name:ident,'data-limit':pet.petMax,'data-petId':pet.petId}}));let inc=DF_DF1.utils.buildElm({tag:'span',txt:'+',cls:['increment']});incInactive?inc.classList.add('inactive'):null;label.appendChild(inc);contents.appendChild(label);};storeLeg.petTypes.forEach((petType)=>buildPetCounter(petType))
contents.appendChild(DF_DF1.utils.buildElm({tag:'button',txt:regionalText.modal_pet_conditions_hdg,cls:['modal_opener'],atts:{type:'button','data-modal':'pet_conditions'}}));return contents;},buildVehicleContent:(legTxt,storeLeg,subLeg)=>{let contents=document.createDocumentFragment();let label,radio,checked;let ident='vehicle_type';let prepop=parseInt(subLeg.vehicle.vehicleTypeId);if(DF_DF1.standardCarOption&&parseInt(subLeg.vehicle.vehicleMakeId)==2056)prepop=2056;let buildVehicleRadio=(lblTxt,value,checked)=>{label=DF_DF1.utils.buildElm({tag:'label',txt:lblTxt,cls:[ident],atts:{'for':ident+'_'+value}});radio=DF_DF1.utils.buildElm({tag:'input',cls:[ident+'_'+legTxt],atts:{type:'radio',id:ident+'_'+value,name:ident,value:value}});checked?label.classList.add('checked'):null;checked?radio.setAttribute('checked',''):null;label.appendChild(radio);return label;};if(storeLeg.hasFootpassenger==='true')
{checked=(prepop===0||prepop===-1);contents.appendChild(buildVehicleRadio(regionalText.vehicle_no_vehicle,0,checked));}
if(storeLeg.hasVehicle==='true'){contents.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_with_vehicles}));storeLeg.vehicleTypes.forEach((item)=>{if(item.ddVal!=='-1'){checked=prepop===parseInt(item.ddVal);contents.appendChild(buildVehicleRadio(item.ddText,item.ddVal,checked));if(DF_DF1.standardCarOption&&item.ddVal==='2'){checked=prepop===2056;contents.appendChild(buildVehicleRadio(regionalText.vehicles_popup_standard_car,'2056',checked));}}})
DF_DF1.requestVehicleExtras(legTxt);}
return contents;},requestVehicleExtras:(legTxt)=>{let journeytype,typeId,storeLeg,subLeg;journeytype=legTxt==='outbound'?1:2;typeId=1;if(journeytype===1){storeLeg=DF_DF1.legOut;subLeg=DF_DF1.submission.routeOut;}
else{storeLeg=DF_DF1.legRet;subLeg=DF_DF1.submission.routeReturn;}
var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();$.ajax({dataType:"jsonp",url:DF_DF1.submitUrl+"/ferry/ws/dealpicker.asmx/VehicleTypeDimensionsGet?"
+"&JourneyType="+encodeURIComponent(journeytype)
+"&routeId="+encodeURIComponent(subLeg.sailing.routeId)
+"&routeIdReturn="+encodeURIComponent(subLeg.sailing.routeIdRet)
+"&typeId="+encodeURIComponent(typeId)
+"&cult="+encodeURIComponent(base_user_data.SiteLanguage)
+qStr,success:function(data){DF_DF1.storeVehicleExtras(data.d,storeLeg);},error:function(data){}})},storeVehicleExtras:(res,storeLeg)=>{storeLeg.vehicleSizes=res;},buildVehicleDetails:(t)=>{let{storeLeg,subLeg,legTxt}=DF_DF1.utils.findLeg(t);if(t.value!=='1')
{let popup=DF_DF1.utils.buildElm({tag:'aside',cls:['popup','vehicle_detail'],atts:{'data-vehicleid':t.value,style:"overflow-y: auto; height: 10px"}});if(DF_DF1.popupSlider)popup.classList.add('popup_slider');let popupDiv=DF_DF1.utils.buildElm({tag:'div',cls:['popup-wrap']});popup.appendChild(popupDiv);let contents=document.createDocumentFragment();let removePopupDone=false;switch(t.value){case'2':t.parentNode.style='display: none;';contents.appendChild(t.parentNode);contents.appendChild(DF_DF1.buildCarMakeSelect(t,storeLeg,legTxt,subLeg));removePopupDone=true;break;case'3':case'10':contents.appendChild(DF_DF1.buildCustomvehicleDetails(null,storeLeg,legTxt,subLeg));contents.appendChild(DF_DF1.buildCaravanTrailerToggle(t,true));break;case'5':case'7':contents.appendChild(DF_DF1.buildMotorbikeDetails(null,storeLeg,legTxt,subLeg));break;case'11':case'12':contents.appendChild(DF_DF1.buildCustomvehicleDetails(null,storeLeg,legTxt,subLeg));contents.appendChild(DF_DF1.buildCommercialCheckbox(legTxt));contents.appendChild(DF_DF1.buildCaravanTrailerToggle(t,true));break;}
DF_DF1.buildPopupParts(popupDiv,'vehicle_detail',regionalText.vehicles_popup_hdg,contents,true,t.parentNode.textContent,removePopupDone);let detailsPopup;if(DF_DF1.smallViewport){detailsPopup=document.body.appendChild(popup);}
else{detailsPopup=document.body.querySelector('.deal_finder_wrap').appendChild(popup);}
DF_DF1.utils.checkRemoveElm(document.querySelector('#vehicle_base'));if(!DF_DF1.smallViewport){DF_DF1.addPopupDone();}
detailsPopup.addEventListener('change',DF_DF1.popupEventPipe);detailsPopup.addEventListener('click',DF_DF1.popupEventPipe);if(DF_DF1.smallViewport){DF_DF1.jumpToTop();document.body.style.overflow='hidden';}}},prepopulateVehicleDetails:(t,subLeg)=>{if(t.value==='2')
{if(subLeg.vehicle.addLengthHeightRadioValue==="true"){DF_DF1.addLuggageDimensions(t);}}
subLeg.vehicle.caravanTrailerRadioValue==="true"?DF_DF1.buildCaravanTrailerDetails(DF_DF1.form.querySelector('#caravan_trailer_yes')):null;},buildItemSet:(cont,storeArr,legTxt,fieldname,selected,linked='')=>{let list=DF_DF1.utils.buildElm({tag:'ol',cls:['item_list',fieldname]})
let ident,li,label,input,matched;storeArr.forEach((item)=>{if(item.ddVal!=='-1'){ident=fieldname+'_'+legTxt+'_'+item.ddVal;li=DF_DF1.utils.buildElm({tag:'li',atts:{'data-linked':linked}});label=DF_DF1.utils.buildElm({tag:'label',txt:item.ddText,atts:{for:ident}});let input=DF_DF1.utils.buildElm({tag:'input',cls:[fieldname],atts:{id:ident,name:fieldname,type:'radio',value:item.ddVal}});item.ddVal===selected?label.classList.add('checked'):null;item.ddVal===selected?input.setAttribute('checked',''):null;label.appendChild(input);li.appendChild(label);list.appendChild(li);}})
cont.appendChild(list);},shrinkList:(listitem)=>{listitem.classList.add('chosen');let sibs=DF_DF1.utils.getSiblings(listitem);sibs.forEach((item)=>{item.classList.add('hide');item.classList.remove('chosen');});let hdg=listitem.parentNode.previousElementSibling;hdg?hdg.classList.add('hide'):null;},expandList:(listitem)=>{listitem.classList.remove('chosen');let sibs=DF_DF1.utils.getSiblings(listitem);sibs.forEach((item)=>{item.classList.remove('hide');if(item.firstElementChild.attributes["for"].value!=listitem.firstElementChild.attributes["for"].value)
item.firstElementChild.classList.remove('checked');});let hdg=listitem.parentNode.previousElementSibling;hdg?hdg.classList.remove('hide'):null;},buildCarMakeSelect:(t,storeLeg,legTxt,subLeg)=>{let fldset=DF_DF1.utils.buildElm({tag:'fieldset',cls:['car_make_fields']});fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_vehicle_select_make,cls:['item_hdg']}));DF_DF1.buildItemSet(fldset,storeLeg.vehicleMakes,legTxt,'vehicle_make',subLeg.vehicle.vehicleMakeId);return fldset;},requestCarModels:(t)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.vehicle_model_list'));var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();if(t.value==='967')
{DF_DF1.buildCustomvehicleDetails(t);DF_DF1.addPopupDone();}
else{$.ajax({dataType:"jsonp",url:DF_DF1.submitUrl+"/ferry/ws/dealpicker.asmx/VehicleModelsForMakeGet?"
+"make="+encodeURIComponent(t.parentNode.textContent)
+"&cult="+encodeURIComponent(base_user_data.SiteLanguage)
+qStr,success:function(data){DF_DF1.buildCarModelsSelect(data.d,t);},error:function(data){}})}},buildCarModelsSelect:(res,t)=>{let{subLeg,legTxt}=DF_DF1.utils.findLeg(t);DF_DF1.utils.checkRemoveElm(document.querySelector('.car_model_fields'));let fldset=DF_DF1.utils.buildElm({tag:'fieldset',cls:['car_model_fields']});fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_vehicle_select_model,cls:['item_hdg']}));DF_DF1.buildItemSet(fldset,res,legTxt,'vehicle_model',subLeg.vehicle.vehicleModelId);let makesFields=document.body.querySelector('.popup.vehicle_detail .car_make_fields');makesFields.insertAdjacentElement('afterend',fldset);},buildMotorbikeDetails:(t,storeLeg,legTxt,subLeg)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.custom_vehicle_details'));if(typeof storeLeg==='undefined')
{var{storeLeg,subLeg,legTxt}=DF_DF1.utils.findLeg(t);}
let storeLegSizes=storeLeg.vehicleSizes;let subLegVehicle=subLeg.vehicle;let ident='custom_vehicle';let fldset=DF_DF1.utils.buildElm({tag:'fieldset',cls:['custom_vehicle_details']});fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',cls:['item_hdg_top'],txt:regionalText.vehicles_popup_vehicle_custom}));let subIdent,label,value,input;subIdent='vehicle_make';label=DF_DF1.utils.buildElm({tag:'label',cls:['long'],atts:{'for':subIdent}});value=subLegVehicle.vehicleMakeEntered||'';input=DF_DF1.utils.buildElm({'tag':'input',cls:[ident+'_'+legTxt],atts:{type:'text',id:subIdent+'_'+legTxt,name:subIdent,placeholder:regionalText.vehicles_popup_vehicle_custom_make,value:value}});label.appendChild(input);fldset.appendChild(label);subIdent='vehicle_model';label=DF_DF1.utils.buildElm({tag:'label',cls:['long'],atts:{'for':subIdent}});value=subLegVehicle.vehicleModelEntered||'';input=DF_DF1.utils.buildElm({'tag':'input',cls:[ident+'_'+legTxt],atts:{type:'text',id:subIdent+'_'+legTxt,name:subIdent,placeholder:regionalText.vehicles_popup_vehicle_custom_model,value:value}})
label.appendChild(input);fldset.appendChild(label);if(t===null)
{return fldset;}
else
{let makeList=document.querySelector('.vehicle_detail .vehicle_make');makeList.insertAdjacentElement('afterend',fldset);}},buildCustomvehicleDetails:(t,storeLeg,legTxt,subLeg)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.custom_vehicle_details'));if(typeof storeLeg==='undefined')
{var{storeLeg,subLeg,legTxt}=DF_DF1.utils.findLeg(t);}
let storeLegSizes=storeLeg.vehicleSizes;let subLegVehicle=subLeg.vehicle;let ident='custom_vehicle';let fldset=DF_DF1.utils.buildElm({tag:'fieldset',cls:['custom_vehicle_details']});fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',cls:['item_hdg_top'],txt:regionalText.vehicles_popup_vehicle_custom}));let subIdent,label,value,input;if(document.querySelector('.vehicle_make .chosen .vehicle_make')==null||document.querySelector('.vehicle_make .chosen .vehicle_make').value==="967"){subIdent='vehicle_make';label=DF_DF1.utils.buildElm({tag:'label',cls:['long'],atts:{'for':subIdent}});value=subLegVehicle.vehicleMakeEntered||'';input=DF_DF1.utils.buildElm({'tag':'input',cls:[ident+'_'+legTxt],atts:{type:'text',id:subIdent+'_'+legTxt,name:subIdent,placeholder:regionalText.vehicles_popup_vehicle_custom_make,value:value}});label.appendChild(input);fldset.appendChild(label);}
subIdent='vehicle_model';label=DF_DF1.utils.buildElm({tag:'label',cls:['long'],atts:{'for':subIdent}});value=subLegVehicle.vehicleModelEntered||'';input=DF_DF1.utils.buildElm({'tag':'input',cls:[ident+'_'+legTxt],atts:{type:'text',id:subIdent+'_'+legTxt,name:subIdent,placeholder:regionalText.vehicles_popup_vehicle_custom_model,value:value}})
label.appendChild(input);fldset.appendChild(label);fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_customLength,cls:['item_hdg_extra_mgn']}));DF_DF1.buildItemSet(fldset,storeLegSizes.vehicleLengths,legTxt,'custom_vehicle_length',subLegVehicle.vehicleLengthId,'linked');fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_customHeight,cls:['item_hdg_extra_mgn']}));DF_DF1.buildItemSet(fldset,storeLegSizes.vehicleHeights,legTxt,'custom_vehicle_height',subLegVehicle.vehicleHeightId);let length_labels=fldset.querySelectorAll('.custom_vehicle_length label');length_labels.forEach((label)=>label.dataset['origLabel']=regionalText.vehicles_popup_customLength)
let height_labels=fldset.querySelectorAll('.custom_vehicle_height label');height_labels.forEach((label)=>label.dataset['origLabel']=regionalText.vehicles_popup_customHeight)
fldset.querySelector('.custom_vehicle_height').classList.add('collapsed');if(t===null)
{return fldset;}
else
{let makeList=document.querySelector('.popup_body');makeList.appendChild(fldset);}},buildLuggageToggle:(t)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.extra_luggage'));let{subLeg,legTxt}=DF_DF1.utils.findLeg(t);let cont=DF_DF1.utils.buildElm({tag:'div',cls:['extra_luggage']});cont.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_extra_luggage}));let checkNo=!subLeg.vehicle.addLengthHeightRadioValue||subLeg.vehicle.addLengthHeightRadioValue==="false";DF_DF1.buildRadioTogglePair(cont,'vehicle_extra_luggage',regionalText.vehicles_popup_extra_luggage_no,regionalText.vehicles_popup_extra_luggage_yes,legTxt,checkNo);let footer=document.body.querySelector('.popup.vehicle_detail footer');footer.insertAdjacentElement('beforebegin',cont);if(!checkNo){DF_DF1.addLuggageDimensions(document.querySelector('#vehicle_extra_luggage_yes'));}},addLuggageDimensions:(t)=>{let leg=DF_DF1.utils.findLeg(t);let storeLegSizes=leg.storeLeg.vehicleSizes;let subLegVehicle=leg.subLeg.vehicle;let legTxt=leg.legTxt;let ident='additional_dimensions';let section=DF_DF1.utils.buildElm({tag:'section',cls:[ident]});section.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_addLength,cls:['item_hdg']}));DF_DF1.buildItemSet(section,storeLegSizes.addLengths,legTxt,ident+'_length',subLegVehicle.vehicleAdditionalLengthId,'linked');section.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_addHeight,cls:['item_hdg']}));DF_DF1.buildItemSet(section,storeLegSizes.addHeights,legTxt,ident+'_height',subLegVehicle.vehicleAdditionalHeightId);let length_labels=section.querySelectorAll('.additional_dimensions_length label');length_labels.forEach((label)=>label.dataset['origLabel']=regionalText.vehicles_popup_addLength)
let height_labels=section.querySelectorAll('.additional_dimensions_height label');height_labels.forEach((label)=>label.dataset['origLabel']=regionalText.vehicles_popup_addHeight)
section.querySelector('.additional_dimensions_height').classList.add('collapsed');let toggleFields=t.parentNode.parentNode;toggleFields.insertAdjacentElement('beforeend',section);},buildCaravanTrailerToggle:(t,auto)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.caravan_trailer'));let{subLeg,legTxt}=DF_DF1.utils.findLeg(t);let fldset=DF_DF1.utils.buildElm({tag:'fieldset',cls:['caravan_trailer']});fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_caravan_trailer}));let checkNo=!subLeg.vehicle.caravanTrailerRadioValue||subLeg.vehicle.caravanTrailerRadioValue==="false";DF_DF1.buildRadioTogglePair(fldset,'caravan_trailer',regionalText.vehicles_popup_caravan_trailer_no,regionalText.vehicles_popup_caravan_trailer_yes,legTxt,checkNo);if(auto)
{return fldset;}
else{let footer=document.body.querySelector('.popup.vehicle_detail footer');footer.insertAdjacentElement('beforebegin',fldset);}
if(!checkNo){DF_DF1.addCaravanTrailerDetails(document.querySelector('#caravan_trailer_yes'));}},addCaravanTrailerDetails:(t)=>{let leg=DF_DF1.utils.findLeg(t);let storeLegSizes=leg.storeLeg.vehicleSizes;let subLegVehicle=leg.subLeg.vehicle;let legTxt=leg.legTxt;let ident='caravan_trailer_details';let fldset=DF_DF1.utils.buildElm({tag:'fieldset',cls:[ident]});DF_DF1.buildItemSet(fldset,storeLegSizes.caravanTypes,legTxt,ident+'_select',subLegVehicle.caravanTrailerTypeId);fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_addLength,cls:['item_hdg']}));DF_DF1.buildItemSet(fldset,storeLegSizes.caravanLengths,legTxt,ident+'_length',subLegVehicle.caravanTrailerLengthId,'linked');fldset.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:regionalText.vehicles_popup_addHeight,cls:['item_hdg']}));DF_DF1.buildItemSet(fldset,storeLegSizes.caravanHeights,legTxt,ident+'_height',subLegVehicle.caravanTrailerHeightId);let length_labels=fldset.querySelectorAll('.caravan_trailer_details_length label');length_labels.forEach((label)=>label.dataset['origLabel']=regionalText.vehicles_popup_addLength)
let height_labels=fldset.querySelectorAll('.caravan_trailer_details_height label');height_labels.forEach((label)=>label.dataset['origLabel']=regionalText.vehicles_popup_addHeight)
fldset.querySelector('.caravan_trailer_details_height').classList.add('collapsed');let toggleFields=t.parentNode.parentNode;toggleFields.insertAdjacentElement('beforeend',fldset);},buildCommercialCheckbox:(legTxt)=>{let ident='commercial_goods_'+legTxt;let label=DF_DF1.utils.buildElm({tag:'label',txt:regionalText.vehicles_popup_commercial_goods,cls:['commercial_goods'],atts:{'for':ident}});label.appendChild(DF_DF1.utils.buildElm({tag:'input',cls:['toggle'],atts:{id:ident,type:'checkbox',name:'commercial_goods',value:true}}));return label;},buildCurrencyContent:()=>{let ident='journey_currency';let cont=DF_DF1.utils.buildElm({tag:'section'});let prepop=DF_DF1.submission.currency===null?'':DF_DF1.submission.currency.toString();DF_DF1.buildItemSet(cont,DF_DF1.currencies,'set',ident,prepop);return cont;},setCurrency:(t)=>{DF_DF1.setSubmissionData(null,['currency'],{currency:parseInt(t.value)});},setSubmissionData:(legTxt,datanames,data)=>{let subLeg;if(legTxt===null)
{subLeg=DF_DF1.submission;}
else
{subLeg=legTxt==='outbound'?DF_DF1.submission.routeOut:DF_DF1.submission.routeReturn;}
datanames.forEach((item)=>subLeg[item]=data[item])},setSubmissionOpenTicket:(t)=>{let subLeg=DF_DF1.utils.findLeg(t).subLeg;subLeg.sailing.isOpenChecked=t.checked;},setSubmissionPetCount:(output)=>{let subLeg,assoc_field;if(output.id.indexOf('outbound')!==-1){subLeg=DF_DF1.submission.routeOut;assoc_field=DF_DF1.pets_outbound;}
else{subLeg=DF_DF1.submission.routeReturn;assoc_field=DF_DF1.pets_return;}
let pet_outputs=document.body.querySelectorAll('#pets_popup output');let res=[];let totalCount=0;pet_outputs.forEach((output)=>{let count=parseInt(output.textContent);res.push({petId:parseInt(output.getAttribute('data-petId')),petCount:count});totalCount+=count;});subLeg.petCountTotal=totalCount;subLeg.petList=res;let regionTxt=totalCount!=1?regionalText.pets_plural:regionalText.pets_single;if(totalCount===0){assoc_field.querySelector('.journey_details_span').textContent=regionTxt.replace('[--X--]',totalCount);}
else{assoc_field.querySelector('.journey_details_span').textContent=regionTxt.replace('[--X--]',totalCount);assoc_field.querySelector('#plus_icon').textContent="edit";}
if(DF_DF1.focusDealFinder){if(output.id.indexOf('outbound')!==-1)
document.querySelector('section.trip_outbound').querySelector('#sep_pax_pets_count').textContent=totalCount;else
document.querySelector('section.trip_return').querySelector('#sep_pax_pets_count').textContent=totalCount;}},setSubmissionPassengers:()=>{let popup=document.querySelector('#passengers_popup');let{storeLeg,subLeg,legTxt}=DF_DF1.utils.findLeg(popup.querySelector('.passengers_list'));subLeg.paxList=[];if(DF_DF1.separatePassengers){var totalAdults=0;if(DF_DF1.groupAdultsByAge){var groups=document.querySelectorAll('#total-adults');groups.forEach(function(g){var count=Number(g.parentElement.querySelector('#total-adults').textContent);totalAdults=totalAdults+count;var rangeStr=g.parentElement.getAttribute('data-age');let adultObj=storeLeg.passengerAges.find((adult)=>{if(adult.rangeStr==rangeStr){return adult;}});for(var i=0;i<count;i++){let copyItem=JSON.parse(JSON.stringify(adultObj));subLeg.paxList.push(copyItem);}});document.querySelector("section.trip_"+legTxt).querySelector("#sep_pax_adults_count").textContent=totalAdults;}else{totalAdults=Number(document.querySelector('#total-adults').textContent);if(totalAdults>0){let adultObj=storeLeg.passengerAges.find((adult)=>{if(adult.minAge<=37&&adult.maxAge>=37){return adult;}});for(var i=0;i<totalAdults;i++){let copyItem=JSON.parse(JSON.stringify(adultObj));subLeg.paxList.push(copyItem);}
document.querySelector("section.trip_"+legTxt).querySelector("#sep_pax_adults_count").textContent=totalAdults;}}
var totalChildren=Number(document.querySelector('#total-children').textContent);if(totalChildren>0){if(popup.querySelectorAll('.child-age').length==totalChildren){popup.querySelectorAll('.child-age').forEach((item)=>{let selectedAge=item.querySelector("#"+item.id).value;let ageObj=storeLeg.passengerAges.find((age)=>{if(age.minAge<=selectedAge&&age.maxAge>=selectedAge){return age;}});let copyItem=JSON.parse(JSON.stringify(ageObj));subLeg.paxList.push(copyItem);});}}
document.querySelector("section.trip_"+legTxt).querySelector("#sep_pax_children_count").textContent=totalChildren;subLeg.passengersTotal=totalAdults+totalChildren;}else{let setPassenger=(item)=>{let age=item.querySelector('.passenger_age').value;if(item.querySelector('.passenger_wheelchair input')!==null){isWc=item.querySelector('.passenger_wheelchair input').checked;}
else{isWc=false;}
let ageObj=storeLeg.passengerAges.find((ageitem)=>{if(ageitem.minAge<=age&&ageitem.maxAge>=age){return ageitem;}})
let copyItem=JSON.parse(JSON.stringify(ageObj));copyItem.age=age;copyItem.isWc=isWc;subLeg.paxList.push(copyItem);};popup.querySelectorAll('.passengers_list li').forEach((item)=>setPassenger(item));subLeg.passengersTotal=subLeg.paxList.length;let assoc_field=DF_DF1['passengers_'+legTxt];let regionTxt=subLeg.passengersTotal>1?regionalText.passenger_plural:regionalText.passenger_single;assoc_field.querySelector('.journey_details_span').textContent=regionTxt.replace('[--X--]',subLeg.passengersTotal);assoc_field.querySelector('#plus_icon').textContent="edit";}},setSubmissionWheelchair:(t)=>{let detail=DF_DF1.utils.findLeg(t).subLeg.paxList;let inc=parseInt(t.getAttribute('data-inc'))-1;if(typeof detail[inc]==='undefined'){detail[inc]={wheelchair:t.checked,isWc:t.checked};}
else{detail[inc].wheelchair=t.checked,isWc=t.checked;}},setSubmissionDiscount:(t)=>{let legTxt=DF_DF1.utils.findLeg(t).legTxt;if(t.classList.contains('booking_discount')){DF_DF1.setSubmissionData(legTxt,['bookingDiscountOption'],{bookingDiscountOption:t.value});}
else{DF_DF1.setSubmissionData(legTxt,['residentInfo'],{residentInfo:t.value});var chkRes=document.querySelector('#residentCheck');if(chkRes!=undefined){if(t.value=='0')chkRes.checked=false;else chkRes.checked=t.value==document.querySelector('#hdnResDiscount').value;}}},setSubmissionCurrency:()=>{let choice=document.body.querySelector('#currency_popup [name="journey_currency"]:checked');let assoc_field=document.body.querySelector('[data-popup="currency_popup"]');DF_DF1.submission.currency=choice.value;assoc_field.textContent=regionalText.currency_popup_hdg+': '+choice.parentNode.textContent;},updateSubmitVehicleField:(t)=>{let popup=document.querySelector('aside.popup');let fields=popup.querySelectorAll('input:checked, [type="text"]');let{subLeg,legTxt}=DF_DF1.utils.findLeg(fields[0]);let assoc_field=legTxt==='outbound'?DF_DF1.vehicle_outbound:DF_DF1.vehicle_return;let parseEntries=(field)=>{switch(field.name){case'vehicle_type':return field.parentNode.textContent;case'vehicle_make':return field.type==='radio'?': '+field.parentNode.textContent:' : '+field.value;case'vehicle_model':return field.type==='radio'?', '+field.parentNode.textContent:', '+field.value;case'caravan_trailer_details_select':return field.value==='1'?' + '+regionalText.vehicles_popup_trailer_text:' + '+regionalText.vehicles_popup_caravan_text;default:return'';}};let lbl=popup.querySelector('.close_sub')||fields[0].parentNode;let baseTxt='';if(popup.classList.contains('vehicle_detail')){fields.forEach((field)=>baseTxt+=parseEntries(field));assoc_field.querySelector('.journey_details_span').textContent=baseTxt;assoc_field.querySelector('#plus_icon').textContent="edit";}else if(popup.id==='vehicle_base'&&fields.length>0&&(fields[0].value==="0"||fields[0].value==="1"||fields[0].value==="2056")){assoc_field.querySelector('.journey_details_span').textContent=lbl.firstChild.textContent;assoc_field.querySelector('#plus_icon').textContent="edit";}
DF_DF1.setSubmissionVehicles(popup,subLeg,fields);},validateVehicle:(t)=>{let errors=[];let popup=document.querySelector('aside.popup');let fields=popup.querySelectorAll('input:checked, [type="text"]');let tempVehicle={addLengthHeightRadioValue:false,caravanTrailerHeightId:-1,caravanTrailerLengthId:-1,caravanTrailerRadioValue:false,caravanTrailerTypeId:null,commercialGoodsChecked:false,vehicleAdditionalHeightId:0,vehicleAdditionalLengthId:0,vehicleHeightId:null,vehicleLengthId:null,vehicleMakeEntered:null,vehicleMakeId:-1,vehicleModelEntered:null,vehicleModelId:-1,vehicleRadioValue:false,vehicleTypeId:-1,}
let getProperty=(field)=>{switch(field.name){case'vehicle_type':return'vehicleTypeId';case'vehicle_make':return field.type==='radio'?'vehicleMakeId':'vehicleMakeEntered';case'vehicle_model':return field.type==='radio'?'vehicleModelId':'vehicleModelEntered';case'custom_vehicle_length':return'vehicleLengthId';case'custom_vehicle_height':return'vehicleHeightId';case'vehicle_extra_luggage':return'addLengthHeightRadioValue';case'additional_dimensions_length':return'vehicleAdditionalLengthId';case'additional_dimensions_height':return'vehicleAdditionalHeightId';case'caravan_trailer':return'caravanTrailerRadioValue';case'caravan_trailer_details_select':return'caravanTrailerTypeId';case'caravan_trailer_details_length':return'caravanTrailerLengthId';case'caravan_trailer_details_height':return'caravanTrailerHeightId';case'commercial_goods':return'commercialGoodsChecked';}};fields.forEach((field)=>tempVehicle[getProperty(field)]=field.value);popup.classList.contains('vehicle_detail')?tempVehicle.vehicleTypeId=parseInt(popup.dataset.vehicleid):null;let checkVehicle=(tempVehicle)=>{let extraStr='';let checkCustomDetails=()=>{if(!tempVehicle.vehicleMakeEntered&&(tempVehicle.vehicleMakeId==="967"||tempVehicle.vehicleTypeId!=2)){errors.push(regionalText['validity_no_vehicle_make_mob'+extraStr]);}
if(!tempVehicle.vehicleModelEntered){errors.push(regionalText['validity_no_vehicle_model_mob'+extraStr]);}
if(!tempVehicle.vehicleLengthId){errors.push(regionalText['validity_no_vehicle_length'+extraStr]);}
if(!tempVehicle.vehicleHeightId){errors.push(regionalText['validity_no_vehicle_height'+extraStr]);}};let checkMotorbike=()=>{if(!tempVehicle.vehicleMakeEntered){errors.push(regionalText['validity_no_vehicle_make_mob'+extraStr]);}
if(!tempVehicle.vehicleModelEntered){errors.push(regionalText['validity_no_vehicle_model_mob'+extraStr]);}};let checkCaravanTrailer=()=>{if(tempVehicle.caravanTrailerRadioValue==="true"){if(!tempVehicle.caravanTrailerTypeId){errors.push(regionalText['validity_no_caravan_type'+extraStr]);}
if(tempVehicle.caravanTrailerLengthId==-1){errors.push(regionalText['validity_no_caravan_length'+extraStr]);}
if(tempVehicle.caravanTrailerHeightId==-1){errors.push(regionalText['validity_no_caravan_height'+extraStr]);}}};if(tempVehicle.vehicleTypeId===-1){errors.push(regionalText['validity_no_vehicle_type'+extraStr]);}
else if(tempVehicle.vehicleTypeId>1)
{switch(tempVehicle.vehicleTypeId){case 2:if(tempVehicle.vehicleMakeId===-1){errors.push(regionalText['validity_no_vehicle_make_mob'+extraStr]);}
else if(tempVehicle.vehicleMakeId==="967"||tempVehicle.vehicleModelId===-1||tempVehicle.vehicleModelId==="967"){checkCustomDetails();}
if(tempVehicle.addLengthHeightRadioValue==="true"){if(tempVehicle.vehicleAdditionalLengthId===0)errors.push(regionalText['validity_no_luggage_length'+extraStr]);if(tempVehicle.vehicleAdditionalHeightId===0)errors.push(regionalText['validity_no_luggage_height'+extraStr]);}
checkCaravanTrailer();break;case 3:case 10:case 11:case 12:checkCustomDetails();checkCaravanTrailer();break;case 5:case 7:checkMotorbike();break;}}};checkVehicle(tempVehicle);return DF_DF1.buildPopupErrors(errors);},buildPopupErrors:(errors)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.error_messages'));if(errors.length===0){DF_DF1.form.classList.remove('invalid');return true;}
else{let errorMessages=DF_DF1.utils.buildElm({'tag':'section',cls:['error_messages']});let errorList=DF_DF1.utils.buildElm({'tag':'ul'});errors.forEach((error)=>{errorList.appendChild(DF_DF1.utils.buildElm({'tag':'li',txt:error}));})
errorMessages.appendChild(errorList);let journeyType=DF_DF1.form.querySelector('.journey_type');document.querySelector('.popup_body').prepend(errorMessages);if(DF_DF1.smallViewport){DF_DF1.jumpToTop();}else{var e1=DF_DF1.form.querySelector('.error_messages');e1.scrollIntoView({behavior:'smooth',block:'nearest'});}
return false;}
return false;},setSubmissionVehicles:(popup,subLeg,fields)=>{let getProperty=(field)=>{switch(field.name){case'vehicle_type':return'vehicleTypeId';case'vehicle_make':return field.type==='radio'?'vehicleMakeId':'vehicleMakeEntered';case'vehicle_model':return field.type==='radio'?'vehicleModelId':'vehicleModelEntered';case'custom_vehicle_length':return'vehicleLengthId';case'custom_vehicle_height':return'vehicleHeightId';case'vehicle_extra_luggage':return'addLengthHeightRadioValue';case'additional_dimensions_length':return'vehicleAdditionalLengthId';case'additional_dimensions_height':return'vehicleAdditionalHeightId';case'caravan_trailer':return'caravanTrailerRadioValue';case'caravan_trailer_details_select':return'caravanTrailerTypeId';case'caravan_trailer_details_length':return'caravanTrailerLengthId';case'caravan_trailer_details_height':return'caravanTrailerHeightId';case'commercial_goods':return'commercialGoodsChecked';}};var vTypeId=subLeg.vehicle.vehicleTypeId.toString();fields.forEach((field)=>{var property=getProperty(field);if(property=="vehicleTypeId"&&field.value!=vTypeId){subLeg.vehicle.addLengthHeightRadioValue=false;subLeg.vehicle.caravanTrailerHeightId=-1;subLeg.vehicle.caravanTrailerLengthId=-1;subLeg.vehicle.caravanTrailerRadioValue=false;subLeg.vehicle.caravanTrailerTypeId=null;subLeg.vehicle.commercialGoodsChecked=false;subLeg.vehicle.vehicleAdditionalHeightId=-1;subLeg.vehicle.vehicleAdditionalLengthId=-1;subLeg.vehicle.vehicleHeightId=-1;subLeg.vehicle.vehicleLengthId=-1;subLeg.vehicle.vehicleMakeEntered=null;subLeg.vehicle.vehicleMakeId=-1;subLeg.vehicle.vehicleModelEntered=null;subLeg.vehicle.vehicleModelId=-1;subLeg.vehicle.vehicleRadioValue=false;subLeg.vehicle.vehicleTypeId=-1;}
if(property=="addLengthHeightRadioValue"&&field.value=="false"){subLeg.vehicle.vehicleAdditionalHeightId=-1;subLeg.vehicle.vehicleAdditionalLengthId=-1;}
if(property=="caravanTrailerRadioValue"&&field.value=="false"){subLeg.vehicle.caravanTrailerHeightId=-1;subLeg.vehicle.caravanTrailerLengthId=-1;subLeg.vehicle.caravanTrailerTypeId=null;subLeg.vehicle.commercialGoodsChecked=false;}
subLeg.vehicle[property]=field.value;});popup.classList.contains('vehicle_detail')?subLeg.vehicle.vehicleTypeId=popup.dataset.vehicleid:null;let vehicleTypeId=subLeg.vehicle.vehicleTypeId;if(DF_DF1.standardCarOption&&parseInt(vehicleTypeId)==2056){subLeg.vehicle.vehicleTypeId=2;subLeg.vehicle.vehicleRadioValue=true;subLeg.vehicle.vehicleModelId=vehicleTypeId;subLeg.vehicle.vehicleMakeId=vehicleTypeId;}else if(parseInt(vehicleTypeId)>0)
{subLeg.vehicle.vehicleRadioValue=true;if(subLeg.vehicle.vehicleMakeId=="967")subLeg.vehicle.vehicleModelId=subLeg.vehicle.vehicleMakeId;}
else{subLeg.vehicle.vehicleRadioValue=vehicleTypeId==='1';}},setDefaultTwoPassengers:()=>{let addDefaultPassengers=function(storeLeg,subLeg,legTxt,passengersTotal){if(subLeg!=undefined&&subLeg.paxList.length<=0){var defaultPassAge;storeLeg.passengerAges.forEach(function(pax){if(pax.minAge<30&&pax.maxAge>30&&defaultPassAge==undefined){defaultPassAge=pax;}});subLeg.passengersTotal=passengersTotal;subLeg.paxList.push(defaultPassAge);subLeg.paxList.push(defaultPassAge);let passField=DF_DF1['passengers_'+legTxt];let regionTxt=regionalText.passenger_plural;passField.querySelector('.journey_details_span').textContent=regionTxt.replace('[--X--]',subLeg.passengersTotal);passField.querySelector('#plus_icon').textContent="edit";}}
addDefaultPassengers(DF_DF1.legOut,DF_DF1.submission.routeOut,"outbound",2);if(!DF_DF1.submission.oneway)addDefaultPassengers(DF_DF1.legRet,DF_DF1.submission.routeReturn,"return",2);},setDefaultStandardCar:()=>{var subLegO=DF_DF1.submission.routeOut;if(subLegO!=undefined&&subLegO.vehicle.vehicleTypeId==-1){subLegO.vehicle.isTravelMethodSelected=true;subLegO.vehicle.vehicleRadioValue=true;subLegO.vehicle.vehicleTypeId=2;subLegO.vehicle.vehicleMakeId="2056";subLegO.vehicle.vehicleModelId="2056";let vehicleField=DF_DF1['vehicle_outbound'];vehicleField.querySelector('.journey_details_span').textContent=regionalText.vehicles_popup_standard_car;vehicleField.querySelector('#plus_icon').textContent="edit";}
if(DF_DF1.legRet!=undefined&&DF_DF1.legRet.hasVehicle){var subLegR=DF_DF1.submission.routeReturn;if(subLegR!=undefined&&subLegR.vehicle.vehicleTypeId==-1){subLegR.vehicle.isTravelMethodSelected=true;subLegR.vehicle.vehicleRadioValue=true;subLegR.vehicle.vehicleTypeId=2;subLegR.vehicle.vehicleMakeId="2056";subLegR.vehicle.vehicleModelId="2056";let vehicleField=DF_DF1['vehicle_return'];vehicleField.querySelector('.journey_details_span').textContent=regionalText.vehicles_popup_standard_car;vehicleField.querySelector('#plus_icon').textContent="edit";}}},reportAnalytics:function(evType,label,data){if(typeof ga!=='undefined'){var sendData=false;switch(evType){case'noRoutes':!DF_DF1.noRouteResultsReported?sendData=true:null;DF_DF1.noRouteResultsReported=true;break;default:sendData=true;}
if(sendData){try{ga('send','event','New Dealfinder-B',label,data,{nonInteraction:true});}catch(error){}}}},buildDatepickerControls:function(){if(document.querySelector(".datePickerControls")==null){var style=document.createElement('style');style.type='text/css';style.innerHTML=".datePickerControls { display: flex;justify-content: space-between;padding: 8px; color: #fff; }";document.getElementsByTagName('head')[0].appendChild(style);let divControls=DF_DF1.utils.buildElm({tag:'div',cls:['datePickerControls']});let spanBack=DF_DF1.utils.buildElm({tag:'span'});let iBack=DF_DF1.utils.buildElm({tag:'i',txt:"chevron_left",cls:['material-icons','dp-controls','dp-controls-back']});spanBack.appendChild(iBack);let spanClose=DF_DF1.utils.buildElm({tag:'span'});let iClose=DF_DF1.utils.buildElm({tag:'i',txt:"close",cls:['material-icons','dp-controls','dp-controls-close']});spanClose.appendChild(iClose);divControls.appendChild(spanBack);divControls.appendChild(spanClose);var dfWrap=document.querySelector('.deal_finder_wrap');dfWrap.parentNode.prepend(divControls);}else{document.querySelector(".datePickerControls").style='display: flex;';}},buildChildrenAgeSelect:function(amount,selectedValue,container){var divInputs=(container!=null&&container.querySelector(".child-age-inputs")!=null)?container.querySelector(".child-age-inputs"):document.querySelector(".child-age-inputs");if(divInputs==null){divInputs=DF_DF1.utils.buildElm({tag:'div',cls:['child-age-inputs'],atts:{id:'child-age-inputs'}});var contents=container!=null?container:document.querySelector('.notes');let note=DF_DF1.utils.buildElm({tag:'p',txt:regionalText.passengers_children_note,cls:['pax-note']});contents.appendChild(note);contents.appendChild(divInputs);}
var currentAges=divInputs.childElementCount;if(amount==1){var ci=currentAges+amount;let divInput=DF_DF1.utils.buildElm({tag:'div',cls:['child-age'],atts:{id:'child-'+ci}});let labelAge=DF_DF1.utils.buildElm({tag:'label',cls:['passenger_age_label'],txt:regionalText.passengers_age,atts:{'for':'child-'+ci}});let selectAge=DF_DF1.utils.buildElm({tag:'select',cls:['passenger_age'],txt:regionalText.passengers_age,atts:{id:'child-'+ci,'name':'child-'+ci}});for(var i=0;i<18;i++){var option=DF_DF1.utils.buildElm({tag:'option',txt:i,atts:{'value':i}});if(i==selectedValue)option.selected=true;selectAge.appendChild(option);}
labelAge.appendChild(selectAge);divInput.appendChild(labelAge);divInput.appendChild(DF_DF1.utils.buildElm({tag:'i',cls:['material-icons'],txt:'expand_more'}));divInputs.appendChild(divInput);}else{if(currentAges==1){divInputs.remove();document.querySelector('.pax-note').remove();}
else divInputs.lastElementChild.remove();}},closeDatePickerPopup:function(t){var cal=t.querySelector('div.mbsc-fr.mbsc-material.mbsc-fr-inline.newDatepicker');var type=t.querySelector('.journeyType').getAttribute('data-journeytype');var calId='cal_'+type;var p=document.getElementById(calId).parentElement;p.removeAttribute('data-popup');p.appendChild(cal);},addClearButton:function(){if(document.querySelector('.md-35')==null&&document.querySelector('.md-37')==null){var addClearBtn=function(legTxt){var style=document.createElement('style');style.type='text/css';style.innerHTML='#deal_finder1 .journey_route .journey_base { padding-right: 50px; position: relative; } .overlay { text-align: left; font-family: Material Icons; font-weight: normal; font-style: normal; position: absolute; color: #193354; right: 20px; vertical-align: middle; line-height: 1; text-transform: none; letter-spacing: none; top: 15px; font-size: 24px; display: block; } .md-35 {display: inline-block;padding: 16px;position: absolute;right: 0;top: 50%;transform: translateY(-50%);} .md-37{display: inline-block;padding: 16px;position: absolute;right: 0;top: 50%;transform: translateY(-50%);}';document.head.appendChild(style);var rOut=document.querySelector('#route_'+legTxt);var jRout=rOut.parentElement;var wr=DF_DF1.utils.buildElm({tag:'div',cls:['wr_'+legTxt]});wr.style.position='relative';wr.appendChild(rOut);jRout.appendChild(wr);var cancel=DF_DF1.utils.buildElm({tag:'i',cls:['overlay','material-icons','md-35'],txt:'clear'});cancel.style.display='none';var edit=DF_DF1.utils.buildElm({tag:'i',cls:['overlay','material-icons','md-37'],txt:'edit'});wr.appendChild(cancel);wr.appendChild(edit);}
addClearBtn('outbound');addClearBtn('return');}},toogleClearButton:function(showX){DF_DF1.addClearButton();if(showX){document.querySelectorAll('.md-37').forEach(function(e){e.style.display='none';});document.querySelectorAll('.md-35').forEach(function(e){e.style.display='inline-block';});}else{document.querySelectorAll('.md-35').forEach(function(e){e.style.display='none';});document.querySelectorAll('.md-37').forEach(function(e){e.style.display='inline-block';});}},buildPopularRoutesForDesktop:function(data){if(data&&Array.isArray(data)){let frag=document.createDocumentFragment();if(data.length!=1){if(data.length>5)data=data.slice(0,6);let hdgset=[];let listset=[];let list;let startList=true;let popularRoutesHeaderToReplace="";let routeMapper=(route)=>{if(route.isHeader){typeof list!=='undefined'?listset.push(list):null;let routeHeader=route.header;if(regionalText.popular_routes_for!=undefined)
{if(document.querySelector("#df-dom-destination-content-wrap")!=null&&DF_page_params.country.length>0)
{popularRoutesHeaderToReplace=DF_page_params.country}
if(document.querySelector("#df-dom-operator-content-wrap")!=null&&DF_page_params.opname.length>0)
{popularRoutesHeaderToReplace=DF_page_params.opname}
if(popularRoutesHeaderToReplace.length>0)
{routeHeader=regionalText.popular_routes_for.replace('[--X--]',popularRoutesHeaderToReplace);}}
hdgset.push(DF_DF1.utils.buildElm({tag:'h5',txt:routeHeader}));startList=true;}
else{startList?list=DF_DF1.utils.buildElm({tag:'ul',cls:['routes','routes_outbound']}):null;document.querySelector("#deal_finder1").classList.remove('showing_return_list');let fromItem=DF_DF1.utils.buildElm({tag:'div',cls:['fromItem']});fromItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.portFrom,cls:['port']}));fromItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.locationsFrom,cls:['location']}));let toItem=DF_DF1.utils.buildElm({tag:'div',cls:['toItem']});toItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.portTo,cls:['port']}));toItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.locationsTo,cls:['location']}));let item=DF_DF1.utils.buildElm({tag:'li',atts:{'data-routeId':route.routeId,'data-routeIdRet':route.routeIdRet,'data-routeName':route.routeName,'data-routeNameRet':route.routeNameRet,'data-s':'mob_desk'}});item.appendChild(fromItem);item.appendChild(DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','md-36'],txt:'compare_arrows'}));item.appendChild(toItem);list.appendChild(item);startList=false;}};data.forEach((route)=>routeMapper(route));typeof list!=='undefined'?listset.push(list):null;hdgset.forEach((hdg,index)=>{frag.appendChild(hdg);frag.appendChild(listset[index]);});var listP=DF_DF1.buildRouteList(frag);listP.classList.add('pop_route_list');listP.addEventListener('click',DF_DF1.handleJourneySelect);document.getElementById('deal_finder1').appendChild(listP);}}},triggerPopRoutes:function(){var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();DF_DF1.request=$.ajax({dataType:"jsonp",url:DF_DF1.submitUrl+"/ferry/ws/dealpicker.asmx/SearchDataGetAB?"
+"SearchTerm="
+"&AB_SAYT_ports=false"
+"&OtherPortSearchStr="
+"&legType="+1
+"&cult="+base_user_data.SiteLanguage
+"&AB_user_iso_pop_route=False"
+"&userIso="+base_user_data.UserISO
+"&stdc="+base_user_data.STDCCode
+"&opname="+DF_page_params.opname
+"&country="+DF_page_params.country
+"&port_from="+DF_page_params.port_from
+"&port_to="+DF_page_params.port_to
+"&baseData="+encodeURIComponent(DF_DF1.baseData)
+qStr,success:function(data){DF_DF1.buildPopularRoutesForDesktop(data);DF_DF1.showSearchButton();},error:function(data){}});},addFocusToDealfinderMini:function(isRoutePage){var pnl=document.getElementById('pnlOuter');var style=document.createElement('style');style.type='text/css';style.innerHTML=".ab2284 #header nav.subNav { display: none; }  .ab2284 #header .banner { background-image: none; padding-left: 0 !important; padding-right: 0 !important; }  .ab2284 ul.sep-pax-select { display: flex; justify-content: space-between; }  .ab2284 ul.sep-pax-select li {display: flex; flex-basis: 0; flex-grow: 1; margin: 5px;} .ab2284 ul.sep-pax-select li:first-of-type {margin-left: 0;} .ab2284 ul.sep-pax-select li:last-of-type {margin-right: 0;} .ab2284 ul.sep-pax-select li a {width: 100%;}  .ab2284 #header .banner { background: url('https://static.directferries.co.uk/image/ab/ab-2284/mob-df-bg-min.jpg') no-repeat center center; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover; background-position: 25% 0px; } .ab2284 form#deal_finder1 .journey_info .diff_details { padding: 0 5px; }  .ab2284 #deal_finder1 .deal_finder_wrap { grid-template-rows: inherit; }  .ab2284 #deal_finder1 .journey_type label { padding: 6px; }  .ab2284 form#deal_finder1 .journey_type label { font-size: 15px; }  .ab2284 #deal_finder1 .journey_timing .journey_date { border-bottom-left-radius: 0; border-bottom-right-radius: 0; }  .ab2284 #deal_finder1 .journey_timing .journey_time { height: inherit; border-top-left-radius: 0; border-top-right-radius: 0; }  .ab2284 #deal_finder1 [data-popup] { min-height: 48px; }  .ab2284 #deal_finder1 [data-popup].passengers i { padding-bottom: 4px; }  .ab2284 #deal_finder1 .route_list .routes li, .ab2284 #deal_finder1 [data-popup], .ab2284 #deal_finder1 [data-popup].passengers, .ab2284 #deal_finder1 [data-popup].pets, .ab2284 #deal_finder1 [data-popup].vehicle { font-size: 16px; }  .ab2284 .mob-df-header, .ab2284 .mob-df-title { display: none; }  .ab2284.mini form#deal_finder1 { margin: 0% 8px 50% 8px !important; }  .ab2284.mini .mob-df-header { display: block; width: 100%; border-bottom: 1px solid #fff; }  .ab2284.mini .mob-df-header h1 { font-size: 14px; font-weight: normal; color: #fff; padding: 8px 6px; margin-bottom: 0; }  .ab2284.mini .mob-df-title { display: block; margin-top: 20%; width: 100%; padding: 0 10px 10px; }  .ab2284.mini .mob-df-title span { color: #fff; font-size: 24px; line-height: 2rem; font-weight: lighter; }  .ab2284 #header .fsWrap { background: none; }";if(DF_DF1.isMobileApp)style.innerHTML+="form.mob-dealfinder[data-state='entering_date_outbound'] .journey_timing, form.mob-dealfinder[data-state='entering_time_outbound'] .journey_timing, form.mob-dealfinder[data-state='entering_date_return'] .journey_timing, form.mob-dealfinder[data-state='entering_time_return'] .journey_timing { background-color: #fff !important; padding: 8px !important; border-radius: 8px !important; }  form.mob-dealfinder[data-state='entering_date_outbound'] .deal_finder_wrap, form.mob-dealfinder[data-state='entering_time_outbound'] .deal_finder_wrap, form.mob-dealfinder[data-state='entering_date_return'] .deal_finder_wrap, form.mob-dealfinder[data-state='entering_time_return'] .deal_finder_wrap { flex: 100% !important; position: relative; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 40px auto 1fr !important; grid-column-gap: 8px !important; grid-row-gap: 8px !important; }  .mob-dealfinder form.mob-dealfinder[data-state='entering_date_outbound'] .journey_timing, form.mob-dealfinder[data-state='entering_time_outbound'] .journey_timing, form.mob-dealfinder[data-state='entering_date_return'] .journey_timing, form.mob-dealfinder[data-state='entering_time_return'] .journey_timing { display: flex !important; align-items: center; grid-template-rows: 0px 40px auto 40px; }  ul.sep-pax-select { display: grid !important; grid-template-columns: 1fr 1fr !important; justify-self: stretch !important; grid-column-gap: 8px !important; }  ul.sep-pax-select li { width: 100% !important; }  .trip_outbound { display: grid; grid-template-rows: auto; grid-row-gap: 8px !important; grid-template-columns: auto; }  .trip_outbound ul { display: grid; grid-column: 1 / span 2; }  #deal_finder1 .journey_info .trip_return.diff_trip { margin-top: 8px; display: grid; grid-gap: 8px; }  .trip_return.diff_trip ul { display: grid; grid-column: 1 / span 2; }  .ab2284 ul.sep-pax-select { display: grid !important; grid-template-columns: 1fr 1fr 1fr !important; justify-self: stretch !important; grid-column-gap: 8px !important; grid-column: 1 / span 2; }  .ab2284 ul.sep-pax-select li { width: 100% !important; margin: 0px !important; }  .mob-dealfinder .journey_info { margin-top: 0; }  .mob-dealfinder .journey_info span.h4 { font-family: 'proxima-soft-medium' !important; font-weight: 500 !important; color: #fff !important; font-size: 16px !important; line-height: 20px !important; margin-top: 4px !important; margin-bottom: 8px !important; }  .ab2284 .journey_info.hide_until_summary > span.h4 { display: block !important; }  /* .ab2284 .journey_info span.h4 { display: block !important; } */ .mob-dealfinder .sep-pax-select [data-popup].passengers { padding: 0 8px !important; min-height: 48px !important; padding-top: 46px !important; padding-bottom: 8px !important; cursor: pointer; color: #193354 !important; border-radius: 8px !important; margin-bottom: 8px !important; font-family: 'proxima-soft-medium' !important; font-weight: 500 !important; font-size: 16px !important; line-height: 20px !important; background: transparent !important; }  .ab2284 #deal_finder1 [data-popup].passengers i { padding-bottom: 4px; display: none; }  .mob-dealfinder ul.sep-pax-select li:nth-child(1) { background-repeat: no-repeat !important; background-size: 32px !important; background-position: center 12px !important; background-image: url(https://static.directferries.co.uk/image/ico/light-blue/passengers.svg) !important; margin-bottom: 8px; background-color: #fff; border-radius: 8px; height: fit-content; }  .mob-dealfinder ul.sep-pax-select li:nth-child(2) { background-repeat: no-repeat !important; background-size: 32px !important; background-position: center 12px !important; background-image: url(https://static.directferries.co.uk/image/ico/light-blue/child.svg) !important; margin-bottom: 8px; background-color: #fff; border-radius: 8px; }  .ab2284 .mob-dealfinder ul.sep-pax-select li:nth-child(3) { background-repeat: no-repeat !important; background-size: 32px !important; background-position: center 12px !important; background-image: url(https://static.directferries.co.uk/image/ico/light-blue/pets.svg) !important; margin-bottom: 8px; background-color: #fff; border-radius: 8px; }  .ab2284 ul.sep-pax-select li a span:nth-child(2) { padding: 0; font-family: 'proxima-soft-medium' !important; font-weight: 500 !important; font-size: 16px !important; margin-top: 4px; }  ul.sep-pax-select li a span:nth-child(2) { padding: 0; font-family: 'proxima-soft-bold' !important; -webkit-font-smoothing: antialiased !important; font-smoothing: antialiased; font-weight: 700 !important; font-size: 22px !important; margin-top: 4px; }  i.material-icons.df-dark-blue { color: #193354; display: block; position: absolute; right: 8px !important; }  ul.sep-pax-select li a span { padding: 0; font-family: 'proxima-soft-medium' !important; font-weight: 500 !important; font-size: 16px !important; margin-top: 4px; }  ul.sep-pax-select li a span#sep_pax_adults_count, ul.sep-pax-select li a span#sep_pax_children_count, ul.sep-pax-select li a span#sep_pax_pets_count { padding: 0; font-family: 'proxima-soft-bold' !important; -webkit-font-smoothing: antialiased !important; font-smoothing: antialiased; font-weight: 700 !important; font-size: 22px !important; margin-top: 4px; }  form.mob-dealfinder .journey_info .diff_details { background: transparent !important; padding-left: 16px; grid-row: 4; flex-direction: row-reverse; justify-content: flex-end; display: flex; align-items: center; background-color: #fff; padding: 8px !important; border-radius: 0; margin-bottom: 0px; justify-content: space-between; }  .mob-dealfinder .journey_info .diff_details .checkbox-label { color: #fff !important; font-size: 16px; cursor: pointer; display: inline-block; font-weight: 500; padding-top: 2px; padding-left: 10px; text-align: left; }  .mob-dealfinder .currency { background-color: #475c77 !important; color: #fff !important; padding: 8px !important; margin: 0 !important; display: block !important; min-height: 32px !important; }  .mob-dealfinder .df_submit { flex: 1 1 100%; height: 48px; background-color: #ff4a0e; color: #fff; font-family: 'proxima-soft-bold' !important; -webkit-font-smoothing: antialiased !important; font-smoothing: antialiased; font-weight: 700 !important; border-radius: 8px !important; padding: 8px !important; border: none; cursor: pointer; margin-bottom: 0px !important; grid-column: span 2; align-self: end; margin-top: 8px; }  .mob-dealfinder #ageRangePrompt { background: #e0f1fa; color: #193354 !important; margin-bottom: 10px; padding: 12px 32px 12px 8px; position: relative; margin-top: 0px; border-radius: 4px; display: flex; align-items: center; font-family: 'proxima-soft-medium' !important; font-weight: 500 !important; font-size: 16px; line-height: 16px; grid-column: span 2; justify-self: start; box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23); }  .mob-dealfinder #ageRangePrompt i.close-icon { position: absolute; top: 12px; right: 8px; padding: 0; font-size: 20px; cursor: pointer; }  .mob-dealfinder #ageRangePrompt i.age-icon { padding-right: 16px; }  .mob-dealfinder .popup footer { background: none !important; padding: 0px 0 !important; color: #193354 !important; font-size: 14px !important; font-family: 'proxima-soft-light' !important; font-weight: 300 !important; }";if(isRoutePage)style.innerHTML+=".ab2284.mini .mob-df-title span {display: block;} .ab2284.mini .mob-df-title span.strap {font-size: 18px;}";pnl.appendChild(style);var logoImg=document.querySelector('.sm12.logoBar a img');if(logoImg!=null){logoImg.src="https://static.directferries.co.uk/image/dflogo-mobile.svg";var logoStyle=document.createElement('style');logoStyle.type='text/css';logoStyle.innerHTML="#header .logoBar > a {line-height: 0;} #header .logoBar img.logo {width: 210px; height: auto;} #header .logoBar {margin: 0; min-height: 56px; display: flex; justify-content: space-between; align-items: center;} #header .logoBar ul.conNav {margin: 0 !important;} @media (min-width: 640px) { #header .logoBar img.logo {width: 268px; height: auto; margin-left: .5rem;} } @media (min-width: 1024px) { #header .logoBar {min-height: 72px;} } @media (min-width: 1439px) { #header .logoBar {min-height: 88px;} } @media (max-width: 768px) { #header .banner {background: none;} #header .banner .con.noBanner {padding-top: 0;} }";pnl.appendChild(logoStyle);}
pnl.classList.add("ab2284");pnl.classList.add("mini");if(document.querySelectorAll('.journey_details.pets').length>0)
document.querySelectorAll('.journey_details.pets').forEach(function(oldP){oldP.style.display='none';});var hDiv=DF_DF1.utils.buildElm({tag:'div',cls:['mob-df-header']});var tDiv=DF_DF1.utils.buildElm({tag:'div',cls:['mob-df-title']});if(isRoutePage){var existingTitle=document.querySelector(".h2")?document.querySelector(".h2").textContent.trim():"";var tSpan1=DF_DF1.utils.buildElm({tag:'span',txt:existingTitle,cls:['routeName']});var tSpan2=DF_DF1.utils.buildElm({tag:'span',txt:regionalText.homepage_tagline,cls:['strap']});tDiv.appendChild(tSpan1);tDiv.appendChild(tSpan2);}else{var existingH1=document.querySelector('h1')!=null?document.querySelector('h1').textContent:"Ferry tickets";var hH1=DF_DF1.utils.buildElm({tag:'h1',txt:existingH1});hDiv.appendChild(hH1);var tSpan=DF_DF1.utils.buildElm({tag:'span',txt:regionalText.homepage_tagline});tDiv.appendChild(tSpan);}
var dfe=document.getElementById('deal_finder1');dfe.parentNode.insertBefore(hDiv,dfe);dfe.parentNode.insertBefore(tDiv,dfe);},addContentSquareTracking:function(event){try{window._uxa=window._uxa||[];window._uxa.push(['trackPageview',window.location.pathname+window.location.hash.replace('#','?__')+'?cs-dealfinder-step='+event]);}catch(e){}}};DF_DF1.initJourneySearch=(e,t)=>{DF_DF1.current_field=t;DF_DF1.parentLabel=DF_DF1.current_field.parentNode;DF_DF1.loggedNoResults=false;if(DF_DF1.focusDealFinder)document.getElementById('pnlOuter').classList.remove("mini");if(DF_DF1.current_field.id==='route_outbound'){DF_DF1.leg_type=1;DF_DF1.mirror_field=DF_DF1.route_return;}
else{DF_DF1.leg_type=2;DF_DF1.mirror_field=DF_DF1.route_outbound;}
DF_DF1.mirror_value=DF_DF1.mirror_field?DF_DF1.mirror_field.value:'';DF_DF1.jumpFormState(e,'showing_routes_list',t);DF_DF1.current_field.addEventListener('input',DF_DF1.handleAutocomplete);DF_DF1.current_field.addEventListener('keydown',DF_DF1.handleKeyNav);if(DF_DF1.smallViewport){document.getElementById('deal_finder1').scrollIntoView();}
DF_DF1.current_field.select();e.preventDefault();};DF_DF1.handleAutocomplete=function(e)
{DF_DF1.restoredFromPrevious=false;let value=this.value;if(value.length>1){DF_DF1.jumpFormState(e,'entering_search_term',this);if(typeof DF_DF1.request!=='undefined'&&DF_DF1.request.readyState!==4){DF_DF1.request.abort();DF_DF1.request='';}
DF_DF1.requestAutocomplete(this,value);};};DF_DF1.requestAutocomplete=(t,value)=>{var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();var legType=typeof(DF_DF1.leg_type)!='undefined'?DF_DF1.leg_type:DF_DF1.form.querySelector('#journey_round_trip').checked?2:1;DF_DF1.request=$.ajax({dataType:"jsonp",url:DF_DF1.submitUrl+"/ferry/ws/dealpicker.asmx/SearchDataGetAB?"
+"SearchTerm="+encodeURIComponent(value)
+"&AB_SAYT_ports=false"
+"&OtherPortSearchStr="+encodeURIComponent(DF_DF1.mirror_value)
+"&legType="+legType
+"&cult="+base_user_data.SiteLanguage
+"&AB_user_iso_pop_route=False"
+"&userIso="+base_user_data.UserISO
+"&stdc="+base_user_data.STDCCode
+"&opname="+DF_page_params.opname
+"&country="+DF_page_params.country
+"&port_from="+DF_page_params.port_from
+"&port_to="+DF_page_params.port_to
+"&baseData="+encodeURIComponent(DF_DF1.baseData)
+qStr,success:function(data){DF_DF1.handleJourneyData(data,t);},error:function(data){}});};DF_DF1.handleJourneyData=(data,t)=>{let legTxt=DF_DF1.utils.findLeg(t).legTxt;let value=t.value;let parent_label=document.getElementById('journey_route_parent');let parent_label_old=DF_DF1.parentLabel||t.parentNode;if(data&&Array.isArray(data)){let frag=document.createDocumentFragment();if(data.length===1)
{frag.appendChild(DF_DF1.utils.buildElm({tag:'h5',txt:data[0].header}));parent_label.appendChild(DF_DF1.buildRouteList(frag));}
else{let hdgset=[];let listset=[];let list;let startList=true;let routeMapper=(route)=>{if(route.isHeader){typeof list!=='undefined'?listset.push(list):null;hdgset.push(DF_DF1.utils.buildElm({tag:'h5',txt:route.header}));startList=true;}
else{startList?list=DF_DF1.utils.buildElm({tag:'ul',cls:['routes','routes_'+legTxt]}):null;if(legTxt=='return')document.querySelector("#deal_finder1").classList.add('showing_return_list');else document.querySelector("#deal_finder1").classList.remove('showing_return_list');let fromItem=DF_DF1.utils.buildElm({tag:'div',cls:['fromItem']});fromItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.portFrom,cls:['port']}));fromItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.locationsFrom,cls:['location']}));let toItem=DF_DF1.utils.buildElm({tag:'div',cls:['toItem']});toItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.portTo,cls:['port']}));toItem.appendChild(DF_DF1.utils.buildElm({tag:'span',txt:route.locationsTo,cls:['location']}));let item=DF_DF1.utils.buildElm({tag:'li',atts:{'data-routeId':route.routeId,'data-routeIdRet':route.routeIdRet,'data-routeName':route.routeName,'data-routeNameRet':route.routeNameRet}});item.appendChild(fromItem);item.appendChild(DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','md-36'],txt:'compare_arrows'}));item.appendChild(toItem);list.appendChild(item);startList=false;}};data.forEach((route)=>routeMapper(route));typeof list!=='undefined'?listset.push(list):null;hdgset.forEach((hdg,index)=>{frag.appendChild(hdg);frag.appendChild(listset[index]);});DF_DF1.route_listing=parent_label.appendChild(DF_DF1.buildRouteList(frag));DF_DF1.journey_itemset=DF_DF1.route_listing.querySelectorAll('.routes > li');DF_DF1.route_listing.addEventListener('click',DF_DF1.handleJourneySelect);value.length>0?DF_DF1.markValue(value):null;value.length===4&&data.length<=1?DF_DF1.reportAnalytics(value):null;}}};DF_DF1.buildRouteList=(frag)=>{DF_DF1.utils.checkRemoveElm(document.querySelector('.route_list'));let listing=DF_DF1.utils.buildElm({tag:'aside',cls:['route_list']});let divWrap=DF_DF1.utils.buildElm({tag:'div',cls:['animate','fadeInUp']});listing.appendChild(frag);divWrap.appendChild(listing);return divWrap;};DF_DF1.markValue=(value)=>{let valueSet=value.replace(/[^A-Za-z ]/g,'').split(' ').filter(Boolean);valueSet.sort((a,b)=>{return b.length-a.length;});if(DF_DF1.hasMarkBug(valueSet)){let markList=valueSet.filter(word=>'mark'.indexOf(word)>-1).sort((a,b)=>{return a.length-b.length;});valueSet=valueSet.filter(word=>'mark'.indexOf(word)===-1).sort((a,b)=>{return b.length-a.length;});valueSet=markList.concat(valueSet);}
let textitems=DF_DF1.route_listing.querySelectorAll('span');textitems.forEach((item)=>item.innerHTML=item.innerHTML.replace(/<[\/]*mark>/,''))
valueSet.forEach((valChunk)=>{let srctext=new RegExp(valChunk,'ig');textitems.forEach((item)=>{if(srctext.test(item.textContent)){srctext.lastIndex=0;let newInner='<mark>'+srctext.exec(item.textContent)[0]+'</mark>';if('mark'.indexOf(valChunk)>-1){item.innerHTML=item.textContent.replace(srctext,newInner);}else{item.innerHTML=item.innerHTML.replace(srctext,newInner);}}})})};DF_DF1.hasMarkBug=(valueSet)=>{let tempint=0;valueSet.forEach(valChunk=>{if(tempint<2&&'mark'.indexOf(valChunk)>-1)tempint++;});return tempint>1;};DF_DF1.handleKeyNav=(e)=>{if(typeof DF_DF1.route_listing==='undefined')
{return false;}
if(e.keyCode===27)
{e.preventDefault();return false;}
if(e.keyCode!==38&&e.keyCode!==40&&e.keyCode!==13)
{return false;}
let getActiveItem=()=>DF_DF1.journey_itemset[DF_DF1.journey_item_active]
let incItems=(dir)=>{let setActive=(newindex,looped)=>{DF_DF1.journey_item_active=newindex;let newitem=getActiveItem();newitem.classList.add('activeitem');newitem.scrollIntoView(false);};if(typeof DF_DF1.journey_item_active==='undefined'){setActive(0);}
else{let newindex;let looped;if(dir==='up'){newindex=DF_DF1.journey_item_active-1;if(newindex<0){newindex=DF_DF1.journey_itemset.length-1;looped='toEnd';}}
else if(dir==='down'){newindex=DF_DF1.journey_item_active+1;if(newindex>DF_DF1.journey_itemset.length-1){newindex=0;looped='toStart';}}
getActiveItem().classList.remove('activeitem');setActive(newindex,looped);}};if(e.keyCode===13)
{typeof DF_DF1.journey_item_active!=='undefined'?DF_DF1.handleJourneySelect(e,getActiveItem()):null;e.preventDefault();}
else{let dir;if(e.keyCode===38){dir='up';}
else if(e.keyCode===40){dir='down';}
incItems(dir);}},DF_DF1.handleJourneySelect=(e,t=e.target)=>{DF_DF1.routeIsSet=true;if(t.matches('.routes *')){t.nodeName!=='LI'?t=t.closest('li'):null;DF_DF1.showSelection(e,t);DF_DF1.restoredFromPrevious=false;DF_DF1.fetchJourneyDetail(e,t);DF_DF1.removePopups();e.preventDefault();}};DF_DF1.fetchJourneyDetail=(e,t)=>{let routeId,routeIdReturn,url,response,res;let journeyType=DF_DF1.form.querySelector('#journey_round_trip').checked?2:1;if(t)
{if(t.parentNode.classList.contains('routes_outbound')){routeId=t.getAttribute('data-routeId');routeIdReturn=DF_DF1.submission.diffjourneys?DF_DF1.submission.routeReturn.sailing.routeIdRet:t.getAttribute('data-routeIdRet');}
else{routeId=DF_DF1.submission.diffjourneys?DF_DF1.submission.routeOut.sailing.routeId:t.getAttribute('data-routeId');routeIdReturn=t.getAttribute('data-routeId');}}
else
{routeId=DF_DF1.submission.routeOut.sailing.routeId;if(DF_DF1.legOut!=undefined)
routeIdReturn=DF_DF1.legOut.routeIdRet;else routeIdReturn=0;}
if(journeyType===1){routeIdReturn=0;}
if(routeId>0){var dfusrpid=document.querySelector('[name="dfusrpidck"]')!=null?document.querySelector('[name="dfusrpidck"]').value:null;var qStr="";if(dfusrpid!=null&&dfusrpid!=""){qStr="&dfusrpid="+dfusrpid;}else{var dfusrpidcookie=readCookie('dfusrpid');if(dfusrpidcookie!=null&&dfusrpidcookie!=""){dfusrpid=dfusrpidcookie.split(',')[0];qStr="&dfusrpid="+dfusrpid;}}
qStr=qStr+getCommonQuery();$.ajax({dataType:"jsonp",url:DF_DF1.submitUrl+"/ferry/ws/dealpicker.asmx/RouteDataGet?"
+"JourneyType="+encodeURIComponent(journeyType)
+"&routeId="+encodeURIComponent(routeId)
+"&routeIdReturn="+encodeURIComponent(routeIdReturn)
+"&cult="+encodeURIComponent(base_user_data.SiteLanguage)
+"&stdc="+encodeURIComponent(base_user_data.STDCCode)
+"&miniCruise=false"
+"&baseData="+encodeURIComponent(DF_DF1.baseData)
+qStr,success:function(data){DF_DF1.handleJourneyDetail(t,data.d,routeId,routeIdReturn);DF_DF1.runDefaultAll(e);if(DF_DF1.separatePassengers)DF_DF1.buildSeparatePassengersDivs();if(DF_DF1.legOut['residentDiscounts'].length>0)DF_DF1.buildResidentDiscount();else if(document.querySelector('#resDiscount')!=null)document.querySelector('#resDiscount').parentElement.removeChild(document.querySelector('#resDiscount'));},error:function(data){}});}};DF_DF1.runDefaultAll=(e,bypass)=>{if(!DF_DF1.changeStepOrder){var routeIdOut="-1";try{routeIdOut=DF_DF1.submission.routeOut.sailing.routeId;}catch(e){}
if(DF_DF1.legOut.hasVehicle=="false"){DF_DF1.setDefaultTwoPassengers();DF_DF1.jumpFormState(e,'entering_journey_info');}
var prefFootPaxRoutes=[119,117,4479,5264,1953,1103,1128,1143,1159,1206,1879,1834,1519,1525,1511,2020,1933,2586,2588,2584,2582,1984,2303,2580,2106,3747,1985,1986,1873,1877,1880,1836,4576,5850,5852,4050,2768,4217,329,854,3165,3167,2362,2339,3169,3171,3173,1874,1832,1885,1887,3272,2381,4186,4579,4187,4188,5872,2383,2388,3259,3098,3096,3094,1606,2131,1105,2135,1084,1086,1088,1610,1097,1227,2751,2755,4101,3769,1126,3219,3771,1178,5118,4290,1098,4150,1247,3360,4595,724,2608,2600,5504,1954,1952,2394,2396,2398,1956,2400,1958,1274,2402,2404,2995,4039,3669,2879,2855,5471,2120,3547,5401,5412,5409,5410,5408,2220,4231,5181,3099,3980,5175,4312,3946,4729,5107,3940,3922,285,2803,2813,2691,3754,3551,3555,3559,2781,3737,3735,3979,3978,3975,4596,5285,5283,5281,3915,5286,5284,5282,5279,3350,3917,3919,657,5280,3537,2956,2832,2941,2168,1687,2166,5842,3681,3677,3679,3683,4093,2953,2951,3710,3205,3995,2532,3698,2519,3757,3990,3561,3565,726,2076,2382,1062,3261,618,3843,2393,2392,4265,1058,839,620,3849,589,624,591,2787,5871,1061,1067,3552,2085,3738,3739,3562,3571,3573,939,5148,3691,931,935,1473,4189,4183,1585,1603,2140,1498,1599,1496,1494,1553,1486,2408,1487,2739,1160,3701,1474,3607,1110,1127,1804,4401,3777,1806,1878,1831,1852,1924,3278,1870,2744,3647,3649,3656,3464,3466,3462,3208,328,4047,4043,4045,2954,3526,4762,131,4117,4040,2623,3756,2708,2802,2814,2780,2831,2786,2841,2837,2819,2794,2788,2782,2810,2798,2833,2845,2806,2827,2829,2808,2815,2784,2796,2778,2790,2804,5167,5166,5786,5718,5169,2883,2881,1602,2410,1601,1555,1604,3394,853,845,3579,3581,3246,3242,1275,1951,1107,1114,1129,1144,1161,1193,1207,49,14,16,867,3585,3587,1893,1844,1895,1897,1899,3608,1990,1987,2434,1930,1940,1988,1989,3060,3058,3065,3831,2341,2164,3166,3193,2366,2332,3195,3197,3199,5493,5490,3916,5487,5491,3352,5520,1607,1547,1961,2253,1570,1962,1572,1791,1541,1612,1741,4228,1722,1708,1565,1529,1559,1613,3267,3851,332,2091,3606,2149,3358,2207,1934,1935,2598,2594,2592,2590,2563,2011,2208,4653,2898,2677,3097,3977,5174,3928,5139,3388,3381,3945,4731,5108,2920,3375,3385,2914,3925,4642,3931,3923,5142,5141,5134,3944,5802,5110,3937,5133,5143,3942,3095,3976,5173,3389,3926,5138,3379,3943,4735,4646,5109,2922,3373,3387,2916,3066,3068,3070,3072,3074,3076,1886,1851,1850,2838,837,3670,846,28,3365,3327,3004,2533,4049,2769,2773,2703,3865,2690,2702,2692,2694,2696,4573,523,218,215,161,2132,2411,1908,1112,1614,1615,1889,1963,1891,904,4104,1180,1623,4307,4309,1228,4106,2911,5688,2710,2723,3707,2730,2728,2672,3760,2645,2655,2610,2667,2663,4722,2426,3706,5843,4048,5629,3151,3153,1894,1842,1901,1903,1905,331,326,4124,2756,2760,3546,3591,4002,3641,4003,1277,1546,1907,2257,1550,1717,1548,1909,1130,1145,1163,1860,1719,1199,1544,1208,1229,1625,1911,1115,1121,1131,1146,1164,3309,3311,4580,3262,630,3845,4208,2144,4583,3263,3308,3310,3303,3306,3301,3996,2997,2996,3017,3013,3015,2960,5356,3699,2745,3667,3702,2741,3912,5270,855,838,76,847,38,2750,2758,2748,2746,2587,2395,1499,4160,1116,1122,1520,1137,1154,1165,2575,1181,1505,4162,1237,5271,1991,1282,1992,2261,1993,2305,1166,1994,1252,1598,1284,4161,1591,4164,4166,1094,1629,4172,1230,5156,1589,1592,1621,1590,1557,5431,2397,1285,5157,1118,1134,1138,2406,1167,1183,1801,1238,1286,1964,4259,1287,1082,1083,1123,1980,1965,1085,1087,1155,1091,2197,1095,1096,4139,4137,1100,1796,2021,2244,2433,2032,3790,3768,1616,1617,2271,2273,2275,3817,3392,1571,1551,1738,1576,1543,2027,1733,1740,1736,1567,1531,1561,120,3122,3143,4378,4455,4359,4433,4232,2891,5182,2890,3120,3141,4085,4454,3128,4351,4334,4316,3121,3119,3123,4081,4064,4419,4418,3115,3157,4330,4365,4420,3148,4054,4076,4071,4372,3144,3124,3138,3132,3150,3110,4084,4080,4072,4068,4456,4082,4363,4273,4344,4379,4436,4271,5674,4326,2892,2894,3118,3137,3126,4368,4336,4060,4426,4447,4781,4429,4449,4443,4789,4438,4779,4422,4445,4424,4421,4442,4425,4437,3127,3116,4075,3131,3125,4349,4332,4314,4056,3648,3465,3659,3475,3469,3477,3423,5741,4594,4350,3158,4354,4360,4415,4348,3426,4361,3146,4542,4544,4546,4549,4550,4551,5185,3650,3655,3654,3467,3476,3471,3479,3646,3463,3468,3653,3470,3472,3316,1518,2589,2609,2399,2167,1497,2599,1288,4165,1290,1254,1124,1516,1135,1139,1150,1156,1168,2577,1184,1478,1210,1231,1239,4214,1966,4261,1293,1255,1967,1968,1136,1151,1169,2201,1195,4144,4142,1211,1969,2712,2726,2974,4341,4333,4329,4339,4345,4335,4788,4331,3425,4346,3963,3967,3969,3965,3961,3959,3666,2987,3307,5823,5825,4218,3770,1723,1636,1737,1638,1729,2281,2283,1710,1711,1727,1640,1714,4514,2700,2547,2889,2893,2673,2560,2370,4567,4623,4565,5593,4366,3149,4380,4362,3538,4328,4448,4461,4457,4776,4444,4439,522,379,2101,4493,2260,1637,2285,2302,2585,2605,1294,4167,1296,1479,1157,1170,2573,1185,1507,1212,2858,3061,3175,2343,1807,2286,3431,2561,2372,3168,3194,3067,3078,2358,594,3833,2318,812,3179,3080,5813,799,808,3407,3082,1483,2583,2603,2593,1521,4169,1517,1480,1481,1644,2571,1491,1509,2075,3986,2711,2731,2713,2736,2732,3054,2724,2729,2727,3356,3224,3759,4247,354,4190,4184,4034,5841,940,944,4257,2789,2783,3548,3566,3572,3592,3634,3636,2811,3059,3176,3181,2345,524,450,3364,5155,1683,3064,3178,3182,2799,4568,4566,4564,4557,4559,4561,4555,3079,3185,2523,3084,3086,3187,3088,2047,3536,2361,2365,3069,2357,2334,2363,2353,2359,2351,2355,2136,4498,1573,1622,1549,1628,1970,1577,1971,1730,1981,1537,2031,1646,1648,1677,1681,1569,1533,1575,4500,4191,4185,3000,2757,2749,2753,3668,2952,1995,1298,1299,1929,1790,1997,1890,1910,1996,1972,3623,1973,1974,2545,1795,1690,4503,1171,1179,4521,2295,1792,2297,4297,1213,1915,1248,1998,2304,2119,1822,3614,2306,2308,1823,1826,1825,3665,3661,3152,3697,2846,5236,5124,5873,617,619,3268,629,593,597,599,621,601,1060,603,605,607,4470,3842,3848,3830,3850,3844,3854,3856,3858,3860,3846,3832,3834,3852,3836,3838,4107,3840,2807,3574,2828,1300,1256,3220,1955,1301,1540,1975,1302,1303,1304,1257,1542,1307,1308,2282,5195,1536,1794,1152,3812,1172,1862,5249,1186,1196,4147,2205,1538,1214,1232,1917,2707,4024,5234,2970,2754,2747,2752,2401,1495,1309,1310,1311,1779,1314,1173,1187,1503,1242,2705,2900,5149,3695,5787,3380,5135,3378,5799,4738,4601,3371,3382,3909,3907,3300,5635,3951,3952,3950,3949,4262,3948,4597,5719,5798,4635,3971,4005,4730,4732,4734,5803,4737,4739,5801,5137,4741,5358,4643,4600,5113,5176,5112,5114,5111,5177,5153,5187,3154,3696,2830,2942,2809,288,246,2546,2518,2901,4013,4011,3939,2919,3938,2921,4263,4638,5800,5178,2944,2923,4460,3109,4270,3635,2329,2331,2317,2333,2313,2327,2319,2321,2337,2315,2092,325,4123,353,3525,4761,2947,3071,811,3186,2364,598,3835,5811,797,801,3411,809,1762,2347,1315,1258,3772,1957,1316,1619,1892,1317,1318,1319,1259,2026,1322,1323,2284,1125,2030,1691,1324,1158,1174,1976,4523,1188,1197,2028,2039,1656,1215,1233,1977,2581,2591,1326,4171,1328,1329,1482,1142,1330,1175,2569,1189,1515,1216,1244,4505,4723,3539,2549,4654,2896,943,3694,3690,937,3436,3326,3700,5660,4586,3324,4323,4315,3147,4321,4325,4317,4414,4413,4313,3424,3145,3322,2080,2079,1331,1833,1999,1835,4578,1260,1102,1552,1554,1333,1843,1939,1742,2000,903,1841,1335,1336,1337,1338,1556,1339,1263,1734,1340,1341,1709,1342,1645,1837,1647,1343,1814,1344,1345,4397,1346,1347,1177,1847,1198,1674,1200,1731,1658,5827,1845,1660,1217,1348,1245,1249,2001,3230,544,3755,3605,431,430,2644,2618,2642,2640,2638,2625,3361,590,2150,600,3853,3422,2380,614,3234,548,1884,1896,1902,1914,1349,1919,1926,2369,2371,1904,1848,1920,1921,2676,778,2086,3286,155,5853,2384,2385,5883,4207,2390,4538,3265,2146,2654,2619,2652,2621,2627,623,2143,622,3855,2145,4267,3202,3678,378,5254,3640,3232,546,3711,2564,3748,2562,2574,2576,2572,2570,2568,3750,3689,1350,4227,1859,2198,2202,1351,1861,1978,5179,4225,4525,1863,1250,4558,4556,3180,2522,4109,4111,4113,3685,4522,5248,4524,2417,1264,2403,1686,1485,1605,2163,1352,1353,1266,1597,1355,1267,1356,1357,1490,1682,1649,1358,1359,1761,1360,1361,1362,3749,1662,1475,1218,1234,1246,3170,3196,3081,3085,2354,2328,3190,3191,3092,2081,2701,2373,3351,3353,2897,2912,2899,2895,932,3228,552,156,5235,5154,3245,3680,2387,2391,4180,4582,5812,4181,4182,2389,5814,5816,5818,3172,3198,3073,824,3087,2360,602,3837,2320,800,5815,804,3416,798,3201,746,3439,3421,2848,3437,4116,2376,3736,3740,435,432,671,428,2613,409,380,385,386,2847,3374,5132,3372,3370,3299,3972,5136,5359,3376,5152,2611,2643,2653,2614,4118,848,1268,1367,1368,1369,1370,2499,4535,4264,2693,3918,5170,3384,5140,3386,3383,2943,3377,3921,2913,3924,3941,2915,3910,5634,3947,4006,4740,4598,5188,2917,4507,1721,1720,1739,4143,1712,1676,2296,4145,2029,1675,1678,2040,1716,4509,2902,2721,2737,3357,2972,5146,5144,3400,2772,4511,1707,1371,4138,1735,4141,1728,1680,1793,2206,2038,1372,5180,1679,1692,2036,1235,4529,4541,4543,4545,4552,4554,1611,1564,1545,2292,1568,2298,1539,1657,1732,4226,1693,1694,1535,1563,4251,2134,1624,1659,1663,1854,1888,4289,1923,1849,4296,4300,4298,3276,4293,1830,3105,3920,3260,1057,3264,1059,3857,3266,4266,5826,1900,1906,1846,1925,1922,4044,2548,217,220,4046,658,216,521,525,2156,3075,807,3188,2352,604,3839,796,3192,5817,803,3418,805,3338,3478,3480,3474,2165,5228,1504,4173,1800,1477,1506,1508,1502,1514,1661,1476,5245,1500,1378,1269,1270,2006,1528,4310,1380,4163,2003,1272,1635,1382,1383,1641,1643,1384,1532,1385,1386,1387,1388,1389,4526,1390,2041,2037,4278,1236,1251,3302,3317,162,219,2219,3753,2955,3864,2704,2698,390,4467,2695,2738,2699,389,2924,2918,5628,745,2379,2418,4570,3271,3277,4306,4285,4283,3275,4279,1399,4151,1578,1558,1400,1401,1402,1797,1560,1403,1979,1713,1574,1916,1404,1405,1176,1864,2416,1406,1715,1407,1562,5243,1408,4288,1928,2405,1488,1409,1410,1411,1757,1413,1414,1416,1417,1418,1501,1419,4250,4105,1912,3816,4513,4515,1420,1918,1982,1421,1422,4530,4294,1423,4280,1927,2797,3003,2959,2973,2999,2969,2971,4015,3663,3021,2706,4057,4061,4059,4780,4055,2340,2342,2344,2346,2779,4256,3229,3233,3231,3227,2857,4031,4030,3989,3053,3223,4213,4211,2070,3861,2338,3985,429,427,906,907,411,4197,2012,1818,2013,5239,2014,1819,4506,2015,2666,4248,2641,2620,2615,2659,543,547,545,551,2069,592,3359,4108,613,3406,3408,3410,3412,3417,3419,2500,4198,4092,3438,2375,3207,3294,2649,2658,2624,3241,3243,1865,1869,3174,3200,3077,802,3089,2356,608,3841,2316,810,3686,813,806,3420,5693,2856,2882,2742,2740,2697,2709,2885,3911,936,938,1959,3598];if(DF_DF1.legOut.hasVehicle=="true"&&prefFootPaxRoutes.indexOf(parseInt(routeIdOut))>-1){DF_DF1.setDefaultTwoPassengers();DF_DF1.setFootPassengerSelected(true);DF_DF1.jumpFormState(e,'entering_journey_info');}else if(DF_DF1.legOut.hasVehicle=="true"){DF_DF1.setDefaultTwoPassengers();DF_DF1.jumpFormState(e,'entering_journey_info');}
var viRoutes=[117,118,119,120,121,122,123,124,907,908,1696,1697,2213,2214,2217,2218,2219,2220,2437,2438,2439,2440,2441,2442,2443,2444,2445,2446,2447,2448,2518,2519,2528,2528,2529,2529,2532,2532,2533,2533,2548,2549,2558,2559,2610,2611,2612,2613,2614,2615,2618,2619,2620,2621,2622,2623,2624,2625,2626,2627,2628,2629,2630,2631,2632,2633,2634,2635,2636,2637,2638,2639,2640,2641,2642,2643,2644,2645,2646,2647,2649,2650,2652,2653,2654,2655,2656,2657,2658,2659,2660,2661,2662,2663,2664,2665,2666,2667,2668,2669,2670,2671,2672,2673,2674,2675,2676,2677,2694,2695,2696,2697,2700,2701,2706,2706,2707,2707,2708,2709,2738,2739,2740,2741,2742,2743,2744,2745,2746,2747,2748,2749,2750,2751,2752,2753,2754,2755,2756,2757,2758,2759,2760,2761,2762,2763,2764,2765,2768,2769,2770,2771,2772,2773,2774,2775,2776,2776,2777,2777,2778,2778,2779,2779,2780,2780,2781,2781,2782,2783,2784,2785,2786,2787,2788,2789,2790,2791,2792,2793,2794,2795,2796,2797,2798,2799,2800,2801,2802,2803,2804,2805,2806,2807,2808,2809,2810,2811,2813,2814,2815,2816,2817,2818,2819,2820,2821,2822,2823,2824,2825,2826,2827,2828,2829,2830,2831,2832,2833,2834,2835,2836,2837,2838,2839,2840,2841,2842,2843,2844,2845,2846,2857,2858,2859,2860,2861,2862,2863,2864,2865,2866,2867,2868,2869,2870,2871,2872,2873,2874,2877,2878,2881,2882,2883,2884,2885,2886,2887,2888,2889,2890,2891,2892,2893,2894,2895,2896,2899,2900,2901,2902,2911,2912,2917,2917,2918,2918,2923,2924,2941,2942,2945,2946,2947,2948,2949,2950,2951,2951,2952,2952,2953,2953,2953,2954,2954,2954,2955,2956,2959,2959,2960,2960,2961,2962,2963,2964,2965,2966,2967,2967,2968,2968,2969,2969,2970,2970,2971,2971,2972,2972,2973,2973,2974,2974,2975,2976,2977,2978,2979,2980,2981,2982,2983,2984,2985,2986,2987,2988,2989,2990,2991,2992,2993,2994,2995,2996,2997,2998,2999,2999,3000,3000,3001,3001,3002,3002,3003,3003,3004,3004,3005,3005,3006,3006,3007,3007,3008,3008,3009,3009,3010,3010,3011,3011,3012,3012,3013,3013,3014,3014,3015,3015,3016,3016,3017,3017,3018,3018,3019,3019,3020,3020,3021,3021,3022,3022,3023,3023,3024,3024,3025,3025,3026,3026,3027,3027,3028,3028,3029,3029,3030,3030,3031,3032,3033,3034,3035,3036,3037,3038,3056,3057,3094,3095,3096,3097,3098,3099,3109,3110,3111,3111,3111,3112,3112,3112,3113,3114,3117,3123,3124,3125,3131,3132,3133,3134,3135,3136,3137,3138,3141,3142,3144,3144,3149,3150,3151,3152,3153,3154,3163,3164,3201,3202,3203,3203,3204,3205,3205,3206,3206,3207,3207,3208,3208,3209,3209,3210,3210,3211,3211,3212,3212,3213,3214,3215,3216,3217,3218,3235,3236,3237,3238,3239,3240,3241,3242,3243,3244,3245,3246,3251,3252,3253,3254,3255,3256,3261,3262,3263,3264,3267,3268,3284,3285,3286,3286,3287,3287,3288,3289,3290,3290,3291,3291,3292,3292,3293,3293,3294,3296,3299,3300,3301,3301,3302,3302,3303,3303,3304,3304,3306,3306,3307,3307,3308,3308,3309,3309,3310,3310,3311,3311,3312,3312,3313,3313,3313,3314,3314,3315,3315,3316,3316,3317,3317,3318,3318,3319,3319,3320,3320,3321,3321,3324,3325,3336,3337,3338,3339,3340,3341,3350,3351,3352,3353,3354,3355,3358,3358,3359,3359,3360,3360,3361,3361,3362,3363,3364,3365,3366,3367,3372,3372,3373,3373,3374,3374,3375,3375,3376,3377,3378,3378,3378,3378,3378,3379,3379,3379,3379,3379,3380,3380,3380,3380,3380,3381,3381,3381,3381,3381,3382,3382,3383,3383,3384,3384,3385,3385,3386,3386,3387,3387,3387,3390,3391,3392,3393,3394,3395,3396,3396,3397,3398,3399,3400,3401,3402,3403,3404,3405,3421,3422,3436,3437,3438,3439,3513,3514,3515,3516,3516,3517,3518,3523,3524,3525,3526,3527,3528,3536,3537,3538,3539,3540,3541,3603,3604,3641,3642,3643,3644,3661,3662,3663,3664,3665,3666,3667,3668,3669,3670,3671,3672,3673,3674,3677,3678,3679,3680,3681,3682,3683,3684,3687,3688,3696,3697,3698,3699,3700,3701,3702,3703,3706,3707,3708,3709,3710,3711,3723,3724,3725,3726,3735,3736,3737,3738,3739,3740,3741,3742,3755,3755,3756,3756,3757,3758,3759,3760,3818,3819,3822,3823,3824,3825,3846,3847,3850,3851,3868,3869,3870,3871,3872,3873,3907,3907,3907,3908,3908,3908,3909,3909,3909,3909,3910,3910,3910,3911,3912,3913,3914,3915,3915,3916,3917,3918,3919,3920,3920,3921,3921,3921,3921,3921,3922,3922,3922,3922,3923,3924,3925,3926,3927,3928,3929,3930,3930,3931,3932,3933,3934,3935,3936,3941,3942,3943,3944,3945,3946,3947,3947,3948,3949,3950,3951,3952,3953,3953,3954,3954,3957,3958,3971,3971,3971,3972,3972,3972,3989,3990,3997,3998,4001,4002,4003,4004,4005,4005,4006,4006,4007,4008,4009,4010,4011,4012,4013,4014,4015,4016,4017,4018,4019,4020,4021,4022,4023,4024,4025,4026,4027,4028,4029,4030,4031,4032,4033,4034,4035,4036,4037,4038,4038,4039,4040,4041,4042,4049,4050,4051,4052,4088,4089,4092,4093,4125,4126,4127,4128,4129,4130,4131,4132,4133,4134,4135,4136,4153,4154,4156,4157,4158,4159,4195,4196,4212,4213,4215,4216,4217,4218,4229,4230,4231,4232,4233,4234,4247,4248,4262,4263,4264,4265,4266,4267,4270,4270,4270,4271,4271,4273,4273,4274,4274,4311,4311,4311,4312,4312,4312,4378,4394,4395,4409,4410,4410,4411,4412,4413,4415,4418,4422,4423,4424,4425,4433,4437,4442,4445,4449,4450,4460,4468,4469,4470,4471,4472,4473,4474,4475,4476,4477,4478,4479,4480,4481,4482,4483,4484,4485,4486,4487,4541,4541,4541,4541,4542,4542,4543,4543,4543,4543,4543,4544,4544,4544,4544,4544,4545,4545,4545,4545,4546,4546,4546,4547,4547,4547,4548,4548,4548,4549,4549,4549,4549,4550,4551,4551,4551,4551,4551,4552,4552,4552,4552,4552,4553,4554,4554,4554,4554,4554,4555,4556,4556,4557,4558,4559,4560,4561,4562,4563,4564,4565,4566,4567,4568,4584,4585,4586,4587,4588,4589,4590,4590,4591,4592,4593,4593,4594,4594,4595,4595,4598,4599,4600,4601,4602,4603,4604,4605,4606,4607,4607,4608,4609,4610,4611,4612,4613,4614,4615,4616,4617,4618,4619,4620,4621,4622,4623,4624,4625,4626,4627,4628,4629,4635,4635,4638,4638,4639,4640,4641,4642,4643,4644,4645,4646,4646,4647,4648,4649,4651,4652,4653,4654,4655,4656,4657,4658,4659,4661,4662,4663,4664,4665,4667,4668,4669,4670,4671,4672,4675,4675,4676,4677,4678,4680,4681,4682,4682,4683,4683,4687,4689,4691,4692,4693,4694,4695,4696,4697,4698,4699,4700,4701,4702,4703,4704,4705,4706,4707,4708,4709,4710,4711,4712,4713,4714,4716,4717,4718,4720,4721,4722,4723,4729,4729,4729,4730,4730,4730,4731,4731,4731,4732,4732,4732,4733,4733,4734,4735,4735,4735,4737,4737,4737,4738,4739,4740,4740,4741,4741,4742,4744,4745,4745,4746,4747,4749,4750,4751,4752,4754,4755,4756,4757,4758,4759,4760,4761,4762,4763,4763,4764,4764,4765,4766,4767,4768,5093,5107,5107,5108,5108,5109,5109,5110,5111,5111,5112,5112,5113,5113,5114,5121,5122,5123,5124,5125,5126,5127,5129,5130,5131,5132,5133,5133,5134,5135,5136,5137,5138,5139,5140,5141,5142,5143,5144,5145,5146,5147,5152,5153,5154,5155,5162,5163,5165,5166,5167,5168,5169,5170,5173,5174,5175,5176,5177,5177,5178,5178,5181,5182,5183,5184,5185,5186,5187,5188,5189,5190,5234,5234,5235,5235,5236,5237,5254,5255,5256,5256,5257,5257,5258,5258,5259,5260,5261,5262,5263,5264,5265,5266,5267,5268,5269,5270,5271,5272,5273,5275,5276,5277,5278,5279,5280,5281,5282,5283,5284,5285,5286,5287,5288,5289,5290,5291,5291,5292,5293,5294,5295,5296,5297,5298,5299,5300,5301,5302,5303,5303,5304,5305,5306,5307,5308,5309,5310,5311,5313,5314,5315,5316,5317,5318,5319,5320,5321,5322,5323,5324,5325,5326,5327,5328,5329,5330,5331,5332,5333,5334,5335,5336,5337,5338,5339,5340,5341,5342,5343,5344,5345,5346,5347,5348,5349,5350,5351,5352,5353,5354,5355,5356,5357,5358,5359,5360,5361,5362,5363,5364,5365,5366,5367,5368,5369,5370,5371,5372,5373,5374,5375,5376,5377,5378,5379,5380,5381,5382,5383,5384,5385,5386,5387,5388,5389,5390,5391,5392,5393,5394,5395,5396,5397,5398,5399,5400,5401,5402,5403,5404,5405,5406,5407,5408,5409,5410,5411,5412,5413,5414,5415,5416,5417,5433,5434,5435,5436,5437,5438,5439,5440,5441,5442,5443,5444,5445,5446,5447,5448,5449,5450,5451,5452,5453,5454,5455,5456,5457,5458,5459,5460,5461,5462,5463,5464,5464,5465,5466,5467,5468,5469,5470,5471,5472,5473,5474,5475,5476,5477,5478,5479,5480,5481,5482,5483,5484,5484,5485,5486,5487,5488,5489,5490,5491,5492,5493,5494,5495,5496,5497,5498,5499,5500,5501,5502,5502,5503,5504,5505,5506,5507,5508,5509,5509,5510,5511,5512,5513,5514,5515,5516,5517,5518,5519,5520,5521,5522,5523,5524,5525,5526,5527,5528,5529,5530,5531,5532,5533,5534,5535,5536,5537,5538,5539,5540,5541,5541,5542,5543,5544,5545,5546,5547,5550,5551,5552,5553,5554,5608,5609,5630,5631,5632,5633,5634,5635,5636,5637,5638,5639,5640,5641,5642,5643,5644,5645,5645,5684,5685,5688,5689,5690,5691,5692,5693,5718,5718,5719,5719,5786,5786,5787,5787,5788,5789,5790,5791,5798,5799,5800,5800,5801,5801,5802,5803,5810,5811,5812,5813,5814,5815,5816,5817,5818,5819,5822,5823,5824,5825,5832,5833,5834,5835,5836,5837,5838,5839,5840,5841,5842,5843,5844,5845,5846,5847,5848,5849,5850,5851,5852,5853,5854,5855,5856,5857,5858,5859,5860,5861,5862,5863,5864,5865,5866,5867,5868,5869,5872,5873,5874,5875,5876,5877,5878,5879,5880,5881,5884,5885,5886,5887,5888,5889,5890,5891,5892,5893,5894,5895,5896,5897,5898,5899,5900,5901,5902,5903,5904,5905,5909,5910,5911,5912,5913,5914,5978,5979];if(viRoutes.indexOf(parseInt(routeIdOut))>-1&&bypass){DF_DF1.setDefaultViDatesAndTimes();}}else{DF_DF1.setDefaultTwoPassengers();}
try{var totalCountO=DF_DF1.submission.routeOut.petCountTotal;var regionTxtO=totalCountO!=1?regionalText.pets_plural:regionalText.pets_single;DF_DF1['pets_outbound'].querySelector('.journey_details_span').textContent=regionTxtO.replace('[--X--]',totalCountO);if(DF_DF1.submission.routeReturn!=null){var totalCountR=DF_DF1.submission.routeReturn.petCountTotal;var regionTxtR=totalCountR!=1?regionalText.pets_plural:regionalText.pets_single;DF_DF1['pets_return'].querySelector('.journey_details_span').textContent=regionTxtR.replace('[--X--]',totalCountR);}}catch(e){}};DF_DF1.handleJourneyDetail=(t,res,routeId,routeIdReturn)=>{if(res){DF_DF1.minDuration=res.legOut.minDuration;DF_DF1.currencies=res.currencies;DF_DF1.maxPassengers=res.maxPassengers;DF_DF1.legOut=res.legOut;let setSubmission=(resLeg,subLegSail,returnLeg)=>{if(returnLeg){subLegSail.routeId=routeIdReturn;subLegSail.routeIdRet=routeId;}
else{subLegSail.routeId=routeId;subLegSail.routeIdRet=routeIdReturn;}
subLegSail.portFromId=resLeg.portFromId;subLegSail.portFromName=resLeg.portFromName;subLegSail.portToId=resLeg.portToId;subLegSail.portToName=resLeg.portToName;};let validateSubmissionLeg=(storeLeg,subLeg,returnLeg)=>{var legTxt;if(returnLeg)legTxt='return';else legTxt='outbound';if(subLeg.petList.length>0){var resetCount=false;var newTotal=0;subLeg.petList.forEach(function(sp){if(sp.petCount>0&&storeLeg.petTypes.filter((stp)=>stp.petId==sp.petId).length<=0){sp.petCount=0;resetCount=true;}
newTotal=+sp.petCount});if(resetCount)subLeg.petCountTotal=newTotal;}
if(subLeg.vehicle.isTravelMethodSelected==true&&subLeg.vehicle.vehicleRadioValue==false&&storeLeg.hasFootpassenger=="false"){subLeg.vehicle.vehicleTypeId=-1;subLeg.vehicle.isTravelMethodSelected=false;let vehicleField=DF_DF1['vehicle_'+legTxt];let vehicleStr=regionalText.vehicles_popup_org1;if(typeof(vehicleStr)!='undefined')vehicleField.querySelector('.journey_details_span').textContent=vehicleStr;}};var adults=DF_DF1.legOut.passengerAges.filter(function(i){return i.minAge>=18;});if(adults.length>1){DF_DF1.groupAdultsByAge=true;}
setSubmission(res.legOut,DF_DF1.submission.routeOut.sailing,false);validateSubmissionLeg(res.legOut,DF_DF1.submission.routeOut);if(res.hasReturnData){DF_DF1.legRet=res.legRet;setSubmission(res.legRet,DF_DF1.submission.routeReturn.sailing,true);validateSubmissionLeg(res.legRet,DF_DF1.submission.routeReturn,true);}
if(DF_DF1.hasValidDate()){DF_DF1.toggleAndEnableFields();}
if(!DF_DF1.restoredFromPrevious&&DF_DF1.hasValidDate()&&!(DF_DF1.formState[DF_DF1.formStateIndex]==='entering_journey_info')){if(DF_DF1.moveDatePickerInModal){DF_DF1.jumpFormState(null,'entering_journey_info');}
else if(!DF_DF1.changeStepOrder&&(isMobileInDesktop||DF_DF1.isFerries||DF_DF1.isMobileApp||DF_DF1.showPopularRoutes)){DF_DF1.jumpFormState(null,'entering_journey_info');DF_DF1.runDefaultAll(event,true);}else if(DF_DF1.changeStepOrder){DF_DF1.changeFlowStep(DF_DF1.flowStep[0]);}else{DF_DF1.formState[DF_DF1.formStateIndex]==='showing_routes_list'?DF_DF1.changeFormState('inc',t):null;DF_DF1.changeFormState('inc',t);}}}
DF_DF1.setFootPassengerSelected(false);};DF_DF1.showSelection=(e,t)=>{if(DF_DF1.current_field==null)DF_DF1.current_field=document.querySelector('#route_outbound');DF_DF1.current_field.value=t.getAttribute('data-routename');if(!DF_DF1.submission.diffjourneys){DF_DF1.mirror_value=t.getAttribute('data-routenameret');if(DF_DF1.mirror_field==null)DF_DF1.mirror_field=document.querySelector('#route_return');DF_DF1.mirror_field.value=t.getAttribute('data-routenameret');}};DF_DF1.setFootPassengerSelected=(bypass)=>{if(DF_DF1.legOut.hasVehicle=="false"||bypass){let subLegO=DF_DF1.submission.routeOut;subLegO.vehicle.vehicleTypeId=0;subLegO.vehicle.vehicleRadioValue=false;let vehicleField=DF_DF1['vehicle_outbound'];let baseVehicleStr=regionalText.vehicle_no_vehicle;vehicleField.querySelector('.journey_details_span').textContent=baseVehicleStr;vehicleField.querySelector('#plus_icon').textContent="edit";}
if(DF_DF1.legRet!=undefined&&(DF_DF1.legRet.hasVehicle=="false"||bypass)){let subLegR=DF_DF1.submission.routeReturn;subLegR.vehicle.vehicleTypeId=0;subLegR.vehicle.vehicleRadioValue=false;let vehicleField=DF_DF1['vehicle_return'];let baseVehicleStr=regionalText.vehicle_no_vehicle;vehicleField.querySelector('.journey_details_span').textContent=baseVehicleStr;vehicleField.querySelector('#plus_icon').textContent="edit";}};DF_DF1.buildSeparatePassengersDivs=function(){if(document.querySelector('.sep-pax-select')==null){var style=document.createElement('style');style.type='text/css';style.innerHTML="ul.sep-pax-select { display: flex; justify-content: space-between; }  ul.sep-pax-select li { width: 48.5%; }  ul.sep-pax-select li a { text-align: center; justify-content: center; flex-direction: column; padding: 8px 0;  }  ul.sep-pax-select li a span { padding: 0; }";document.getElementsByTagName('head')[0].appendChild(style);if(DF_DF1.groupAdultsByAge){var fixStyle=document.createElement('style');fixStyle.type='text/css';fixStyle.innerHTML="aside#passengers_popup .popup-wrap .popup_body label.long { display: block; margin: 10px 0; } aside#passengers_popup .popup-wrap .popup_body label.long select.booking_discount, aside#passengers_popup .popup-wrap .popup_body label.long select.resident_discount { min-width: 50px; font-size: 13px; padding: 5px; border: 1px solid #cccccc; border-radius: 3px; margin: 9px 0 0 auto; width: 100%; } aside#passengers_popup .popup-wrap .popup_body button.modal_opener { font-size: 14px; padding: 0; color: #2c7ca9; margin: 5px 0 10px; text-decoration: underline; } ";document.getElementsByTagName('head')[0].appendChild(fixStyle);}}
DF_DF1.buildSeparatePassengersDivsPerLeg(DF_DF1.submission.routeOut,'outbound');if(!DF_DF1.submission.oneway)DF_DF1.buildSeparatePassengersDivsPerLeg(DF_DF1.submission.routeReturn,'return');};DF_DF1.buildSeparatePassengersDivsPerLeg=function(leg,legTxt){if(document.querySelector('.trip_'+legTxt+' .sep-pax-select')==null){var passengers=leg.paxList;var adultsCount=passengers.filter(function(i){return i.minAge>=18;}).length;var childrenCount=passengers.filter(function(i){return i.minAge<18;}).length;let oldPass=document.querySelector('.journey_details.passengers.trip_'+legTxt);let ulPassSelect=DF_DF1.utils.buildElm({tag:'ul',cls:['sep-pax-select']});let liPassSelect1=DF_DF1.utils.buildElm({tag:'li'});let liPassSelect1A=DF_DF1.utils.buildElm({tag:'a',atts:{'class':oldPass.classList.value,'data-popup':"passengers_popup"}});let liPassSelect1ASpan1=DF_DF1.utils.buildElm({tag:'span',txt:regionalText.passengers_adults});let liPassSelect1ASpan2=DF_DF1.utils.buildElm({tag:'span',txt:adultsCount,atts:{id:'sep_pax_adults_count'}});if(DF_DF1.focusDealFinder){let icon=DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','df-light-blue'],txt:'person'});liPassSelect1A.appendChild(icon);}
liPassSelect1A.appendChild(liPassSelect1ASpan1);liPassSelect1A.appendChild(liPassSelect1ASpan2);liPassSelect1.appendChild(liPassSelect1A);let liPassSelect2=DF_DF1.utils.buildElm({tag:'li'});let liPassSelect2A=DF_DF1.utils.buildElm({tag:'a',atts:{'class':oldPass.classList.value,'data-popup':"passengers_popup"}});let liPassSelect2ASpan1=DF_DF1.utils.buildElm({tag:'span',txt:regionalText.passengers_children});let liPassSelect2ASpan2=DF_DF1.utils.buildElm({tag:'span',txt:childrenCount,atts:{id:'sep_pax_children_count'}});if(DF_DF1.focusDealFinder){let icon=DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','df-light-blue'],txt:'child_care'});liPassSelect2A.appendChild(icon);}
liPassSelect2A.appendChild(liPassSelect2ASpan1);liPassSelect2A.appendChild(liPassSelect2ASpan2);liPassSelect2.appendChild(liPassSelect2A);ulPassSelect.appendChild(liPassSelect1);ulPassSelect.appendChild(liPassSelect2);if(DF_DF1.focusDealFinder){let petsIcon=DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','df-light-blue'],txt:'pets'});let liPassSelect3=DF_DF1.utils.buildElm({tag:'li'});let liPassSelect3A=DF_DF1.utils.buildElm({tag:'a',atts:{'class':oldPass.classList.value,'data-popup':"pets_popup"}});let liPassSelect3ASpan1=DF_DF1.utils.buildElm({tag:'span',txt:regionalText.passengers_pets});let liPassSelect3ASpan2=DF_DF1.utils.buildElm({tag:'span',txt:leg.petCountTotal,atts:{id:'sep_pax_pets_count'}});liPassSelect3A.appendChild(petsIcon);liPassSelect3A.appendChild(liPassSelect3ASpan1);liPassSelect3A.appendChild(liPassSelect3ASpan2);liPassSelect3.appendChild(liPassSelect3A);ulPassSelect.appendChild(liPassSelect3);}
oldPass.parentNode.parentNode.parentNode.insertBefore(ulPassSelect,oldPass.parentNode.parentNode);oldPass.style='display: none;';let ageMsg;if(base_user_data.SiteLanguage.startsWith("en")){ageMsg='Make sure we have your correct age so we can get you the cheapest tickets!';}else if(base_user_data.SiteLanguage.startsWith("nl")){ageMsg='Zorg ervoor dat we uw juiste leeftijd hebben, zodat we u de goedkoopste tickets kunnen bezorgen!';}else if(base_user_data.SiteLanguage.startsWith("fr")){ageMsg='Veillez à nous communiquer votre âge précis pour que nous puissions vous faire bénéficier des meilleurs tarifs!';}else if(base_user_data.SiteLanguage.startsWith("de")){ageMsg='Stellen Sie sicher, dass wir Ihr korrektes Alter haben, damit wir Ihnen die günstigsten Tickets besorgen können!';}else if(base_user_data.SiteLanguage.startsWith("it")){ageMsg='Assicurati di indicarci l\'età corretta per farti avere i biglietti più economici!';}else if(base_user_data.SiteLanguage.startsWith("pt")){ageMsg='Certifique-se de que temos a sua idade correta para que lhe possamos conseguir os bilhetes mais baratos!';}else if(base_user_data.SiteLanguage.startsWith("es")){ageMsg='¡Asegúrate de darnos tu edad correcta para que podamos ofrecerte las entradas más baratas!';}
if(legTxt=='outbound'&&ageMsg!=undefined){var sty=document.createElement('style');sty.type='text/css';sty.innerHTML="#ageRangePrompt{background:#e0f1fa;margin-bottom:10px;padding:8px 30px 8px 10px;position:relative;margin-top:3px;border-radius:4px;display:flex;align-items:center;font-size:14px; line-height: 16px; grid-column: span 2;} #ageRangePrompt i.age-icon{padding-right:16px} #ageRangePrompt i.close-icon{position:absolute;top:4px;right:4px;padding:0;font-size:18px;cursor:pointer} .messagePointer{background:#e0f1fa;height:10px;width:10px;position:absolute;top:-5px;left:2rem;transform:rotate(45deg)}";document.getElementsByTagName('head')[0].appendChild(sty);let div1=DF_DF1.utils.buildElm({tag:'div',atts:{id:'ageRangePrompt'}});var dismissCookie=readCookie("dismissAge");if(dismissCookie=="true"){div1.style.display="none";}
let div2=DF_DF1.utils.buildElm({tag:'div',cls:['messagePointer']});let i1=DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','age-icon'],txt:'supervisor_account'});let s1=DF_DF1.utils.buildElm({tag:'span',txt:ageMsg});let i2=DF_DF1.utils.buildElm({tag:'i',cls:['material-icons','close-icon'],txt:'clear',atts:{'onclick':'closeAgeMsg(this)'}});let sc1=DF_DF1.utils.buildElm({tag:'script',atts:{'type':'text/javascript'},txt:'function closeAgeMsg(t) { t.parentElement.style.display = "none"; addCookie("dismissAge", "true", 365); }'});div1.appendChild(div2);div1.appendChild(i1);div1.appendChild(s1);div1.appendChild(i2);div1.appendChild(sc1);ulPassSelect.parentNode.insertBefore(div1,ulPassSelect.nextSibling);}}};DF_DF1.buildResidentDiscount=function(){if(document.querySelector('#resDiscount')==null){var sty=document.createElement('style');sty.type='text/css';sty.innerHTML=".resDiscount { grid-column: span 2; font-size: 16px; font-weight: 500; padding: 10px 8px; margin-bottom: 8px; background: #e0f1fa; border-radius: 4px; display: flex; align-items: center; } .resDiscount span { background: #45b7ed; padding: 4px 8px; border-radius: 3px; margin-right: 2px; color: #fff; } #residentCheck[type=checkbox]:checked, #residentCheck[type=checkbox]:not(:checked) { position: absolute; left: -9999px; } #residentCheck[type=checkbox]:checked + label.rdName, #residentCheck[type=checkbox]:not(:checked) + label.rdName { position: relative; padding-right: 26px; cursor: pointer; color: #193354; font-weight: 700; line-height: 21px; margin-left: auto; margin-bottom: 0; } #residentCheck[type=checkbox]:checked + label.rdName:before, #residentCheck[type=checkbox]:not(:checked) + label.rdName:before { content: ''; position: absolute; right: 0; top: 1px; width: 18px; height: 18px; border: 2px solid #333333; border-radius: 3px; } #residentCheck[type=checkbox]:checked + label.rdName:after, #residentCheck[type=checkbox]:not(:checked) + label.rdName:after { font-family: 'Material Icons'; content: 'check'; text-rendering: optimizeLegibility; font-feature-settings: 'liga' 1; font-style: normal; text-transform: none; line-height: 20px; font-size: 14px; width: 18px; height: 17px; text-align: center; position: absolute; top: 0; right: 0; display: inline-block; overflow: hidden; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; color: #193354; -webkit-transition: all .2s; transition: all .2s; } #residentCheck[type=checkbox]:not(:checked)+label.rdName:after{opacity:0;-webkit-transform:scale(0);transform:scale(0)} #residentCheck[type=checkbox]:checked+label.rdName:after{opacity:1;-webkit-transform:scale(1);transform:scale(1)} .resDiscount .mat_i { font-size: 24px; margin-right: 4px; color: #45b7ed; }";document.getElementsByTagName('head')[0].appendChild(sty);let storeLeg=DF_DF1.legOut;let subLeg=DF_DF1.submission.routeOut;var discounts=storeLeg['residentDiscounts'];let discountText;let discVal;if(discounts.length>0){if(discounts.length>2){var d=discounts.find(function(disc){return disc.ddVal=="1"});discountText=d.ddText;discVal=d.ddVal;}else{discounts.forEach(function(disc){if(disc.ddVal!="0"){discountText=disc.ddText;discVal=disc.ddVal;}});}
let discDiv=DF_DF1.utils.buildElm({tag:'div',cls:['resDiscount','hide_until_summary'],atts:{id:'resDiscount','data-modal':'resident_discount'}});discDiv.append(DF_DF1.utils.buildElm({tag:'input',atts:{id:'hdnResDiscount','type':'hidden','value':discVal}}));discDiv.append(DF_DF1.utils.buildElm({tag:'div',txt:'info',cls:['material-icons','modal_opener','mat_i'],atts:{'data-modal':'resident_discount'}}));discDiv.append(DF_DF1.utils.buildElm({tag:'span',cls:['modal_opener'],txt:discountText,atts:{id:'resDiscText','data-modal':'resident_discount'}}));let chkDisc=DF_DF1.utils.buildElm({tag:'input',atts:{id:'residentCheck','type':'checkbox','data-toggle':'resident_check'}});if(discVal==subLeg['residentInfo'].toString())chkDisc.checked=true;discDiv.append(chkDisc);discDiv.append(DF_DF1.utils.buildElm({tag:'label',cls:['rdName'],txt:regionalText.passengers_popup_resident_discount,atts:{'for':'residentCheck'}}));discDiv.addEventListener('click',DF_DF1.popupEventPipe);var curDiv=document.querySelector(".currency.hide_until_summary");curDiv.parentNode.insertBefore(discDiv,curDiv.nextElementSibling);}}else{var discounts=DF_DF1.legOut['residentDiscounts'];let discountText;let discVal;if(discounts.length>0){if(discounts.length>2){var d=discounts.find(function(disc){return disc.ddVal=="1"});discountText=d.ddText;discVal=d.ddVal;}else{discounts.forEach(function(disc){if(disc.ddVal!="0"){discountText=disc.ddText;discVal=disc.ddVal;}});}
document.querySelector('#hdnResDiscount').value=discVal;document.querySelector('#resDiscText').textContent=discountText;}}};DF_DF1.initCalendars=()=>{let initCalendar=(field)=>{let storeLeg;let headerText;if(field.id==='cal_outbound'){storeLeg=DF_DF1.legOut;headerText=regionalText.calendar_out_hdg;}
else{storeLeg=DF_DF1.legRet;headerText=regionalText.calendar_return_hdg;}
if(typeof(base_user_data.STDCCode)!='undefined'&&(base_user_data.STDCCode=="DF10G"||base_user_data.STDCCode=="MDF10G")){regionalDates={closeText:"schlie\u00dfen",prevText:"&#x3c;zur\u00fcck",nextText:"Vor&#x3e;",currentText:"heute",monthNames:["Januar","Februar","M\u00e4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNamesMin:["So","Mo","Di","Mi","Do","Fr","Sa"],weekHeader:"Wo",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""};}else if(base_user_data.SiteLanguage!=null&&base_user_data.SiteLanguage.startsWith('es')){regionalDates={closeText:"Cerrar",prevText:"&#x3c;Ant",nextText:"Sig&#x3e;",currentText:"Hoy",monthNames:['enero','febrero','marzo','abril','mayo','junio','julio','agosto','septiembre','octubre','noviembre','diciembre'],monthNamesShort:['ene','feb','mar','abr','may','jun','jul','ago','sep','oct','nov','dic'],dayNames:['domingo','Lunes','martes','miércoles','jueves','Viernes','sábado'],dayNamesShort:['Dom','Lun','Mar','Mié','Juv','Vie','Sá'],dayNamesMin:['Do','Lu','Ma','Mi','Ju','Vi','Sá'],weekHeader:"Sm",firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:""};}
let opts=Object.assign
({display:'inline',theme:'material',themeVariant:'light',cssClass:'newDatepicker',yearChange:false,showOnTap:false,min:new Date()},regionalDates);if(DF_DF1.useDateRange){opts=Object.assign
({invalid:[{start:new Date(2021,1,1),end:new Date(new Date().getFullYear()+3,11,31)}],valid:DF_DF1.buildValids(storeLeg,field.id==='cal_outbound'),dateFormat:typeof newTempDateFormat!=="undefined"&&newTempDateFormat.trim().length>0?newTempDateFormat:'dd MMM YYYY',controls:['calendar'],touchUi:true,inRangeInvalid:true,rangeEndInvalid:false,onChange:DF_DF1.saveDateBuffer},opts);if(!DF_DF1.submission.oneway){opts=Object.assign
({select:'range',rangeStartLabel:regionalText.journey_title_outbound,rangeEndLabel:regionalText.journey_title_return,rangeStartHelp:regionalText.please_select,rangeEndHelp:regionalText.please_select,startInput:DF_DF1.cal_outbound,endInput:DF_DF1.cal_return},opts);}else{opts=Object.assign
({headerText:'{value}'},opts);}}else{opts=Object.assign
({invalid:[{start:new Date(2021,1,1),end:new Date(new Date().getFullYear()+3,11,31)}],valid:DF_DF1.buildValids(storeLeg,field.id==='cal_outbound'),dateFormat:typeof tempDateFormat!=="undefined"&&tempDateFormat.trim().length>0?tempDateFormat:'d MM yy',headerText:headerText,},opts);}
if(field.id==='cal_outbound'){opts=Object.assign
({onInit:DF_DF1.initDate,onDayChange:DF_DF1.setBothDates,},opts);}
else{opts=Object.assign(opts);}
let instance=DF_DF1.useDateRange?mobiscroll.datepicker('#'+field.id,opts):mobiscroll.calendar('#'+field.id,opts);field.id==='cal_outbound'?DF_DF1.mobioutboundCal=instance:DF_DF1.mobireturnCal=instance;}
DF_DF1.killCalendar(DF_DF1.mobioutboundCal);initCalendar(DF_DF1.cal_outbound);if(!DF_DF1.submission.oneway&&!DF_DF1.useDateRange){DF_DF1.killCalendar(DF_DF1.mobireturnCal);initCalendar(DF_DF1.cal_return);DF_DF1.initReturnDate();}};DF_DF1.setDateRange=(startDate,endDate)=>{DF_DF1.bufferedDateRange[0]=startDate;DF_DF1.bufferedDateRange[1]=endDate;DF_DF1.mobioutboundCal.setVal([startDate,endDate]);}
DF_DF1.saveDateBuffer=(event,inst)=>{if(inst.s.select=="range"){DF_DF1.bufferedDateRange[0]=inst.value[0];DF_DF1.bufferedDateRange[1]=inst.value[1];}else{DF_DF1.bufferedDateRange[0]=inst.value;}}
DF_DF1.resetSubmittedTimes=()=>{DF_DF1.submission.routeOut.sailing.dateDep=null;DF_DF1.submission.routeOut.sailing.timeId=-1;DF_DF1.submission.routeReturn.sailing.dateDep=null;DF_DF1.submission.routeReturn.sailing.timeId=-1;};DF_DF1.buildValids=(storeLeg,isOutboundLeg)=>{let lastSetDate;if(storeLeg.dates.hasDates==='true')
{storeLeg.dateList=JSON.parse(storeLeg.dates.selectableDates);let lastYear=Math.max.apply(this,Object.keys(storeLeg.dateList));let lastMonth=Math.max.apply(this,Object.keys(storeLeg.dateList[lastYear]));let lastDay=storeLeg.dateList[lastYear][lastMonth].slice(-1)[0];lastSetDate=new Date(lastYear,lastMonth,lastDay);}
let valids=[{start:lastSetDate,end:new Date(new Date().getFullYear()+1,11,31)}];if(storeLeg.dates.hasDates==='true'){let pushValidDate=function(value){valids.push(value);};for(let year in storeLeg.dateList){for(let month in storeLeg.dateList[year]){if(storeLeg.dateList[year][month][0]===-1){var validRange={start:new Date(year,month,1),end:new Date(year,parseInt(month)+1,0)};pushValidDate(validRange);}
else{for(let day of storeLeg.dateList[year][month]){var date=new Date(year,month,day);pushValidDate(date);}}}}}
return valids;};DF_DF1.initDate=(event,instance)=>{let minDate=new Date();if(DF_DF1.useDateRange){if(instance.value==null||instance.value=='Invalid Date'){var outDate=new Date(minDate.getFullYear(),minDate.getMonth(),minDate.getDate()+1);var retDate=new Date(minDate.getFullYear(),minDate.getMonth(),minDate.getDate()+4);if(DF_DF1.bufferedDateRange.length>0){outDate=new Date(DF_DF1.bufferedDateRange[0]);if(!DF_DF1.submission.oneway)retDate=new Date(DF_DF1.bufferedDateRange[1]);}
if(DF_DF1.submission.oneway)instance.setVal(outDate,true);else instance.setVal([outDate,retDate],true);}}else if(instance.defSet===true){instance.setVal(instance._tempValue);}
else{instance.setVal(new Date(minDate.getFullYear(),minDate.getMonth(),minDate.getDate()+1),true);}
instance.defSet=true;}
DF_DF1.initReturnDate=()=>{let minDate;if(DF_DF1.useDateRange)minDate=Array.isArray(DF_DF1.mobioutboundCal.value)?DF_DF1.mobioutboundCal.value[0]:DF_DF1.mobioutboundCal.value;else minDate=DF_DF1.mobioutboundCal.getDate();DF_DF1.mobireturnCal.setVal(new Date(minDate.getFullYear(),minDate.getMonth(),minDate.getDate()+3),true);DF_DF1.mobireturnCal.defSet=true;}
DF_DF1.setBothDates=(event,instance)=>{if(!DF_DF1.submission.routeReturn.sailing.isOpenChecked)
{let returnCal=DF_DF1.mobireturnCal;let outboundDate=event.date;if(typeof returnCal!=="undefined"){let nextDate=new Date(outboundDate.getFullYear(),outboundDate.getMonth(),outboundDate.getDate()+1);if(DF_DF1.useDateRange)returnCal.setOptions({min:outboundDate});else returnCal.option({min:outboundDate});if(typeof returnCal.getDate()==='undefined'||returnCal.getDate()<=outboundDate){returnCal.setVal(nextDate,true);}}}};DF_DF1.initialiseReturnDate=(event,instance)=>{if(!DF_DF1.submission.routeReturn.sailing.isOpenChecked)
{let returnCal=DF_DF1.mobireturnCal;let outboundDate=new Date(DF_DF1.cal_outbound.value);if(typeof returnCal!=="undefined"){let nextDate=new Date(outboundDate.getFullYear(),outboundDate.getMonth(),outboundDate.getDate()+1);if(DF_DF1.useDateRange){returnCal.setOptions({min:outboundDate});if(typeof returnCal.value[0]==='undefined'||returnCal.value[0]<=outboundDate){returnCal.setVal(nextDate,true);}}else{returnCal.option({min:outboundDate});if(typeof returnCal.getDate()==='undefined'||returnCal.getDate()<=outboundDate){returnCal.setVal(nextDate,true);}}}}};DF_DF1.reInitDate=(legTxt)=>{try{let datepicker=DF_DF1['mobi'+legTxt+'Cal'];var isOutboundLeg=legTxt=="outbound";let minDate=isOutboundLeg?DF_DF1.utils.parseDate(DF_DF1.legOut.dates.minDate):DF_DF1['mobioutboundCal'].getDate();datepicker.option({defaultValue:datepicker.getDate(),valid:datepicker.settings.valid,min:minDate});datepicker.setVal(datepicker.getDate(),true);}catch(e){if(typeof(ga)=='function')ga('send','event','Reinit calendar error','dealfinder.js',{nonInteraction:true});}}
DF_DF1.buildTimePickerModal=()=>{let appendToTimePickerModal=function(m,p){var legTxt=p.classList.contains('new_time_outbound')?'outbound':'return';if(!DF_DF1.submission.oneway||legTxt=='outbound'){var timeModalLeg=document.querySelector('.time_picker_'+legTxt)??DF_DF1.utils.buildElm({tag:'div',cls:['time_picker_'+legTxt]});timeModalLeg.appendChild(p);m.appendChild(timeModalLeg);var timeHeader=p.querySelector(".mbsc-picker-header.mbsc-material");var divH=document.querySelector('.time_picker_header_'+legTxt)??DF_DF1.utils.buildElm({tag:'div',cls:['time_picker_header_'+legTxt],txt:DF_DF1['cal_'+legTxt].value});timeHeader.append(divH);}}
if(document.querySelector(".time_picker_wrapper")==null){var timeModal=DF_DF1.utils.buildElm({tag:'div',cls:['time_picker_wrapper']});var pickers=DF_DF1.useDateRange?document.querySelectorAll(".mbsc-datepicker.mbsc-datepicker-inline.mbsc-material.newTimepicker.mbsc-datepicker-control-time"):document.querySelectorAll(".mbsc-fr.mbsc-material.mbsc-fr-inline.newTimepicker");pickers.forEach(function(p){appendToTimePickerModal(timeModal,p);});document.querySelector("#time_outbound").parentElement.appendChild(timeModal);}else{if(DF_DF1.submission.oneway){if(document.querySelector(".time_picker_return")!=undefined)document.querySelector(".time_picker_return").style.display="none";appendToTimePickerModal(document.querySelector(".time_picker_wrapper"),document.querySelector(".new_time_outbound"));}
else{if(document.querySelector(".time_picker_return")!=undefined)document.querySelector(".time_picker_return").style.display="block";var pickers=DF_DF1.useDateRange?document.querySelectorAll(".mbsc-datepicker.mbsc-datepicker-inline.mbsc-material.newTimepicker.mbsc-datepicker-control-time"):document.querySelectorAll(".mbsc-fr.mbsc-material.mbsc-fr-inline.newTimepicker");pickers.forEach(function(p){appendToTimePickerModal(document.querySelector(".time_picker_wrapper"),p);});}}}
DF_DF1.killCalendar=(instance)=>{if(typeof(instance)!="undefined")
instance.destroy();}
DF_DF1.initTimes=()=>{let initTime=(field)=>{let headerText=field.id==='time_outbound'?regionalText.time_out_hdg:regionalText.time_return_hdg;if(DF_DF1.timePickerModal){headerText=field.id==='time_outbound'?regionalText.journey_title_outbound:regionalText.journey_title_return;}
field.defaultValue=field.id==='time_outbound'?"09:00":"17:00";let opts=Object.assign
({display:'inline',defaultValue:field.value===""?field.defaultValue:field.value,readOnly:[false,true],theme:'material',themeVariant:'light',cssClass:'newTimepicker new_'+field.id,headerText:headerText,showOnTap:false,controls:['time']});if(DF_DF1.useDateRange){opts=Object.assign
({stepMinute:60,dateFormat:typeof newTempDateFormat!=="undefined"?newTempDateFormat:'D MMM YYYY'},newRegionalTime,opts);}else{opts=Object.assign
({steps:{minute:60},dateFormat:typeof tempDateFormat!=="undefined"?tempDateFormat:'d MM yy'},regionalTime,opts);}
if(DF_DF1.timePickerModal){opts=Object.assign({rows:3},opts);}
let instance=DF_DF1.useDateRange?mobiscroll.datepicker('#'+field.id,opts):mobiscroll.calendar('#'+field.id,opts);field.id==='time_outbound'?DF_DF1.mobioutboundTime=instance:DF_DF1.mobireturnTime=instance;}
DF_DF1.killTime(DF_DF1.mobioutboundTime);initTime(DF_DF1.time_outbound);if(!DF_DF1.submission.oneway){DF_DF1.killTime(DF_DF1.mobireturnTime);initTime(DF_DF1.time_return);}};DF_DF1.killTime=(instance)=>{if(typeof(instance)!="undefined")
instance.destroy();}
DF_DF1.setSubmissionDatesTimes=()=>{let setDatesTimes=(storeSail,calField,timeField)=>{if(storeSail.isOpenChecked){if(calField.id==="cal_outbound")storeSail.isOpenChecked=DF_DF1.legOut.hasOpenTicket=="true";else storeSail.isOpenChecked=DF_DF1.legRet.hasOpenTicket=="true";}
let mobiCal;if(DF_DF1.useDateRange){if(DF_DF1.submission.oneway)mobiCal=DF_DF1.mobioutboundCal.value;else mobiCal=calField.id==="cal_outbound"?DF_DF1.mobioutboundCal.value[0]:DF_DF1.mobioutboundCal.value[1];}else mobiCal=calField.id==="cal_outbound"?DF_DF1.mobioutboundCal.getDate():DF_DF1.mobireturnCal.getDate();let date=new Date(mobiCal);let formatDigits=(val)=>{val<10?val='0'+val:null;return val;}
if(date instanceof Date&&!isNaN(date.getTime())){let month=formatDigits(date.getMonth()+1);let day=formatDigits(date.getDate());storeSail.dateDep=date.getFullYear()+'-'+month+'-'+day;let time=parseInt(timeField.value);storeSail.timeId=isNaN(time)?-1:time;}};setDatesTimes(DF_DF1.submission.routeOut.sailing,DF_DF1.cal_outbound,DF_DF1.time_outbound);if(!DF_DF1.submission.oneway)setDatesTimes(DF_DF1.submission.routeReturn.sailing,DF_DF1.cal_return,DF_DF1.time_return);};DF_DF1.setDefaultViDatesAndTimes=function(){if(!DF_DF1.defaultDatesSet){DF_DF1.defaultDatesSet=true;var today=new Date();if(DF_DF1.mobioutboundCal!=undefined&&DF_DF1.mobioutboundCal.defSet)DF_DF1.mobioutboundCal.setVal(new Date(today.getFullYear(),today.getMonth(),today.getDate()+3),true);if(DF_DF1.mobireturnCal!=undefined&&DF_DF1.mobireturnCal.defSet)DF_DF1.mobireturnCal.setVal(new Date(today.getFullYear(),today.getMonth(),today.getDate()+6),true);}};DF_DF1.buildCalendarHeader=function(cls,txt){if(document.querySelector("."+cls)==null){var cal=document.querySelector(".journey_timing.timing_outbound.hide_until_times");var divHeader=DF_DF1.utils.buildElm({tag:'div',cls:[cls,"hide_until_times"]});var divHeaderTxt=DF_DF1.utils.buildElm({tag:'div',txt:txt});let spanClose=DF_DF1.utils.buildElm({tag:'span'});let iClose=DF_DF1.utils.buildElm({tag:'i',txt:"close",cls:['material-icons','dp-controls','dp-controls-close']});spanClose.appendChild(iClose);divHeader.append(divHeaderTxt);divHeader.append(spanClose);cal.parentNode.insertBefore(divHeader,cal);}};